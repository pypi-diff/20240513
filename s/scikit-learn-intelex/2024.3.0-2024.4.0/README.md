# Comparing `tmp/scikit_learn_intelex-2024.3.0-py39-none-win_amd64.whl.zip` & `tmp/scikit_learn_intelex-2024.4.0-py39-none-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,100 +1,103 @@
-Zip file size: 148784 bytes, number of entries: 98
--rw-rw-rw-  2.0 fat     1780 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/__init__.py
--rw-rw-rw-  2.0 fat     1921 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/__main__.py
--rw-rw-rw-  2.0 fat     3928 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_config.py
--rw-rw-rw-  2.0 fat     7710 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_device_offload.py
--rw-rw-rw-  2.0 fat     3812 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_utils.py
--rw-rw-rw-  2.0 fat     2130 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/conftest.py
--rw-rw-rw-  2.0 fat    14389 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/dispatcher.py
--rw-rw-rw-  2.0 fat      821 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/basic_statistics/__init__.py
--rw-rw-rw-  2.0 fat      796 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/basic_statistics/basic_statistics.py
--rw-rw-rw-  2.0 fat      853 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/__init__.py
--rw-rw-rw-  2.0 fat     6736 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/dbscan.py
--rw-rw-rw-  2.0 fat      806 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/k_means.py
--rw-rw-rw-  2.0 fat     1464 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_dbscan.py
--rw-rw-rw-  2.0 fat     1213 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_kmeans.py
--rw-rw-rw-  2.0 fat      859 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/__init__.py
--rw-rw-rw-  2.0 fat     4526 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/incremental_covariance.py
--rw-rw-rw-  2.0 fat     5402 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/tests/test_incremental_covariance.py
--rw-rw-rw-  2.0 fat      805 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/__init__.py
--rw-rw-rw-  2.0 fat    12829 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/pca.py
--rw-rw-rw-  2.0 fat     2201 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/tests/test_pca.py
--rw-rw-rw-  2.0 fat    21773 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/doc/third-party-programs.txt
--rw-rw-rw-  2.0 fat     1035 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/__init__.py
--rw-rw-rw-  2.0 fat    70553 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/_forest.py
--rw-rw-rw-  2.0 fat     4456 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/tests/test_forest.py
--rw-rw-rw-  2.0 fat     2531 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/glob/__main__.py
--rw-rw-rw-  2.0 fat     3018 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/glob/dispatcher.py
--rw-rw-rw-  2.0 fat     1047 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/__init__.py
--rw-rw-rw-  2.0 fat      822 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/coordinate_descent.py
--rw-rw-rw-  2.0 fat    13832 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/linear.py
--rw-rw-rw-  2.0 fat      849 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_path.py
--rw-rw-rw-  2.0 fat    12990 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_regression.py
--rw-rw-rw-  2.0 fat      810 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/ridge.py
--rw-rw-rw-  2.0 fat     3200 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_linear.py
--rw-rw-rw-  2.0 fat     3283 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_logreg.py
--rw-rw-rw-  2.0 fat      809 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/__init__.py
--rw-rw-rw-  2.0 fat      805 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/t_sne.py
--rw-rw-rw-  2.0 fat     1063 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/tests/test_tsne.py
--rw-rw-rw-  2.0 fat      907 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/__init__.py
--rw-rw-rw-  2.0 fat      818 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/pairwise.py
--rw-rw-rw-  2.0 fat      813 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/ranking.py
--rw-rw-rw-  2.0 fat     1579 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/tests/test_metrics.py
--rw-rw-rw-  2.0 fat      842 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/__init__.py
--rw-rw-rw-  2.0 fat      824 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/split.py
--rw-rw-rw-  2.0 fat     1338 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/tests/test_model_selection.py
--rw-rw-rw-  2.0 fat     1078 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/__init__.py
--rw-rw-rw-  2.0 fat     8109 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/_lof.py
--rw-rw-rw-  2.0 fat    10781 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/common.py
--rw-rw-rw-  2.0 fat    11161 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_classification.py
--rw-rw-rw-  2.0 fat     9977 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_regression.py
--rw-rw-rw-  2.0 fat     7542 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_unsupervised.py
--rw-rw-rw-  2.0 fat     3409 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/tests/test_neighbors.py
--rw-rw-rw-  2.0 fat      780 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/__init__.py
--rw-rw-rw-  2.0 fat      794 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/__init__.py
--rw-rw-rw-  2.0 fat     2718 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/_common.py
--rw-rw-rw-  2.0 fat    13007 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/k_means.py
--rw-rw-rw-  2.0 fat      825 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/__init__.py
--rw-rw-rw-  2.0 fat     4938 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/covariance.py
--rw-rw-rw-  2.0 fat     2140 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/tests/test_covariance.py
--rw-rw-rw-  2.0 fat      889 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/__init__.py
--rw-rw-rw-  2.0 fat      821 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/__init__.py
--rw-rw-rw-  2.0 fat      886 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/basic_statistics.py
--rw-rw-rw-  2.0 fat     1029 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/__init__.py
--rw-rw-rw-  2.0 fat     1824 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/dbscan.py
--rw-rw-rw-  2.0 fat      868 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/kmeans.py
--rw-rw-rw-  2.0 fat      823 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/__init__.py
--rw-rw-rw-  2.0 fat      884 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/covariance.py
--rw-rw-rw-  2.0 fat      784 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/__init__.py
--rw-rw-rw-  2.0 fat      871 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/pca.py
--rw-rw-rw-  2.0 fat      873 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/__init__.py
--rw-rw-rw-  2.0 fat     2909 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/forest.py
--rw-rw-rw-  2.0 fat      893 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/__init__.py
--rw-rw-rw-  2.0 fat      883 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/linear_model.py
--rw-rw-rw-  2.0 fat      885 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/logistic_regression.py
--rw-rw-rw-  2.0 fat      906 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/__init__.py
--rw-rw-rw-  2.0 fat      940 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/neighbors.py
--rw-rw-rw-  2.0 fat     1057 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/__init__.py
--rw-rw-rw-  2.0 fat     7167 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/_common.py
--rw-rw-rw-  2.0 fat     9150 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/nusvc.py
--rw-rw-rw-  2.0 fat     5237 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/nusvr.py
--rw-rw-rw-  2.0 fat    10426 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/svc.py
--rw-rw-rw-  2.0 fat     5241 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/svr.py
--rw-rw-rw-  2.0 fat     4190 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/tests/test_svm.py
--rw-rw-rw-  2.0 fat     5059 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/_utils.py
--rw-rw-rw-  2.0 fat     1372 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_config.py
--rw-rw-rw-  2.0 fat     7327 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_memory_usage.py
--rw-rw-rw-  2.0 fat     9669 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_monkeypatch.py
--rw-rw-rw-  2.0 fat     3903 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_n_jobs_support.py
--rw-rw-rw-  2.0 fat     1770 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_parallel.py
--rw-rw-rw-  2.0 fat    13187 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_patching.py
--rw-rw-rw-  2.0 fat    14008 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_run_to_run_stability_tests.py
--rw-rw-rw-  2.0 fat      842 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/__init__.py
--rw-rw-rw-  2.0 fat     2085 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/parallel.py
--rw-rw-rw-  2.0 fat      827 b- defN 24-Apr-08 19:52 scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/validation.py
--rw-rw-rw-  2.0 fat    10999 b- defN 24-Apr-11 04:35 scikit_learn_intelex-2024.3.0.dist-info/LICENSE.txt
--rw-rw-rw-  2.0 fat    12448 b- defN 24-Apr-11 04:35 scikit_learn_intelex-2024.3.0.dist-info/METADATA
--rw-rw-rw-  2.0 fat       99 b- defN 24-Apr-11 04:35 scikit_learn_intelex-2024.3.0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        1 b- defN 24-Apr-11 04:35 scikit_learn_intelex-2024.3.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat    14314 b- defN 24-Apr-11 04:35 scikit_learn_intelex-2024.3.0.dist-info/RECORD
-98 files, 460583 bytes uncompressed, 123698 bytes compressed:  73.1%
+Zip file size: 153438 bytes, number of entries: 101
+-rw-rw-rw-  2.0 fat     1780 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/__init__.py
+-rw-rw-rw-  2.0 fat     1921 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/__main__.py
+-rw-rw-rw-  2.0 fat     3928 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_config.py
+-rw-rw-rw-  2.0 fat     8639 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_device_offload.py
+-rw-rw-rw-  2.0 fat     3812 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_utils.py
+-rw-rw-rw-  2.0 fat     2130 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/conftest.py
+-rw-rw-rw-  2.0 fat    14389 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/dispatcher.py
+-rw-rw-rw-  2.0 fat      920 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/__init__.py
+-rw-rw-rw-  2.0 fat      796 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/basic_statistics.py
+-rw-rw-rw-  2.0 fat    10048 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/incremental_basic_statistics.py
+-rw-rw-rw-  2.0 fat    14992 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/tests/test_incremental_basic_statistics.py
+-rw-rw-rw-  2.0 fat      853 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/__init__.py
+-rw-rw-rw-  2.0 fat     6736 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/dbscan.py
+-rw-rw-rw-  2.0 fat      806 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/k_means.py
+-rw-rw-rw-  2.0 fat     1464 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_dbscan.py
+-rw-rw-rw-  2.0 fat     1213 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_kmeans.py
+-rw-rw-rw-  2.0 fat      859 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/__init__.py
+-rw-rw-rw-  2.0 fat     4526 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/incremental_covariance.py
+-rw-rw-rw-  2.0 fat     5402 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/tests/test_incremental_covariance.py
+-rw-rw-rw-  2.0 fat      805 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/__init__.py
+-rw-rw-rw-  2.0 fat    12654 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/pca.py
+-rw-rw-rw-  2.0 fat     2201 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/tests/test_pca.py
+-rw-rw-rw-  2.0 fat    21773 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/doc/third-party-programs.txt
+-rw-rw-rw-  2.0 fat     1035 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/__init__.py
+-rw-rw-rw-  2.0 fat    70002 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/_forest.py
+-rw-rw-rw-  2.0 fat     4456 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/tests/test_forest.py
+-rw-rw-rw-  2.0 fat     2531 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/glob/__main__.py
+-rw-rw-rw-  2.0 fat     3018 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/glob/dispatcher.py
+-rw-rw-rw-  2.0 fat     1047 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/__init__.py
+-rw-rw-rw-  2.0 fat      822 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/coordinate_descent.py
+-rw-rw-rw-  2.0 fat    11159 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/linear.py
+-rw-rw-rw-  2.0 fat      849 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_path.py
+-rw-rw-rw-  2.0 fat    14171 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_regression.py
+-rw-rw-rw-  2.0 fat      810 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/ridge.py
+-rw-rw-rw-  2.0 fat     4319 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_linear.py
+-rw-rw-rw-  2.0 fat     3283 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_logreg.py
+-rw-rw-rw-  2.0 fat      809 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/__init__.py
+-rw-rw-rw-  2.0 fat      805 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/t_sne.py
+-rw-rw-rw-  2.0 fat     1063 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/tests/test_tsne.py
+-rw-rw-rw-  2.0 fat      907 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/__init__.py
+-rw-rw-rw-  2.0 fat      818 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/pairwise.py
+-rw-rw-rw-  2.0 fat      813 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/ranking.py
+-rw-rw-rw-  2.0 fat     1579 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/tests/test_metrics.py
+-rw-rw-rw-  2.0 fat      842 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/__init__.py
+-rw-rw-rw-  2.0 fat      824 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/split.py
+-rw-rw-rw-  2.0 fat     1338 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/tests/test_model_selection.py
+-rw-rw-rw-  2.0 fat     1078 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/__init__.py
+-rw-rw-rw-  2.0 fat     8648 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/_lof.py
+-rw-rw-rw-  2.0 fat    10875 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/common.py
+-rw-rw-rw-  2.0 fat     8537 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_classification.py
+-rw-rw-rw-  2.0 fat     6692 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_regression.py
+-rw-rw-rw-  2.0 fat     5362 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_unsupervised.py
+-rw-rw-rw-  2.0 fat     3409 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/tests/test_neighbors.py
+-rw-rw-rw-  2.0 fat      780 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/__init__.py
+-rw-rw-rw-  2.0 fat      794 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/__init__.py
+-rw-rw-rw-  2.0 fat     2718 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/_common.py
+-rw-rw-rw-  2.0 fat    10464 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/k_means.py
+-rw-rw-rw-  2.0 fat      825 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/__init__.py
+-rw-rw-rw-  2.0 fat     5131 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/covariance.py
+-rw-rw-rw-  2.0 fat     2487 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/tests/test_covariance.py
+-rw-rw-rw-  2.0 fat      889 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/__init__.py
+-rw-rw-rw-  2.0 fat      821 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/__init__.py
+-rw-rw-rw-  2.0 fat      886 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/basic_statistics.py
+-rw-rw-rw-  2.0 fat     1029 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/__init__.py
+-rw-rw-rw-  2.0 fat     1824 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/dbscan.py
+-rw-rw-rw-  2.0 fat      868 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/kmeans.py
+-rw-rw-rw-  2.0 fat      823 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/__init__.py
+-rw-rw-rw-  2.0 fat      884 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/covariance.py
+-rw-rw-rw-  2.0 fat      784 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/__init__.py
+-rw-rw-rw-  2.0 fat      871 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/pca.py
+-rw-rw-rw-  2.0 fat      873 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/__init__.py
+-rw-rw-rw-  2.0 fat     2909 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/forest.py
+-rw-rw-rw-  2.0 fat      893 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/__init__.py
+-rw-rw-rw-  2.0 fat      883 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/linear_model.py
+-rw-rw-rw-  2.0 fat      885 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/logistic_regression.py
+-rw-rw-rw-  2.0 fat      906 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/__init__.py
+-rw-rw-rw-  2.0 fat      940 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/neighbors.py
+-rw-rw-rw-  2.0 fat     1057 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/__init__.py
+-rw-rw-rw-  2.0 fat     7010 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/_common.py
+-rw-rw-rw-  2.0 fat     9871 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/nusvc.py
+-rw-rw-rw-  2.0 fat     3655 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/nusvr.py
+-rw-rw-rw-  2.0 fat    11125 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/svc.py
+-rw-rw-rw-  2.0 fat     3655 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/svr.py
+-rw-rw-rw-  2.0 fat     4190 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/tests/test_svm.py
+-rw-rw-rw-  2.0 fat     5386 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/_utils.py
+-rw-rw-rw-  2.0 fat     1372 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_config.py
+-rw-rw-rw-  2.0 fat     7327 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_memory_usage.py
+-rw-rw-rw-  2.0 fat     9669 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_monkeypatch.py
+-rw-rw-rw-  2.0 fat     4124 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_n_jobs_support.py
+-rw-rw-rw-  2.0 fat     1770 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_parallel.py
+-rw-rw-rw-  2.0 fat    14299 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_patching.py
+-rw-rw-rw-  2.0 fat    14008 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_run_to_run_stability_tests.py
+-rw-rw-rw-  2.0 fat      898 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/__init__.py
+-rw-rw-rw-  2.0 fat     3166 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/_namespace.py
+-rw-rw-rw-  2.0 fat     2085 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/parallel.py
+-rw-rw-rw-  2.0 fat      827 b- defN 24-Apr-29 22:09 scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/validation.py
+-rw-rw-rw-  2.0 fat    10999 b- defN 24-Apr-30 15:47 scikit_learn_intelex-2024.4.0.dist-info/LICENSE.txt
+-rw-rw-rw-  2.0 fat    12448 b- defN 24-Apr-30 15:47 scikit_learn_intelex-2024.4.0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       99 b- defN 24-Apr-30 15:47 scikit_learn_intelex-2024.4.0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        1 b- defN 24-Apr-30 15:47 scikit_learn_intelex-2024.4.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat    14816 b- defN 24-Apr-30 15:47 scikit_learn_intelex-2024.4.0.dist-info/RECORD
+101 files, 479572 bytes uncompressed, 127464 bytes compressed:  73.4%
```

## zipnote {}

```diff
@@ -1,295 +1,304 @@
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/__main__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/__main__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_config.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_config.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_device_offload.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_device_offload.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_utils.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_utils.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/conftest.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/conftest.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/dispatcher.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/dispatcher.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/basic_statistics/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/basic_statistics/basic_statistics.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/basic_statistics.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/incremental_basic_statistics.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/dbscan.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/tests/test_incremental_basic_statistics.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/k_means.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_dbscan.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/dbscan.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_kmeans.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/k_means.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_dbscan.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/incremental_covariance.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_kmeans.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/tests/test_incremental_covariance.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/incremental_covariance.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/pca.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/tests/test_incremental_covariance.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/tests/test_pca.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/doc/third-party-programs.txt
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/pca.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/tests/test_pca.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/_forest.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/doc/third-party-programs.txt
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/tests/test_forest.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/glob/__main__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/_forest.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/glob/dispatcher.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/tests/test_forest.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/glob/__main__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/coordinate_descent.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/glob/dispatcher.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/linear.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_path.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/coordinate_descent.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_regression.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/linear.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/ridge.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_path.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_linear.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_regression.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_logreg.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/ridge.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_linear.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/t_sne.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_logreg.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/tests/test_tsne.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/t_sne.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/pairwise.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/tests/test_tsne.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/ranking.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/tests/test_metrics.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/pairwise.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/ranking.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/split.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/tests/test_metrics.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/tests/test_model_selection.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/split.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/_lof.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/tests/test_model_selection.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/common.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_classification.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/_lof.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_regression.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/common.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_unsupervised.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_classification.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/tests/test_neighbors.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_regression.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_unsupervised.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/tests/test_neighbors.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/_common.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/k_means.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/_common.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/covariance.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/k_means.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/tests/test_covariance.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/covariance.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/tests/test_covariance.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/basic_statistics.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/dbscan.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/basic_statistics.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/kmeans.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/dbscan.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/covariance.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/kmeans.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/pca.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/covariance.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/forest.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/pca.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/linear_model.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/forest.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/logistic_regression.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/linear_model.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/neighbors.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/logistic_regression.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/_common.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/neighbors.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/nusvc.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/nusvr.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/_common.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/svc.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/nusvc.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/svr.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/nusvr.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/tests/test_svm.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/svc.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/_utils.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/svr.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_config.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/tests/test_svm.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_memory_usage.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/_utils.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_monkeypatch.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_config.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_n_jobs_support.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_memory_usage.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_parallel.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_monkeypatch.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_patching.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_n_jobs_support.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_run_to_run_stability_tests.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_parallel.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/__init__.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_patching.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/parallel.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_run_to_run_stability_tests.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/validation.py
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/__init__.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.dist-info/LICENSE.txt
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/_namespace.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.dist-info/METADATA
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/parallel.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.dist-info/WHEEL
+Filename: scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/validation.py
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.dist-info/top_level.txt
+Filename: scikit_learn_intelex-2024.4.0.dist-info/LICENSE.txt
 Comment: 
 
-Filename: scikit_learn_intelex-2024.3.0.dist-info/RECORD
+Filename: scikit_learn_intelex-2024.4.0.dist-info/METADATA
+Comment: 
+
+Filename: scikit_learn_intelex-2024.4.0.dist-info/WHEEL
+Comment: 
+
+Filename: scikit_learn_intelex-2024.4.0.dist-info/top_level.txt
+Comment: 
+
+Filename: scikit_learn_intelex-2024.4.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/__main__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/__main__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_config.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_config.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_device_offload.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_device_offload.py`

 * *Files 9% similar despite different names*

```diff
@@ -12,14 +12,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
 import logging
 import sys
+from collections.abc import Iterable
 from functools import wraps
 
 import numpy as np
 
 try:
     from dpctl import SyclQueue
     from dpctl.memory import MemoryUSMDevice, as_usm_memory
@@ -196,28 +197,54 @@
 
 
 def _copy_to_usm(queue, array):
     if not dpctl_available:
         raise RuntimeError(
             "dpctl need to be installed to work " "with __sycl_usm_array_interface__"
         )
-    mem = MemoryUSMDevice(array.nbytes, queue=queue)
-    mem.copy_from_host(array.tobytes())
-    return usm_ndarray(array.shape, array.dtype, buffer=mem)
+
+    if hasattr(array, "__array__"):
+
+        try:
+            mem = MemoryUSMDevice(array.nbytes, queue=queue)
+            mem.copy_from_host(array.tobytes())
+            return usm_ndarray(array.shape, array.dtype, buffer=mem)
+        except ValueError as e:
+            # ValueError will raise if device does not support the dtype
+            # retry with float32 (needed for fp16 and fp64 support issues)
+            # try again as float32, if it is a float32 just raise the error.
+            if array.dtype == np.float32:
+                raise e
+            return _copy_to_usm(queue, array.astype(np.float32))
+    else:
+        if isinstance(array, Iterable):
+            array = [_copy_to_usm(queue, i) for i in array]
+        return array
+
+
+if dpnp_available:
+
+    def _convert_to_dpnp(array):
+        if isinstance(array, usm_ndarray):
+            return dpnp.array(array, copy=False)
+        elif isinstance(array, Iterable):
+            for i in range(len(array)):
+                array[i] = _convert_to_dpnp(array[i])
+        return array
 
 
 def wrap_output_data(func):
     @wraps(func)
     def wrapper(self, *args, **kwargs):
         data = (*args, *kwargs.values())
         if len(data) == 0:
             usm_iface = None
         else:
             usm_iface = getattr(data[0], "__sycl_usm_array_interface__", None)
         result = func(self, *args, **kwargs)
         if usm_iface is not None:
             result = _copy_to_usm(usm_iface["syclobj"], result)
             if dpnp_available and isinstance(data[0], dpnp.ndarray):
-                result = dpnp.array(result, copy=False)
+                result = _convert_to_dpnp(result)
         return result
 
     return wrapper
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/_utils.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/_utils.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/conftest.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/conftest.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/dispatcher.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/dispatcher.py`

 * *Files 0% similar despite different names*

```diff
@@ -310,18 +310,18 @@
 def get_patch_names():
     return list(get_patch_map().keys())
 
 
 def patch_sklearn(name=None, verbose=True, global_patch=False, preview=False):
     if preview:
         os.environ["SKLEARNEX_PREVIEW"] = "enabled_via_patch_sklearn"
-    if not sklearn_check_version("0.22"):
+    if not sklearn_check_version("0.24"):
         raise NotImplementedError(
             "Intel(R) Extension for Scikit-learn* patches apply "
-            "for scikit-learn >= 0.22 only ..."
+            "for scikit-learn >= 0.24 only ..."
         )
 
     if global_patch:
         from sklearnex.glob.dispatcher import patch_sklearn_global
 
         patch_sklearn_global(name, verbose)
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/basic_statistics/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/basic_statistics/basic_statistics.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/basic_statistics/basic_statistics.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/dbscan.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/dbscan.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/k_means.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/k_means.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_dbscan.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_dbscan.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_kmeans.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/cluster/tests/test_kmeans.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/incremental_covariance.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/incremental_covariance.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/covariance/tests/test_incremental_covariance.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/covariance/tests/test_incremental_covariance.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/pca.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/pca.py`

 * *Files 1% similar despite different names*

```diff
@@ -91,14 +91,15 @@
                 self.iterated_power = iterated_power
                 self.random_state = random_state
 
         def fit(self, X, y=None):
             self._fit(X)
             return self
 
+        @wrap_output_data
         def _fit(self, X):
             if sklearn_check_version("1.2"):
                 self._validate_params()
             elif sklearn_check_version("1.1"):
                 check_scalar(
                     self.n_oversamples,
                     "n_oversamples",
@@ -162,21 +163,19 @@
             )
             self._validate_n_features_in_after_fitting(X)
             if sklearn_check_version("1.0"):
                 self._check_feature_names(X, reset=False)
 
             return self._onedal_estimator.predict(X, queue=queue)
 
-        @wrap_output_data
         def fit_transform(self, X, y=None):
             U, S, Vt = self._fit(X)
             if U is None:
                 # oneDAL PCA was fit
-                X_transformed = self._onedal_transform(X)
-                return X_transformed
+                return self.transform(X)
             else:
                 # Scikit-learn PCA was fit
                 U = U[:, : self.n_components_]
 
                 if self.whiten:
                     U *= sqrt(X.shape[0] - 1)
                 else:
@@ -294,19 +293,17 @@
             else:
                 return False
 
         def _save_attributes(self):
             self.n_samples_ = self._onedal_estimator.n_samples_
             if sklearn_check_version("1.2"):
                 self.n_features_in_ = self._onedal_estimator.n_features_
-            elif sklearn_check_version("0.24"):
-                self.n_features_ = self._onedal_estimator.n_features_
-                self.n_features_in_ = self._onedal_estimator.n_features_
             else:
                 self.n_features_ = self._onedal_estimator.n_features_
+                self.n_features_in_ = self._onedal_estimator.n_features_
             self.n_components_ = self._onedal_estimator.n_components_
             self.components_ = self._onedal_estimator.components_
             self.mean_ = self._onedal_estimator.mean_
             self.singular_values_ = self._onedal_estimator.singular_values_
             self.explained_variance_ = self._onedal_estimator.explained_variance_.ravel()
             self.explained_variance_ratio_ = (
                 self._onedal_estimator.explained_variance_ratio_
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/decomposition/tests/test_pca.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/decomposition/tests/test_pca.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/doc/third-party-programs.txt` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/doc/third-party-programs.txt`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/_forest.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/_forest.py`

 * *Files 2% similar despite different names*

```diff
@@ -21,85 +21,64 @@
 import numpy as np
 from scipy import sparse as sp
 from sklearn.base import clone
 from sklearn.ensemble import ExtraTreesClassifier as sklearn_ExtraTreesClassifier
 from sklearn.ensemble import ExtraTreesRegressor as sklearn_ExtraTreesRegressor
 from sklearn.ensemble import RandomForestClassifier as sklearn_RandomForestClassifier
 from sklearn.ensemble import RandomForestRegressor as sklearn_RandomForestRegressor
+from sklearn.ensemble._forest import ForestClassifier as sklearn_ForestClassifier
+from sklearn.ensemble._forest import ForestRegressor as sklearn_ForestRegressor
 from sklearn.ensemble._forest import _get_n_samples_bootstrap
 from sklearn.exceptions import DataConversionWarning
+from sklearn.metrics import accuracy_score
 from sklearn.tree import (
     DecisionTreeClassifier,
     DecisionTreeRegressor,
     ExtraTreeClassifier,
     ExtraTreeRegressor,
 )
 from sklearn.tree._tree import Tree
 from sklearn.utils import check_random_state, deprecated
-from sklearn.utils.validation import (
-    check_array,
-    check_consistent_length,
-    check_is_fitted,
-    check_X_y,
-)
+from sklearn.utils.validation import check_array, check_is_fitted
 
 from daal4py.sklearn._n_jobs_support import control_n_jobs
 from daal4py.sklearn._utils import (
     check_tree_nodes,
     daal_check_version,
     sklearn_check_version,
 )
 from onedal.ensemble import ExtraTreesClassifier as onedal_ExtraTreesClassifier
 from onedal.ensemble import ExtraTreesRegressor as onedal_ExtraTreesRegressor
 from onedal.ensemble import RandomForestClassifier as onedal_RandomForestClassifier
 from onedal.ensemble import RandomForestRegressor as onedal_RandomForestRegressor
-
-# try catch needed for changes in structures observed in Scikit-learn around v0.22
-try:
-    from sklearn.ensemble._forest import ForestClassifier as sklearn_ForestClassifier
-    from sklearn.ensemble._forest import ForestRegressor as sklearn_ForestRegressor
-except ModuleNotFoundError:
-    from sklearn.ensemble.forest import ForestClassifier as sklearn_ForestClassifier
-    from sklearn.ensemble.forest import ForestRegressor as sklearn_ForestRegressor
-
 from onedal.primitives import get_tree_state_cls, get_tree_state_reg
 from onedal.utils import _num_features, _num_samples
+from sklearnex.utils import get_namespace
 
-from .._config import get_config
 from .._device_offload import dispatch, wrap_output_data
 from .._utils import PatchingConditionsChain
 
 if sklearn_check_version("1.2"):
     from sklearn.utils._param_validation import Interval
 if sklearn_check_version("1.4"):
     from daal4py.sklearn.utils import _assert_all_finite
 
 
 class BaseForest(ABC):
     _onedal_factory = None
 
     def _onedal_fit(self, X, y, sample_weight=None, queue=None):
-        if sklearn_check_version("0.24"):
-            X, y = self._validate_data(
-                X,
-                y,
-                multi_output=False,
-                accept_sparse=False,
-                dtype=[np.float64, np.float32],
-                force_all_finite=False,
-            )
-        else:
-            X, y = check_X_y(
-                X,
-                y,
-                accept_sparse=False,
-                dtype=[np.float64, np.float32],
-                multi_output=False,
-                force_all_finite=False,
-            )
+        X, y = self._validate_data(
+            X,
+            y,
+            multi_output=False,
+            accept_sparse=False,
+            dtype=[np.float64, np.float32],
+            force_all_finite=False,
+        )
 
         if sample_weight is not None:
             sample_weight = self.check_sample_weight(sample_weight, X)
 
         if y.ndim == 2 and y.shape[1] == 1:
             warnings.warn(
                 "A column-vector y was passed when a 1d array was"
@@ -169,23 +148,14 @@
         # Decapsulate classes_ attributes
         if hasattr(self, "classes_") and self.n_outputs_ == 1:
             self.n_classes_ = self.n_classes_[0]
             self.classes_ = self.classes_[0]
 
         return self
 
-    def _fit_proba(self, X, y, sample_weight=None, queue=None):
-        params = self.get_params()
-        self.__class__(**params)
-
-        # We use stock metaestimators below, so the only way
-        # to pass a queue is using config_context.
-        cfg = get_config()
-        cfg["target_offload"] = queue
-
     def _save_attributes(self):
         if self.oob_score:
             self.oob_score_ = self._onedal_estimator.oob_score_
             if hasattr(self._onedal_estimator, "oob_prediction_"):
                 self.oob_prediction_ = self._onedal_estimator.oob_prediction_
             if hasattr(self._onedal_estimator, "oob_decision_function_"):
                 self.oob_decision_function_ = (
@@ -200,16 +170,14 @@
                 1,
             )
         else:
             self._n_samples_bootstrap = None
         self._validate_estimator()
         return self
 
-    # TODO:
-    # move to onedal modul.
     def _check_parameters(self):
         if isinstance(self.min_samples_leaf, numbers.Integral):
             if not 1 <= self.min_samples_leaf:
                 raise ValueError(
                     "min_samples_leaf must be at least 1 "
                     "or in (0, 0.5], got %s" % self.min_samples_leaf
                 )
@@ -546,26 +514,22 @@
                         self.monotonic_cst is None,
                         "Monotonicity constraints are not supported.",
                     ),
                 ]
             )
 
         if patching_status.get_status():
-            if sklearn_check_version("0.24"):
-                X, y = self._validate_data(
-                    X,
-                    y,
-                    multi_output=True,
-                    accept_sparse=True,
-                    dtype=[np.float64, np.float32],
-                    force_all_finite=False,
-                )
-            else:
-                X = check_array(X, dtype=[np.float64, np.float32], force_all_finite=False)
-                y = check_array(y, ensure_2d=False, dtype=X.dtype, force_all_finite=False)
+            X, y = self._validate_data(
+                X,
+                y,
+                multi_output=True,
+                accept_sparse=True,
+                dtype=[np.float64, np.float32],
+                force_all_finite=False,
+            )
 
             if y.ndim == 2 and y.shape[1] == 1:
                 warnings.warn(
                     "A column-vector y was passed when a 1d array was"
                     " expected. Please change the shape of y to "
                     "(n_samples,), for example using ravel().",
                     DataConversionWarning,
@@ -651,17 +615,46 @@
             {
                 "onedal": self.__class__._onedal_predict_proba,
                 "sklearn": sklearn_ForestClassifier.predict_proba,
             },
             X,
         )
 
+    def predict_log_proba(self, X):
+        xp, _ = get_namespace(X)
+        proba = self.predict_proba(X)
+
+        if self.n_outputs_ == 1:
+            return xp.log(proba)
+
+        else:
+            for k in range(self.n_outputs_):
+                proba[k] = xp.log(proba[k])
+
+            return proba
+
+    @wrap_output_data
+    def score(self, X, y, sample_weight=None):
+        return dispatch(
+            self,
+            "score",
+            {
+                "onedal": self.__class__._onedal_score,
+                "sklearn": sklearn_ForestClassifier.score,
+            },
+            X,
+            y,
+            sample_weight=sample_weight,
+        )
+
     fit.__doc__ = sklearn_ForestClassifier.fit.__doc__
     predict.__doc__ = sklearn_ForestClassifier.predict.__doc__
     predict_proba.__doc__ = sklearn_ForestClassifier.predict_proba.__doc__
+    predict_log_proba.__doc__ = sklearn_ForestClassifier.predict_log_proba.__doc__
+    score.__doc__ = sklearn_ForestClassifier.score.__doc__
 
     def _onedal_cpu_supported(self, method_name, *data):
         class_name = self.__class__.__name__
         patching_status = PatchingConditionsChain(
             f"sklearn.ensemble.{class_name}.{method_name}"
         )
 
@@ -680,15 +673,15 @@
                     (
                         not sp.issparse(sample_weight),
                         "sample_weight is sparse. " "Sparse input is not supported.",
                     ),
                 ]
             )
 
-        elif method_name in ["predict", "predict_proba"]:
+        elif method_name in ["predict", "predict_proba", "score"]:
             X = data[0]
 
             patching_status.and_conditions(
                 [
                     (hasattr(self, "_onedal_estimator"), "oneDAL model was not trained."),
                     (not sp.issparse(X), "X is sparse. Sparse input is not supported."),
                     (self.warm_start is False, "Warm start is not supported."),
@@ -745,15 +738,15 @@
                         or self.estimator.__class__ == DecisionTreeClassifier,
                         "ExtraTrees only supported starting from oneDAL version 2023.1",
                     ),
                     (sample_weight is None, "sample_weight is not supported."),
                 ]
             )
 
-        elif method_name in ["predict", "predict_proba"]:
+        elif method_name in ["predict", "predict_proba", "score"]:
             X = data[0]
 
             patching_status.and_conditions(
                 [
                     (hasattr(self, "_onedal_estimator"), "oneDAL model was not trained"),
                     (
                         not sp.issparse(X),
@@ -797,20 +790,24 @@
         res = self._onedal_estimator.predict(X, queue=queue)
         return np.take(self.classes_, res.ravel().astype(np.int64, casting="unsafe"))
 
     def _onedal_predict_proba(self, X, queue=None):
         X = check_array(X, dtype=[np.float64, np.float32], force_all_finite=False)
         check_is_fitted(self, "_onedal_estimator")
 
-        if sklearn_check_version("0.23"):
-            self._check_n_features(X, reset=False)
+        self._check_n_features(X, reset=False)
         if sklearn_check_version("1.0"):
             self._check_feature_names(X, reset=False)
         return self._onedal_estimator.predict_proba(X, queue=queue)
 
+    def _onedal_score(self, X, y, sample_weight=None, queue=None):
+        return accuracy_score(
+            y, self._onedal_predict(X, queue=queue), sample_weight=sample_weight
+        )
+
 
 class ForestRegressor(sklearn_ForestRegressor, BaseForest):
     _err = "out_of_bag_error_r2|out_of_bag_error_prediction"
     _get_tree_state = staticmethod(get_tree_state_reg)
 
     def __init__(
         self,
@@ -912,26 +909,22 @@
                         self.monotonic_cst is None,
                         "Monotonicity constraints are not supported.",
                     ),
                 ]
             )
 
         if patching_status.get_status():
-            if sklearn_check_version("0.24"):
-                X, y = self._validate_data(
-                    X,
-                    y,
-                    multi_output=True,
-                    accept_sparse=True,
-                    dtype=[np.float64, np.float32],
-                    force_all_finite=False,
-                )
-            else:
-                X = check_array(X, dtype=[np.float64, np.float32], force_all_finite=False)
-                y = check_array(y, ensure_2d=False, dtype=X.dtype, force_all_finite=False)
+            X, y = self._validate_data(
+                X,
+                y,
+                multi_output=True,
+                accept_sparse=True,
+                dtype=[np.float64, np.float32],
+                force_all_finite=False,
+            )
 
             if y.ndim == 2 and y.shape[1] == 1:
                 warnings.warn(
                     "A column-vector y was passed when a 1d array was"
                     " expected. Please change the shape of y to "
                     "(n_samples,), for example using ravel().",
                     DataConversionWarning,
@@ -1125,15 +1118,15 @@
             X,
         )
 
     fit.__doc__ = sklearn_ForestRegressor.fit.__doc__
     predict.__doc__ = sklearn_ForestRegressor.predict.__doc__
 
 
-@control_n_jobs(decorated_methods=["fit", "predict", "predict_proba"])
+@control_n_jobs(decorated_methods=["fit", "predict", "predict_proba", "score"])
 class RandomForestClassifier(ForestClassifier):
     __doc__ = sklearn_RandomForestClassifier.__doc__
     _onedal_factory = onedal_RandomForestClassifier
 
     if sklearn_check_version("1.2"):
         _parameter_constraints: dict = {
             **sklearn_RandomForestClassifier._parameter_constraints,
@@ -1536,15 +1529,15 @@
             self.min_impurity_decrease = min_impurity_decrease
             self.min_impurity_split = min_impurity_split
             self.ccp_alpha = ccp_alpha
             self.max_bins = max_bins
             self.min_bin_size = min_bin_size
 
 
-@control_n_jobs(decorated_methods=["fit", "predict", "predict_proba"])
+@control_n_jobs(decorated_methods=["fit", "predict", "predict_proba", "score"])
 class ExtraTreesClassifier(ForestClassifier):
     __doc__ = sklearn_ExtraTreesClassifier.__doc__
     _onedal_factory = onedal_ExtraTreesClassifier
 
     if sklearn_check_version("1.2"):
         _parameter_constraints: dict = {
             **sklearn_ExtraTreesClassifier._parameter_constraints,
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/ensemble/tests/test_forest.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/ensemble/tests/test_forest.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/glob/__main__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/glob/__main__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/glob/dispatcher.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/glob/dispatcher.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/coordinate_descent.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/coordinate_descent.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/linear.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/linear.py`

 * *Files 17% similar despite different names*

```diff
@@ -13,369 +13,304 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ===============================================================================
 
 import logging
 from abc import ABC
 
-from daal4py.sklearn._utils import daal_check_version
-
-
-def get_coef(self):
-    return self._coef_
-
-
-def set_coef(self, value):
-    self._coef_ = value
-    if hasattr(self, "_onedal_estimator"):
-        self._onedal_estimator.coef_ = value
-        if not self._is_in_fit:
-            del self._onedal_estimator._onedal_model
-
-
-def get_intercept(self):
-    return self._intercept_
-
-
-def set_intercept(self, value):
-    self._intercept_ = value
-    if hasattr(self, "_onedal_estimator"):
-        self._onedal_estimator.intercept_ = value
-        if not self._is_in_fit:
-            del self._onedal_estimator._onedal_model
-
+import numpy as np
+from sklearn.exceptions import NotFittedError
+from sklearn.linear_model import LinearRegression as sklearn_LinearRegression
+
+from daal4py.sklearn._n_jobs_support import control_n_jobs
+from daal4py.sklearn._utils import sklearn_check_version
+
+from .._device_offload import dispatch, wrap_output_data
+from .._utils import PatchingConditionsChain, get_patch_message, register_hyperparameters
+from ..utils.validation import _assert_all_finite
+
+if sklearn_check_version("1.0") and not sklearn_check_version("1.2"):
+    from sklearn.linear_model._base import _deprecate_normalize
+
+from scipy.sparse import issparse
+from sklearn.utils.validation import check_X_y
+
+from onedal.common.hyperparameters import get_hyperparameters
+from onedal.linear_model import LinearRegression as onedal_LinearRegression
+from onedal.utils import _num_features, _num_samples
+
+
+@register_hyperparameters({"fit": get_hyperparameters("linear_regression", "train")})
+@control_n_jobs(decorated_methods=["fit", "predict"])
+class LinearRegression(sklearn_LinearRegression):
+    __doc__ = sklearn_LinearRegression.__doc__
+
+    if sklearn_check_version("1.2"):
+        _parameter_constraints: dict = {**sklearn_LinearRegression._parameter_constraints}
+
+        def __init__(
+            self,
+            fit_intercept=True,
+            copy_X=True,
+            n_jobs=None,
+            positive=False,
+        ):
+            super().__init__(
+                fit_intercept=fit_intercept,
+                copy_X=copy_X,
+                n_jobs=n_jobs,
+                positive=positive,
+            )
+
+    else:
+
+        def __init__(
+            self,
+            fit_intercept=True,
+            normalize="deprecated" if sklearn_check_version("1.0") else False,
+            copy_X=True,
+            n_jobs=None,
+            positive=False,
+        ):
+            super().__init__(
+                fit_intercept=fit_intercept,
+                normalize=normalize,
+                copy_X=copy_X,
+                n_jobs=n_jobs,
+                positive=positive,
+            )
+
+    def fit(self, X, y, sample_weight=None):
+        if sklearn_check_version("1.0"):
+            self._check_feature_names(X, reset=True)
+        if sklearn_check_version("1.2"):
+            self._validate_params()
 
-class BaseLinearRegression(ABC):
-    def _save_attributes(self):
-        self.n_features_in_ = self._onedal_estimator.n_features_in_
-        self.fit_status_ = 0
-        self._coef_ = self._onedal_estimator.coef_
-        self._intercept_ = self._onedal_estimator.intercept_
-        self._sparse = False
+        # It is necessary to properly update coefs for predict if we
+        # fallback to sklearn in dispatch
+        if hasattr(self, "_onedal_estimator"):
+            del self._onedal_estimator
+
+        dispatch(
+            self,
+            "fit",
+            {
+                "onedal": self.__class__._onedal_fit,
+                "sklearn": sklearn_LinearRegression.fit,
+            },
+            X,
+            y,
+            sample_weight,
+        )
+        return self
+
+    @wrap_output_data
+    def predict(self, X):
+
+        if not hasattr(self, "coef_"):
+            msg = (
+                "This %(name)s instance is not fitted yet. Call 'fit' with "
+                "appropriate arguments before using this estimator."
+            )
+            raise NotFittedError(msg % {"name": self.__class__.__name__})
+
+        return dispatch(
+            self,
+            "predict",
+            {
+                "onedal": self.__class__._onedal_predict,
+                "sklearn": sklearn_LinearRegression.predict,
+            },
+            X,
+        )
+
+    def _test_type_and_finiteness(self, X_in):
+        X = X_in if isinstance(X_in, np.ndarray) else np.asarray(X_in)
+
+        dtype = X.dtype
+        if "complex" in str(type(dtype)):
+            return False
+
+        try:
+            _assert_all_finite(X)
+        except BaseException:
+            return False
+        return True
+
+    def _onedal_fit_supported(self, method_name, *data):
+        assert method_name == "fit"
+        assert len(data) == 3
+        X, y, sample_weight = data
+
+        class_name = self.__class__.__name__
+        patching_status = PatchingConditionsChain(
+            f"sklearn.linear_model.{class_name}.fit"
+        )
+
+        normalize_is_set = (
+            hasattr(self, "normalize")
+            and self.normalize
+            and self.normalize != "deprecated"
+        )
+        positive_is_set = hasattr(self, "positive") and self.positive
+
+        n_samples = _num_samples(X)
+        n_features = _num_features(X, fallback_1d=True)
+
+        # Check if equations are well defined
+        is_good_for_onedal = n_samples >= (n_features + int(self.fit_intercept))
+
+        dal_ready = patching_status.and_conditions(
+            [
+                (sample_weight is None, "Sample weight is not supported."),
+                (
+                    not issparse(X) and not issparse(y),
+                    "Sparse input is not supported.",
+                ),
+                (not normalize_is_set, "Normalization is not supported."),
+                (
+                    not positive_is_set,
+                    "Forced positive coefficients are not supported.",
+                ),
+                (
+                    is_good_for_onedal,
+                    "The shape of X (fitting) does not satisfy oneDAL requirements:"
+                    "Number of features + 1 >= number of samples.",
+                ),
+            ]
+        )
+        if not dal_ready:
+            return patching_status
 
-        self.coef_ = property(get_coef, set_coef)
-        self.intercept_ = property(get_intercept, set_intercept)
+        if not patching_status.and_condition(
+            self._test_type_and_finiteness(X), "Input X is not supported."
+        ):
+            return patching_status
 
-        self._is_in_fit = True
-        self.coef_ = self._coef_
-        self.intercept_ = self._intercept_
-        self._is_in_fit = False
-
-
-if daal_check_version((2023, "P", 100)):
-    import numpy as np
-    from sklearn.linear_model import LinearRegression as sklearn_LinearRegression
-
-    from daal4py.sklearn._n_jobs_support import control_n_jobs
-    from daal4py.sklearn._utils import get_dtype, make2d, sklearn_check_version
-
-    from .._device_offload import dispatch, wrap_output_data
-    from .._utils import (
-        PatchingConditionsChain,
-        get_patch_message,
-        register_hyperparameters,
-    )
-    from ..utils.validation import _assert_all_finite
-
-    if sklearn_check_version("1.0") and not sklearn_check_version("1.2"):
-        from sklearn.linear_model._base import _deprecate_normalize
-
-    from scipy.sparse import issparse
-    from sklearn.exceptions import NotFittedError
-    from sklearn.utils.validation import _deprecate_positional_args, check_X_y
-
-    from onedal.common.hyperparameters import get_hyperparameters
-    from onedal.linear_model import LinearRegression as onedal_LinearRegression
-    from onedal.utils import _num_features, _num_samples
-
-    @register_hyperparameters({"fit": get_hyperparameters("linear_regression", "train")})
-    @control_n_jobs(decorated_methods=["fit", "predict"])
-    class LinearRegression(sklearn_LinearRegression, BaseLinearRegression):
-        __doc__ = sklearn_LinearRegression.__doc__
-        intercept_, coef_ = None, None
+        patching_status.and_condition(
+            self._test_type_and_finiteness(y), "Input y is not supported."
+        )
+
+        return patching_status
+
+    def _onedal_predict_supported(self, method_name, *data):
+        assert method_name == "predict"
+        assert len(data) == 1
+
+        class_name = self.__class__.__name__
+        patching_status = PatchingConditionsChain(
+            f"sklearn.linear_model.{class_name}.predict"
+        )
+
+        n_samples = _num_samples(*data)
+        model_is_sparse = issparse(self.coef_) or (
+            self.fit_intercept and issparse(self.intercept_)
+        )
+        dal_ready = patching_status.and_conditions(
+            [
+                (n_samples > 0, "Number of samples is less than 1."),
+                (not issparse(*data), "Sparse input is not supported."),
+                (not model_is_sparse, "Sparse coefficients are not supported."),
+            ]
+        )
+        if not dal_ready:
+            return patching_status
 
+        patching_status.and_condition(
+            self._test_type_and_finiteness(*data), "Input X is not supported."
+        )
+
+        return patching_status
+
+    def _onedal_supported(self, method_name, *data):
+        if method_name == "fit":
+            return self._onedal_fit_supported(method_name, *data)
+        if method_name == "predict":
+            return self._onedal_predict_supported(method_name, *data)
+        raise RuntimeError(f"Unknown method {method_name} in {self.__class__.__name__}")
+
+    _onedal_gpu_supported = _onedal_supported
+    _onedal_cpu_supported = _onedal_supported
+
+    def _initialize_onedal_estimator(self):
+        onedal_params = {"fit_intercept": self.fit_intercept, "copy_X": self.copy_X}
+        self._onedal_estimator = onedal_LinearRegression(**onedal_params)
+
+    def _onedal_fit(self, X, y, sample_weight, queue=None):
+        assert sample_weight is None
+
+        check_params = {
+            "X": X,
+            "y": y,
+            "dtype": [np.float64, np.float32],
+            "accept_sparse": ["csr", "csc", "coo"],
+            "y_numeric": True,
+            "multi_output": True,
+            "force_all_finite": False,
+        }
         if sklearn_check_version("1.2"):
-            _parameter_constraints: dict = {
-                **sklearn_LinearRegression._parameter_constraints
-            }
-
-            def __init__(
-                self,
-                fit_intercept=True,
-                copy_X=True,
-                n_jobs=None,
-                positive=False,
-            ):
-                super().__init__(
-                    fit_intercept=fit_intercept,
-                    copy_X=copy_X,
-                    n_jobs=n_jobs,
-                    positive=positive,
-                )
-
-        elif sklearn_check_version("0.24"):
-
-            def __init__(
-                self,
-                fit_intercept=True,
-                normalize="deprecated" if sklearn_check_version("1.0") else False,
-                copy_X=True,
-                n_jobs=None,
-                positive=False,
-            ):
-                super().__init__(
-                    fit_intercept=fit_intercept,
-                    normalize=normalize,
-                    copy_X=copy_X,
-                    n_jobs=n_jobs,
-                    positive=positive,
-                )
-
+            X, y = self._validate_data(**check_params)
         else:
+            X, y = check_X_y(**check_params)
 
-            def __init__(
-                self,
-                fit_intercept=True,
-                normalize=False,
-                copy_X=True,
-                n_jobs=None,
-            ):
-                super().__init__(
-                    fit_intercept=fit_intercept,
-                    normalize=normalize,
-                    copy_X=copy_X,
-                    n_jobs=n_jobs,
-                )
-
-        def fit(self, X, y, sample_weight=None):
-            """
-            Fit linear model.
-            Parameters
-            ----------
-            X : {array-like, sparse matrix} of shape (n_samples, n_features)
-                Training data.
-            y : array-like of shape (n_samples,) or (n_samples, n_targets)
-                Target values. Will be cast to X's dtype if necessary.
-            sample_weight : array-like of shape (n_samples,), default=None
-                Individual weights for each sample.
-                .. versionadded:: 0.17
-                   parameter *sample_weight* support to LinearRegression.
-            Returns
-            -------
-            self : object
-                Fitted Estimator.
-            """
-            if sklearn_check_version("1.0"):
-                self._check_feature_names(X, reset=True)
-            if sklearn_check_version("1.2"):
-                self._validate_params()
-
-            dispatch(
-                self,
-                "fit",
-                {
-                    "onedal": self.__class__._onedal_fit,
-                    "sklearn": sklearn_LinearRegression.fit,
-                },
-                X,
-                y,
-                sample_weight,
-            )
-            return self
-
-        @wrap_output_data
-        def predict(self, X):
-            """
-            Predict using the linear model.
-            Parameters
-            ----------
-            X : array-like or sparse matrix, shape (n_samples, n_features)
-                Samples.
-            Returns
-            -------
-            C : array, shape (n_samples, n_targets)
-                Returns predicted values.
-            """
-            if sklearn_check_version("1.0"):
-                self._check_feature_names(X, reset=False)
-            return dispatch(
-                self,
-                "predict",
-                {
-                    "onedal": self.__class__._onedal_predict,
-                    "sklearn": sklearn_LinearRegression.predict,
-                },
-                X,
-            )
-
-        def _test_type_and_finiteness(self, X_in):
-            X = X_in if isinstance(X_in, np.ndarray) else np.asarray(X_in)
-
-            dtype = X.dtype
-            if "complex" in str(type(dtype)):
-                return False
-
-            try:
-                _assert_all_finite(X)
-            except BaseException:
-                return False
-            return True
-
-        def _onedal_fit_supported(self, method_name, *data):
-            assert method_name == "fit"
-            assert len(data) == 3
-            X, y, sample_weight = data
-
-            class_name = self.__class__.__name__
-            patching_status = PatchingConditionsChain(
-                f"sklearn.linear_model.{class_name}.fit"
-            )
-
-            normalize_is_set = (
-                hasattr(self, "normalize")
-                and self.normalize
-                and self.normalize != "deprecated"
+        if sklearn_check_version("1.0") and not sklearn_check_version("1.2"):
+            self._normalize = _deprecate_normalize(
+                self.normalize,
+                default=False,
+                estimator_name=self.__class__.__name__,
             )
-            positive_is_set = hasattr(self, "positive") and self.positive
-
-            n_samples = _num_samples(X)
-            n_features = _num_features(X, fallback_1d=True)
 
-            # Check if equations are well defined
-            is_good_for_onedal = n_samples > (n_features + int(self.fit_intercept))
+        self._initialize_onedal_estimator()
+        try:
+            self._onedal_estimator.fit(X, y, queue=queue)
+            self._save_attributes()
 
-            dal_ready = patching_status.and_conditions(
-                [
-                    (sample_weight is None, "Sample weight is not supported."),
-                    (
-                        not issparse(X) and not issparse(y),
-                        "Sparse input is not supported.",
-                    ),
-                    (not normalize_is_set, "Normalization is not supported."),
-                    (
-                        not positive_is_set,
-                        "Forced positive coefficients are not supported.",
-                    ),
-                    (
-                        is_good_for_onedal,
-                        "The shape of X (fitting) does not satisfy oneDAL requirements:."
-                        "Number of features + 1 >= number of samples.",
-                    ),
-                ]
+        except RuntimeError:
+            logging.getLogger("sklearnex").info(
+                f"{self.__class__.__name__}.fit "
+                + get_patch_message("sklearn_after_onedal")
             )
-            if not dal_ready:
-                return patching_status
 
-            if not patching_status.and_condition(
-                self._test_type_and_finiteness(X), "Input X is not supported."
-            ):
-                return patching_status
+            del self._onedal_estimator
+            super().fit(X, y)
 
-            patching_status.and_condition(
-                self._test_type_and_finiteness(y), "Input y is not supported."
-            )
+    def _onedal_predict(self, X, queue=None):
+        if sklearn_check_version("1.0"):
+            self._check_feature_names(X, reset=False)
 
-            return patching_status
-
-        def _onedal_predict_supported(self, method_name, *data):
-            assert method_name == "predict"
-            assert len(data) == 1
-
-            class_name = self.__class__.__name__
-            patching_status = PatchingConditionsChain(
-                f"sklearn.linear_model.{class_name}.predict"
-            )
-
-            n_samples = _num_samples(*data)
-            model_is_sparse = issparse(self.coef_) or (
-                self.fit_intercept and issparse(self.intercept_)
-            )
-            dal_ready = patching_status.and_conditions(
-                [
-                    (n_samples > 0, "Number of samples is less than 1."),
-                    (not issparse(*data), "Sparse input is not supported."),
-                    (not model_is_sparse, "Sparse coefficients are not supported."),
-                    (hasattr(self, "_onedal_estimator"), "oneDAL model was not trained."),
-                ]
-            )
-            if not dal_ready:
-                return patching_status
+        X = self._validate_data(X, accept_sparse=False, reset=False)
+        if not hasattr(self, "_onedal_estimator"):
+            self._initialize_onedal_estimator()
+            self._onedal_estimator.coef_ = self.coef_
+            self._onedal_estimator.intercept_ = self.intercept_
 
-            patching_status.and_condition(
-                self._test_type_and_finiteness(*data), "Input X is not supported."
-            )
+        res = self._onedal_estimator.predict(X, queue=queue)
+        return res
 
-            return patching_status
+    def get_coef_(self):
+        return self.coef_
 
-        def _onedal_supported(self, method_name, *data):
-            if method_name == "fit":
-                return self._onedal_fit_supported(method_name, *data)
-            if method_name == "predict":
-                return self._onedal_predict_supported(method_name, *data)
-            raise RuntimeError(
-                f"Unknown method {method_name} in {self.__class__.__name__}"
-            )
+    def set_coef_(self, value):
+        self.__dict__["coef_"] = value
+        if hasattr(self, "_onedal_estimator"):
+            self._onedal_estimator.coef_ = value
+            del self._onedal_estimator._onedal_model
 
-        def _onedal_gpu_supported(self, method_name, *data):
-            return self._onedal_supported(method_name, *data)
+    def get_intercept_(self):
+        return self.intercept_
 
-        def _onedal_cpu_supported(self, method_name, *data):
-            return self._onedal_supported(method_name, *data)
+    def set_intercept_(self, value):
+        self.__dict__["intercept_"] = value
+        if hasattr(self, "_onedal_estimator"):
+            self._onedal_estimator.intercept_ = value
+            del self._onedal_estimator._onedal_model
 
-        def _initialize_onedal_estimator(self):
-            onedal_params = {"fit_intercept": self.fit_intercept, "copy_X": self.copy_X}
-            self._onedal_estimator = onedal_LinearRegression(**onedal_params)
-
-        def _onedal_fit(self, X, y, sample_weight, queue=None):
-            assert sample_weight is None
-
-            check_params = {
-                "X": X,
-                "y": y,
-                "dtype": [np.float64, np.float32],
-                "accept_sparse": ["csr", "csc", "coo"],
-                "y_numeric": True,
-                "multi_output": True,
-                "force_all_finite": False,
-            }
-            if sklearn_check_version("1.2"):
-                X, y = self._validate_data(**check_params)
-            else:
-                X, y = check_X_y(**check_params)
-
-            if sklearn_check_version("1.0") and not sklearn_check_version("1.2"):
-                self._normalize = _deprecate_normalize(
-                    self.normalize,
-                    default=False,
-                    estimator_name=self.__class__.__name__,
-                )
+    def _save_attributes(self):
+        self.coef_ = property(self.get_coef_, self.set_coef_)
+        self.intercept_ = property(self.get_intercept_, self.set_intercept_)
+        self.n_features_in_ = self._onedal_estimator.n_features_in_
+        self._sparse = False
+        self.__dict__["coef_"] = self._onedal_estimator.coef_
+        self.__dict__["intercept_"] = self._onedal_estimator.intercept_
 
-            self._initialize_onedal_estimator()
-            try:
-                self._onedal_estimator.fit(X, y, queue=queue)
-                self._save_attributes()
-
-            except RuntimeError:
-                logging.getLogger("sklearnex").info(
-                    f"{self.__class__.__name__}.fit "
-                    + get_patch_message("sklearn_after_onedal")
-                )
-
-                del self._onedal_estimator
-                super().fit(X, y)
-
-        def _onedal_predict(self, X, queue=None):
-            X = self._validate_data(X, accept_sparse=False, reset=False)
-            if not hasattr(self, "_onedal_estimator"):
-                self._initialize_onedal_estimator()
-                self._onedal_estimator.coef_ = self.coef_
-                self._onedal_estimator.intercept_ = self.intercept_
-
-            return self._onedal_estimator.predict(X, queue=queue)
-
-else:
-    from daal4py.sklearn.linear_model import LinearRegression
-
-    logging.warning(
-        "Sklearnex LinearRegression requires oneDAL version >= 2023.1 "
-        "but it was not found"
-    )
+    fit.__doc__ = sklearn_LinearRegression.fit.__doc__
+    predict.__doc__ = sklearn_LinearRegression.predict.__doc__
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_path.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_path.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_regression.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/logistic_regression.py`

 * *Files 4% similar despite different names*

```diff
@@ -34,27 +34,35 @@
         self.n_iter_ = self._onedal_estimator.n_iter_
 
 
 if daal_check_version((2024, "P", 1)):
     import numpy as np
     from scipy.sparse import issparse
     from sklearn.linear_model import LogisticRegression as sklearn_LogisticRegression
+    from sklearn.metrics import accuracy_score
+    from sklearn.utils.multiclass import type_of_target
     from sklearn.utils.validation import check_X_y
 
     from daal4py.sklearn._n_jobs_support import control_n_jobs
     from daal4py.sklearn._utils import sklearn_check_version
     from onedal.linear_model import LogisticRegression as onedal_LogisticRegression
-    from onedal.utils import _num_features, _num_samples
+    from onedal.utils import _num_samples
 
     from .._device_offload import dispatch, wrap_output_data
     from .._utils import PatchingConditionsChain, get_patch_message
     from ..utils.validation import _assert_all_finite
 
     @control_n_jobs(
-        decorated_methods=["fit", "predict", "predict_proba", "predict_log_proba"]
+        decorated_methods=[
+            "fit",
+            "predict",
+            "predict_proba",
+            "predict_log_proba",
+            "score",
+        ]
     )
     class LogisticRegression(sklearn_LogisticRegression, BaseLogisticRegression):
         __doc__ = sklearn_LogisticRegression.__doc__
         intercept_, coef_, n_iter_ = None, None, None
 
         if sklearn_check_version("1.2"):
             _parameter_constraints: dict = {
@@ -68,17 +76,17 @@
             dual=False,
             tol=1e-4,
             C=1.0,
             fit_intercept=True,
             intercept_scaling=1,
             class_weight=None,
             random_state=None,
-            solver="lbfgs" if sklearn_check_version("0.22") else "liblinear",
+            solver="lbfgs",
             max_iter=100,
-            multi_class="auto" if sklearn_check_version("0.22") else "ovr",
+            multi_class="auto",
             verbose=0,
             warm_start=False,
             n_jobs=None,
             l1_ratio=None,
         ):
             super().__init__(
                 penalty=penalty,
@@ -156,14 +164,35 @@
                 {
                     "onedal": self.__class__._onedal_predict_log_proba,
                     "sklearn": sklearn_LogisticRegression.predict_log_proba,
                 },
                 X,
             )
 
+        @wrap_output_data
+        def score(self, X, y, sample_weight=None):
+            if sklearn_check_version("1.0"):
+                self._check_feature_names(X, reset=False)
+            return dispatch(
+                self,
+                "score",
+                {
+                    "onedal": self.__class__._onedal_score,
+                    "sklearn": sklearn_LogisticRegression.score,
+                },
+                X,
+                y,
+                sample_weight=sample_weight,
+            )
+
+        def _onedal_score(self, X, y, sample_weight=None, queue=None):
+            return accuracy_score(
+                y, self._onedal_predict(X, queue=queue), sample_weight=sample_weight
+            )
+
         def _test_type_and_finiteness(self, X_in):
             X = np.asarray(X_in)
 
             if np.iscomplexobj(X):
                 return False
             try:
                 _assert_all_finite(X)
@@ -194,14 +223,18 @@
                     (
                         self.multi_class != "multinomial",
                         "multi_class parameter is not supported.",
                     ),
                     (self.warm_start == False, "Warm start is not supported."),
                     (self.l1_ratio is None, "l1 ratio is not supported."),
                     (sample_weight is None, "Sample weight is not supported."),
+                    (
+                        type_of_target(y) == "binary",
+                        "Only binary classification is supported",
+                    ),
                 ]
             )
 
             if not dal_ready:
                 return patching_status
 
             if not patching_status.and_condition(
@@ -212,30 +245,37 @@
             patching_status.and_condition(
                 self._test_type_and_finiteness(y), "Input y is not supported."
             )
 
             return patching_status
 
         def _onedal_gpu_predict_supported(self, method_name, *data):
-            assert method_name in ["predict", "predict_proba", "predict_log_proba"]
-            assert len(data) == 1
+            assert method_name in [
+                "predict",
+                "predict_proba",
+                "predict_log_proba",
+                "score",
+            ]
 
             class_name = self.__class__.__name__
             patching_status = PatchingConditionsChain(
                 f"sklearn.linear_model.{class_name}.{method_name}"
             )
 
-            n_samples = _num_samples(*data)
+            n_samples = _num_samples(data[0])
             model_is_sparse = issparse(self.coef_) or (
                 self.fit_intercept and issparse(self.intercept_)
             )
             dal_ready = patching_status.and_conditions(
                 [
                     (n_samples > 0, "Number of samples is less than 1."),
-                    (not issparse(*data), "Sparse input is not supported."),
+                    (
+                        not any([issparse(i) for i in data]),
+                        "Sparse input is not supported.",
+                    ),
                     (not model_is_sparse, "Sparse coefficients are not supported."),
                     (
                         hasattr(self, "_onedal_estimator"),
                         "oneDAL model was not trained.",
                     ),
                 ]
             )
@@ -247,15 +287,15 @@
             )
 
             return patching_status
 
         def _onedal_gpu_supported(self, method_name, *data):
             if method_name == "fit":
                 return self._onedal_gpu_fit_supported(method_name, *data)
-            if method_name in ["predict", "predict_proba", "predict_log_proba"]:
+            if method_name in ["predict", "predict_proba", "predict_log_proba", "score"]:
                 return self._onedal_gpu_predict_supported(method_name, *data)
             raise RuntimeError(
                 f"Unknown method {method_name} in {self.__class__.__name__}"
             )
 
         def _onedal_cpu_supported(self, method_name, *data):
             class_name = self.__class__.__name__
@@ -330,14 +370,15 @@
             assert hasattr(self, "_onedal_estimator")
             return self._onedal_estimator.predict_log_proba(X, queue=queue)
 
         fit.__doc__ = sklearn_LogisticRegression.fit.__doc__
         predict.__doc__ = sklearn_LogisticRegression.predict.__doc__
         predict_proba.__doc__ = sklearn_LogisticRegression.predict_proba.__doc__
         predict_log_proba.__doc__ = sklearn_LogisticRegression.predict_log_proba.__doc__
+        score.__doc__ = sklearn_LogisticRegression.score.__doc__
 
 else:
     LogisticRegression = LogisticRegression_daal4py
 
     logging.warning(
         "Sklearnex LogisticRegression requires oneDAL version >= 2024.0.1 "
         "but it was not found"
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/ridge.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/ridge.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_linear.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_linear.py`

 * *Files 26% similar despite different names*

```diff
@@ -24,34 +24,41 @@
     _as_numpy,
     _convert_to_dataframe,
     get_dataframes_and_queues,
 )
 
 
 @pytest.mark.parametrize("dataframe,queue", get_dataframes_and_queues())
+@pytest.mark.parametrize("dtype", [np.float32, np.float64])
 @pytest.mark.parametrize("macro_block", [None, 1024])
-def test_sklearnex_import_linear(dataframe, queue, macro_block):
+def test_sklearnex_import_linear(dataframe, queue, dtype, macro_block):
     from sklearnex.linear_model import LinearRegression
 
     X = np.array([[1, 1], [1, 2], [2, 2], [2, 3]])
     y = np.dot(X, np.array([1, 2])) + 3
+    X = X.astype(dtype=dtype)
+    y = y.astype(dtype=dtype)
     X = _convert_to_dataframe(X, sycl_queue=queue, target_df=dataframe)
     y = _convert_to_dataframe(y, sycl_queue=queue, target_df=dataframe)
+
     linreg = LinearRegression()
     if daal_check_version((2024, "P", 0)) and macro_block is not None:
         hparams = linreg.get_hyperparameters("fit")
         hparams.cpu_macro_block = macro_block
         hparams.gpu_macro_block = macro_block
+
     linreg.fit(X, y)
-    if daal_check_version((2023, "P", 100)):
-        assert hasattr(linreg, "_onedal_estimator")
+
+    assert hasattr(linreg, "_onedal_estimator")
     assert "sklearnex" in linreg.__module__
     assert linreg.n_features_in_ == 2
-    assert_allclose(_as_numpy(linreg.intercept_), 3.0)
-    assert_allclose(_as_numpy(linreg.coef_), [1.0, 2.0])
+
+    tol = 1e-5 if X.dtype == np.float32 else 1e-7
+    assert_allclose(_as_numpy(linreg.intercept_), 3.0, rtol=tol)
+    assert_allclose(_as_numpy(linreg.coef_), [1.0, 2.0], rtol=tol)
 
 
 def test_sklearnex_import_ridge():
     from sklearnex.linear_model import Ridge
 
     X = np.array([[1, 1], [1, 2], [2, 2], [2, 3]])
     y = np.dot(X, np.array([1, 2])) + 3
@@ -76,7 +83,35 @@
     from sklearnex.linear_model import ElasticNet
 
     X, y = make_regression(n_features=2, random_state=0)
     elasticnet = ElasticNet(random_state=0).fit(X, y)
     assert "daal4py" in elasticnet.__module__
     assert_allclose(elasticnet.intercept_, 1.451, atol=1e-3)
     assert_allclose(elasticnet.coef_, [18.838, 64.559], atol=1e-3)
+
+
+@pytest.mark.parametrize("dataframe,queue", get_dataframes_and_queues())
+@pytest.mark.parametrize("dtype", [np.float32, np.float64])
+def test_sklearnex_reconstruct_model(dataframe, queue, dtype):
+    from sklearnex.linear_model import LinearRegression
+
+    seed = 42
+    num_samples = 3500
+    num_features, num_targets = 14, 9
+
+    gen = np.random.default_rng(seed)
+    intercept = gen.random(size=num_targets, dtype=dtype)
+    coef = gen.random(size=(num_targets, num_features), dtype=dtype).T
+
+    X = gen.random(size=(num_samples, num_features), dtype=dtype)
+    gtr = X @ coef + intercept[np.newaxis, :]
+
+    X = _convert_to_dataframe(X, sycl_queue=queue, target_df=dataframe)
+
+    linreg = LinearRegression(fit_intercept=True)
+    linreg.coef_ = coef.T
+    linreg.intercept_ = intercept
+
+    y_pred = linreg.predict(X)
+
+    tol = 1e-5 if X.dtype == np.float32 else 1e-7
+    assert_allclose(gtr, _as_numpy(y_pred), rtol=tol)
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_logreg.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/linear_model/tests/test_logreg.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/t_sne.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/t_sne.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/manifold/tests/test_tsne.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/manifold/tests/test_tsne.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/pairwise.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/pairwise.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/ranking.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/ranking.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/metrics/tests/test_metrics.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/metrics/tests/test_metrics.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/split.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/split.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/model_selection/tests/test_model_selection.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/model_selection/tests/test_model_selection.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/_lof.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/_lof.py`

 * *Files 8% similar despite different names*

```diff
@@ -19,21 +19,21 @@
 import numpy as np
 from sklearn.neighbors import LocalOutlierFactor as sklearn_LocalOutlierFactor
 from sklearn.utils.metaestimators import available_if
 from sklearn.utils.validation import check_is_fitted
 
 from daal4py.sklearn._n_jobs_support import control_n_jobs
 from daal4py.sklearn._utils import sklearn_check_version
+from sklearnex._device_offload import dispatch, wrap_output_data
+from sklearnex.neighbors.common import KNeighborsDispatchingBase
+from sklearnex.neighbors.knn_unsupervised import NearestNeighbors
+from sklearnex.utils import get_namespace
 
-from .._device_offload import dispatch, wrap_output_data
-from .common import KNeighborsDispatchingBase
-from .knn_unsupervised import NearestNeighbors
 
-
-@control_n_jobs(decorated_methods=["fit", "kneighbors"])
+@control_n_jobs(decorated_methods=["fit", "_kneighbors"])
 class LocalOutlierFactor(KNeighborsDispatchingBase, sklearn_LocalOutlierFactor):
     __doc__ = (
         sklearn_LocalOutlierFactor.__doc__
         + "\n NOTE: When X=None, methods kneighbors, kneighbors_graph, and predict will"
         + "\n only output numpy arrays. In that case, the only way to offload to gpu"
         + "\n is to use a global queue (e.g. using config_context)"
     )
@@ -96,37 +96,33 @@
             self.offset_ = np.percentile(
                 self.negative_outlier_factor_, 100.0 * self.contamination
             )
 
         return self
 
     def fit(self, X, y=None):
-        self._fit_validation(X, y)
         result = dispatch(
             self,
             "fit",
             {
                 "onedal": self.__class__._onedal_fit,
                 "sklearn": sklearn_LocalOutlierFactor.fit,
             },
             X,
             None,
         )
         return result
 
-    # Subtle order change to remove check_array and preserve dpnp and
-    # dpctl conformance. decision_function will return a dpnp or dpctl
-    # instance via kneighbors and an equivalent check_array exists in
-    # that call already in sklearn so no loss of functionality occurs
     def _predict(self, X=None):
         check_is_fitted(self)
 
         if X is not None:
+            xp, _ = get_namespace(X)
             output = self.decision_function(X) < 0
-            is_inlier = np.ones(output.shape[0], dtype=int)
+            is_inlier = xp.ones_like(output, dtype=int)
             is_inlier[output] = -1
         else:
             is_inlier = np.ones(self.n_samples_fit_, dtype=int)
             is_inlier[self.negative_outlier_factor_ < self.offset_] = -1
 
         return is_inlier
 
@@ -155,50 +151,71 @@
         Returns
         -------
         is_inlier : ndarray of shape (n_samples,)
             Returns -1 for anomalies/outliers and 1 for inliers.
         """
         return self.fit(X)._predict()
 
-    @available_if(sklearn_LocalOutlierFactor._check_novelty_predict)
+    def _kneighbors(self, X=None, n_neighbors=None, return_distance=True):
+        check_is_fitted(self)
+        if sklearn_check_version("1.0") and X is not None:
+            self._check_feature_names(X, reset=False)
+        return dispatch(
+            self,
+            "kneighbors",
+            {
+                "onedal": self.__class__._onedal_kneighbors,
+                "sklearn": sklearn_LocalOutlierFactor.kneighbors,
+            },
+            X,
+            n_neighbors=n_neighbors,
+            return_distance=return_distance,
+        )
+
+    kneighbors = wrap_output_data(_kneighbors)
+
+    @available_if(sklearn_LocalOutlierFactor._check_novelty_score_samples)
     @wrap_output_data
-    def predict(self, X=None):
-        """Predict the labels (1 inlier, -1 outlier) of X according to LOF.
+    def score_samples(self, X):
+        """Opposite of the Local Outlier Factor of X.
+
+        It is the opposite as bigger is better, i.e. large values correspond
+        to inliers.
 
         **Only available for novelty detection (when novelty is set to True).**
-        This method allows to generalize prediction to *new observations* (not
-        in the training set). Note that the result of ``clf.fit(X)`` then
-        ``clf.predict(X)`` with ``novelty=True`` may differ from the result
-        obtained by ``clf.fit_predict(X)`` with ``novelty=False``.
+        The argument X is supposed to contain *new data*: if X contains a
+        point from training, it considers the later in its own neighborhood.
+        Also, the samples in X are not considered in the neighborhood of any
+        point. Because of this, the scores obtained via ``score_samples`` may
+        differ from the standard LOF scores.
+        The standard LOF scores for the training data is available via the
+        ``negative_outlier_factor_`` attribute.
 
         Parameters
         ----------
         X : {array-like, sparse matrix} of shape (n_samples, n_features)
             The query sample or samples to compute the Local Outlier Factor
             w.r.t. the training samples.
 
         Returns
         -------
-        is_inlier : ndarray of shape (n_samples,)
-            Returns -1 for anomalies/outliers and +1 for inliers.
+        opposite_lof_scores : ndarray of shape (n_samples,)
+            The opposite of the Local Outlier Factor of each input samples.
+            The lower, the more abnormal.
         """
-        return self._predict(X)
-
-    @wrap_output_data
-    def kneighbors(self, X=None, n_neighbors=None, return_distance=True):
         check_is_fitted(self)
-        if sklearn_check_version("1.0") and X is not None:
-            self._check_feature_names(X, reset=False)
-        return dispatch(
-            self,
-            "kneighbors",
-            {
-                "onedal": self.__class__._onedal_kneighbors,
-                "sklearn": sklearn_LocalOutlierFactor.kneighbors,
-            },
-            X,
-            n_neighbors=n_neighbors,
-            return_distance=return_distance,
+
+        distances_X, neighbors_indices_X = self._kneighbors(
+            X, n_neighbors=self.n_neighbors_
         )
 
+        X_lrd = self._local_reachability_density(
+            distances_X,
+            neighbors_indices_X,
+        )
+
+        lrd_ratios_array = self._lrd[neighbors_indices_X] / X_lrd[:, np.newaxis]
+
+        return -np.mean(lrd_ratios_array, axis=1)
+
     fit.__doc__ = sklearn_LocalOutlierFactor.fit.__doc__
     kneighbors.__doc__ = sklearn_LocalOutlierFactor.kneighbors.__doc__
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/common.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/common.py`

 * *Files 1% similar despite different names*

```diff
@@ -133,14 +133,17 @@
             self._fit_X = X.data
             self._tree = X
             self._fit_method = "kd_tree"
             self.n_samples_fit_ = X.data.shape[0]
             self.n_features_in_ = X.data.shape[1]
 
     def _onedal_supported(self, device, method_name, *data):
+        if method_name == "fit":
+            self._fit_validation(data[0], data[1])
+
         class_name = self.__class__.__name__
         is_classifier = "Classifier" in class_name
         is_regressor = "Regressor" in class_name
         is_unsupervised = not (is_classifier or is_regressor)
         patching_status = PatchingConditionsChain(
             f"sklearn.neighbors.{class_name}.{method_name}"
         )
@@ -245,15 +248,15 @@
                 return patching_status
         if method_name == "fit":
             if is_classifier:
                 patching_status.and_condition(
                     class_count >= 2, "One-class case is not supported."
                 )
             return patching_status
-        if method_name in ["predict", "predict_proba", "kneighbors"]:
+        if method_name in ["predict", "predict_proba", "kneighbors", "score"]:
             patching_status.and_condition(
                 hasattr(self, "_onedal_estimator"), "oneDAL model was not trained."
             )
             return patching_status
         raise RuntimeError(f"Unknown method {method_name} in {class_name}")
 
     def _onedal_gpu_supported(self, method_name, *data):
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_classification.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_classification.py`

 * *Files 20% similar despite different names*

```diff
@@ -10,137 +10,38 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ===============================================================================
 
-from daal4py.sklearn._n_jobs_support import control_n_jobs
-from daal4py.sklearn._utils import sklearn_check_version
-
-if not sklearn_check_version("1.2"):
-    from sklearn.neighbors._base import _check_weights
-
+from sklearn.metrics import accuracy_score
 from sklearn.neighbors._classification import (
     KNeighborsClassifier as sklearn_KNeighborsClassifier,
 )
 from sklearn.neighbors._unsupervised import NearestNeighbors as sklearn_NearestNeighbors
 from sklearn.utils.validation import _deprecate_positional_args, check_is_fitted
 
+from daal4py.sklearn._n_jobs_support import control_n_jobs
+from daal4py.sklearn._utils import sklearn_check_version
 from onedal.neighbors import KNeighborsClassifier as onedal_KNeighborsClassifier
 
 from .._device_offload import dispatch, wrap_output_data
 from .common import KNeighborsDispatchingBase
 
-if sklearn_check_version("0.24"):
-
-    class KNeighborsClassifier_(sklearn_KNeighborsClassifier):
-        if sklearn_check_version("1.2"):
-            _parameter_constraints: dict = {
-                **sklearn_KNeighborsClassifier._parameter_constraints
-            }
 
-        @_deprecate_positional_args
-        def __init__(
-            self,
-            n_neighbors=5,
-            *,
-            weights="uniform",
-            algorithm="auto",
-            leaf_size=30,
-            p=2,
-            metric="minkowski",
-            metric_params=None,
-            n_jobs=None,
-            **kwargs,
-        ):
-            super().__init__(
-                n_neighbors=n_neighbors,
-                algorithm=algorithm,
-                leaf_size=leaf_size,
-                metric=metric,
-                p=p,
-                metric_params=metric_params,
-                n_jobs=n_jobs,
-                **kwargs,
-            )
-            self.weights = (
-                weights if sklearn_check_version("1.0") else _check_weights(weights)
-            )
-
-elif sklearn_check_version("0.22"):
-    from sklearn.neighbors._base import (
-        SupervisedIntegerMixin as BaseSupervisedIntegerMixin,
-    )
-
-    class KNeighborsClassifier_(sklearn_KNeighborsClassifier, BaseSupervisedIntegerMixin):
-        @_deprecate_positional_args
-        def __init__(
-            self,
-            n_neighbors=5,
-            *,
-            weights="uniform",
-            algorithm="auto",
-            leaf_size=30,
-            p=2,
-            metric="minkowski",
-            metric_params=None,
-            n_jobs=None,
-            **kwargs,
-        ):
-            super().__init__(
-                n_neighbors=n_neighbors,
-                algorithm=algorithm,
-                leaf_size=leaf_size,
-                metric=metric,
-                p=p,
-                metric_params=metric_params,
-                n_jobs=n_jobs,
-                **kwargs,
-            )
-            self.weights = _check_weights(weights)
-
-else:
-    from sklearn.neighbors.base import (
-        SupervisedIntegerMixin as BaseSupervisedIntegerMixin,
-    )
-
-    class KNeighborsClassifier_(sklearn_KNeighborsClassifier, BaseSupervisedIntegerMixin):
-        @_deprecate_positional_args
-        def __init__(
-            self,
-            n_neighbors=5,
-            *,
-            weights="uniform",
-            algorithm="auto",
-            leaf_size=30,
-            p=2,
-            metric="minkowski",
-            metric_params=None,
-            n_jobs=None,
-            **kwargs,
-        ):
-            super().__init__(
-                n_neighbors=n_neighbors,
-                algorithm=algorithm,
-                leaf_size=leaf_size,
-                metric=metric,
-                p=p,
-                metric_params=metric_params,
-                n_jobs=n_jobs,
-                **kwargs,
-            )
-            self.weights = _check_weights(weights)
-
-
-@control_n_jobs(decorated_methods=["fit", "predict", "predict_proba", "kneighbors"])
-class KNeighborsClassifier(KNeighborsClassifier_, KNeighborsDispatchingBase):
+@control_n_jobs(
+    decorated_methods=["fit", "predict", "predict_proba", "kneighbors", "score"]
+)
+class KNeighborsClassifier(sklearn_KNeighborsClassifier, KNeighborsDispatchingBase):
     __doc__ = sklearn_KNeighborsClassifier.__doc__
     if sklearn_check_version("1.2"):
-        _parameter_constraints: dict = {**KNeighborsClassifier_._parameter_constraints}
+        _parameter_constraints: dict = {
+            **sklearn_KNeighborsClassifier._parameter_constraints
+        }
 
     if sklearn_check_version("1.0"):
 
         def __init__(
             self,
             n_neighbors=5,
             *,
@@ -188,15 +89,14 @@
                 p=p,
                 metric_params=metric_params,
                 n_jobs=n_jobs,
                 **kwargs,
             )
 
     def fit(self, X, y):
-        self._fit_validation(X, y)
         dispatch(
             self,
             "fit",
             {
                 "onedal": self.__class__._onedal_fit,
                 "sklearn": sklearn_KNeighborsClassifier.fit,
             },
@@ -232,14 +132,31 @@
                 "onedal": self.__class__._onedal_predict_proba,
                 "sklearn": sklearn_KNeighborsClassifier.predict_proba,
             },
             X,
         )
 
     @wrap_output_data
+    def score(self, X, y, sample_weight=None):
+        check_is_fitted(self)
+        if sklearn_check_version("1.0"):
+            self._check_feature_names(X, reset=False)
+        return dispatch(
+            self,
+            "score",
+            {
+                "onedal": self.__class__._onedal_score,
+                "sklearn": sklearn_KNeighborsClassifier.score,
+            },
+            X,
+            y,
+            sample_weight=sample_weight,
+        )
+
+    @wrap_output_data
     def kneighbors(self, X=None, n_neighbors=None, return_distance=True):
         check_is_fitted(self)
         if sklearn_check_version("1.0") and X is not None:
             self._check_feature_names(X, reset=False)
         return dispatch(
             self,
             "kneighbors",
@@ -259,26 +176,18 @@
         _onedal_estimator = getattr(self, "_onedal_estimator", None)
 
         if (
             _onedal_estimator is not None
             or getattr(self, "_tree", 0) is None
             and self._fit_method == "kd_tree"
         ):
-            if sklearn_check_version("0.24"):
-                sklearn_NearestNeighbors.fit(self, self._fit_X, getattr(self, "_y", None))
-            else:
-                sklearn_NearestNeighbors.fit(self, self._fit_X)
-        if sklearn_check_version("0.22"):
-            result = sklearn_NearestNeighbors.radius_neighbors(
-                self, X, radius, return_distance, sort_results
-            )
-        else:
-            result = sklearn_NearestNeighbors.radius_neighbors(
-                self, X, radius, return_distance
-            )
+            sklearn_NearestNeighbors.fit(self, self._fit_X, getattr(self, "_y", None))
+        result = sklearn_NearestNeighbors.radius_neighbors(
+            self, X, radius, return_distance, sort_results
+        )
 
         return result
 
     def _onedal_fit(self, X, y, queue=None):
         onedal_params = {
             "n_neighbors": self.n_neighbors,
             "weights": self.weights,
@@ -309,22 +218,28 @@
     def _onedal_kneighbors(
         self, X=None, n_neighbors=None, return_distance=True, queue=None
     ):
         return self._onedal_estimator.kneighbors(
             X, n_neighbors, return_distance, queue=queue
         )
 
+    def _onedal_score(self, X, y, sample_weight=None, queue=None):
+        return accuracy_score(
+            y, self._onedal_predict(X, queue=queue), sample_weight=sample_weight
+        )
+
     def _save_attributes(self):
         self.classes_ = self._onedal_estimator.classes_
         self.n_features_in_ = self._onedal_estimator.n_features_in_
         self.n_samples_fit_ = self._onedal_estimator.n_samples_fit_
         self._fit_X = self._onedal_estimator._fit_X
         self._y = self._onedal_estimator._y
         self._fit_method = self._onedal_estimator._fit_method
         self.outputs_2d_ = self._onedal_estimator.outputs_2d_
         self._tree = self._onedal_estimator._tree
 
     fit.__doc__ = sklearn_KNeighborsClassifier.fit.__doc__
     predict.__doc__ = sklearn_KNeighborsClassifier.predict.__doc__
     predict_proba.__doc__ = sklearn_KNeighborsClassifier.predict_proba.__doc__
+    score.__doc__ = sklearn_KNeighborsClassifier.score.__doc__
     kneighbors.__doc__ = sklearn_KNeighborsClassifier.kneighbors.__doc__
     radius_neighbors.__doc__ = sklearn_NearestNeighbors.radius_neighbors.__doc__
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_unsupervised.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/knn_unsupervised.py`

 * *Files 22% similar despite different names*

```diff
@@ -10,93 +10,30 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ===============================================================================
 
-try:
-    from packaging.version import Version
-except ImportError:
-    from distutils.version import LooseVersion as Version
-
-from sklearn import __version__ as sklearn_version
 from sklearn.neighbors._unsupervised import NearestNeighbors as sklearn_NearestNeighbors
 from sklearn.utils.validation import _deprecate_positional_args, check_is_fitted
 
 from daal4py.sklearn._n_jobs_support import control_n_jobs
 from daal4py.sklearn._utils import sklearn_check_version
 from onedal.neighbors import NearestNeighbors as onedal_NearestNeighbors
 
 from .._device_offload import dispatch, wrap_output_data
 from .common import KNeighborsDispatchingBase
 
-if sklearn_check_version("0.22") and Version(sklearn_version) < Version("0.23"):
-
-    class NearestNeighbors_(sklearn_NearestNeighbors):
-        def __init__(
-            self,
-            n_neighbors=5,
-            radius=1.0,
-            algorithm="auto",
-            leaf_size=30,
-            metric="minkowski",
-            p=2,
-            metric_params=None,
-            n_jobs=None,
-        ):
-            super().__init__(
-                n_neighbors=n_neighbors,
-                radius=radius,
-                algorithm=algorithm,
-                leaf_size=leaf_size,
-                metric=metric,
-                p=p,
-                metric_params=metric_params,
-                n_jobs=n_jobs,
-            )
-
-else:
-
-    class NearestNeighbors_(sklearn_NearestNeighbors):
-        if sklearn_check_version("1.2"):
-            _parameter_constraints: dict = {
-                **sklearn_NearestNeighbors._parameter_constraints
-            }
-
-        @_deprecate_positional_args
-        def __init__(
-            self,
-            *,
-            n_neighbors=5,
-            radius=1.0,
-            algorithm="auto",
-            leaf_size=30,
-            metric="minkowski",
-            p=2,
-            metric_params=None,
-            n_jobs=None,
-        ):
-            super().__init__(
-                n_neighbors=n_neighbors,
-                radius=radius,
-                algorithm=algorithm,
-                leaf_size=leaf_size,
-                metric=metric,
-                p=p,
-                metric_params=metric_params,
-                n_jobs=n_jobs,
-            )
-
 
 @control_n_jobs(decorated_methods=["fit", "kneighbors"])
-class NearestNeighbors(NearestNeighbors_, KNeighborsDispatchingBase):
+class NearestNeighbors(sklearn_NearestNeighbors, KNeighborsDispatchingBase):
     __doc__ = sklearn_NearestNeighbors.__doc__
     if sklearn_check_version("1.2"):
-        _parameter_constraints: dict = {**NearestNeighbors_._parameter_constraints}
+        _parameter_constraints: dict = {**sklearn_NearestNeighbors._parameter_constraints}
 
     @_deprecate_positional_args
     def __init__(
         self,
         n_neighbors=5,
         radius=1.0,
         algorithm="auto",
@@ -114,15 +51,14 @@
             metric=metric,
             p=p,
             metric_params=metric_params,
             n_jobs=n_jobs,
         )
 
     def fit(self, X, y=None):
-        self._fit_validation(X, y)
         dispatch(
             self,
             "fit",
             {
                 "onedal": self.__class__._onedal_fit,
                 "sklearn": sklearn_NearestNeighbors.fit,
             },
@@ -155,26 +91,18 @@
         _onedal_estimator = getattr(self, "_onedal_estimator", None)
 
         if (
             _onedal_estimator is not None
             or getattr(self, "_tree", 0) is None
             and self._fit_method == "kd_tree"
         ):
-            if sklearn_check_version("0.24"):
-                sklearn_NearestNeighbors.fit(self, self._fit_X, getattr(self, "_y", None))
-            else:
-                sklearn_NearestNeighbors.fit(self, self._fit_X)
-        if sklearn_check_version("0.22"):
-            result = sklearn_NearestNeighbors.radius_neighbors(
-                self, X, radius, return_distance, sort_results
-            )
-        else:
-            result = sklearn_NearestNeighbors.radius_neighbors(
-                self, X, radius, return_distance
-            )
+            sklearn_NearestNeighbors.fit(self, self._fit_X, getattr(self, "_y", None))
+        result = sklearn_NearestNeighbors.radius_neighbors(
+            self, X, radius, return_distance, sort_results
+        )
 
         return result
 
     def _onedal_fit(self, X, y=None, queue=None):
         onedal_params = {
             "n_neighbors": self.n_neighbors,
             "algorithm": self.algorithm,
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/neighbors/tests/test_neighbors.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/neighbors/tests/test_neighbors.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/_common.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/_common.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/cluster/k_means.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/cluster/k_means.py`

 * *Files 27% similar despite different names*

```diff
@@ -168,32 +168,14 @@
                     (not issparse(X), "Sparse input is not supported."),
                 ]
             )
 
             return patching_status
 
         def fit(self, X, y=None, sample_weight=None):
-            """Compute k-means clustering.
-
-            Parameters
-            ----------
-            X : array-like or sparse matrix, shape=(n_samples, n_features)
-                Training instances to cluster. It must be noted that the data
-                will be converted to C ordering, which will cause a memory
-                copy if the given data is not C-contiguous.
-
-            y : Ignored
-                not used, present here for API consistency by convention.
-
-            sample_weight : array-like, shape (n_samples,), optional
-                The weights for each observation in X. If None, all observations
-                are assigned equal weight (default: None)
-
-            """
-
             if sklearn_check_version("1.0"):
                 self._check_feature_names(X, reset=True)
             if sklearn_check_version("1.2"):
                 self._validate_params()
 
             dispatch(
                 self,
@@ -253,32 +235,14 @@
                 ]
             )
 
             return patching_status
 
         @wrap_output_data
         def predict(self, X):
-            """Compute k-means clustering.
-
-            Parameters
-            ----------
-            X : array-like or sparse matrix, shape=(n_samples, n_features)
-                Training instances to cluster. It must be noted that the data
-                will be converted to C ordering, which will cause a memory
-                copy if the given data is not C-contiguous.
-
-            y : Ignored
-                not used, present here for API consistency by convention.
-
-            sample_weight : array-like, shape (n_samples,), optional
-                The weights for each observation in X. If None, all observations
-                are assigned equal weight (default: None)
-
-            """
-
             if sklearn_check_version("1.0"):
                 self._check_feature_names(X, reset=True)
             if sklearn_check_version("1.2"):
                 self._validate_params()
 
             return dispatch(
                 self,
@@ -313,59 +277,27 @@
             return self._onedal_supported(method_name, *data)
 
         def _onedal_cpu_supported(self, method_name, *data):
             return self._onedal_supported(method_name, *data)
 
         @wrap_output_data
         def fit_transform(self, X, y=None, sample_weight=None):
-            """Compute clustering and transform X to cluster-distance space.
-
-            Equivalent to fit(X).transform(X), but more efficiently implemented.
-
-            Parameters
-            ----------
-            X : {array-like, sparse matrix} of shape (n_samples, n_features)
-                New data to transform.
-
-            y : Ignored
-                Not used, present here for API consistency by convention.
-
-            sample_weight : array-like of shape (n_samples,), default=None
-                The weights for each observation in X. If None, all observations
-                are assigned equal weight.
-
-            Returns
-            -------
-            X_new : ndarray of shape (n_samples, n_clusters)
-                X transformed in the new space.
-            """
             return self.fit(X, sample_weight=sample_weight)._transform(X)
 
         @wrap_output_data
         def transform(self, X):
-            """Transform X to a cluster-distance space.
-
-            In the new space, each dimension is the distance to the cluster
-            centers. Note that even if X is sparse, the array returned by
-            `transform` will typically be dense.
-
-            Parameters
-            ----------
-            X : {array-like, sparse matrix} of shape (n_samples, n_features)
-                New data to transform.
-
-            Returns
-            -------
-            X_new : ndarray of shape (n_samples, n_clusters)
-                X transformed in the new space.
-            """
             check_is_fitted(self)
 
             X = self._check_test_data(X)
             return self._transform(X)
 
+        fit.__doc__ = sklearn_KMeans.fit.__doc__
+        predict.__doc__ = sklearn_KMeans.predict.__doc__
+        transform.__doc__ = sklearn_KMeans.transform.__doc__
+        fit_transform.__doc__ = sklearn_KMeans.fit_transform.__doc__
+
 else:
     from daal4py.sklearn.cluster import KMeans
 
     logging.warning(
         "Preview KMeans requires oneDAL version >= 2023.2 " "but it was not found"
     )
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/covariance.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/covariance.py`

 * *Files 12% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 
 import numpy as np
 from scipy import sparse as sp
 from sklearn.covariance import EmpiricalCovariance as sklearn_EmpiricalCovariance
 from sklearn.utils import check_array
 
 from daal4py.sklearn._n_jobs_support import control_n_jobs
-from daal4py.sklearn._utils import sklearn_check_version
+from daal4py.sklearn._utils import daal_check_version, sklearn_check_version
 from onedal.common.hyperparameters import get_hyperparameters
 from onedal.covariance import EmpiricalCovariance as onedal_EmpiricalCovariance
 from sklearnex import config_context
 from sklearnex.metrics import pairwise_distances
 
 from ..._device_offload import dispatch, wrap_output_data
 from ..._utils import PatchingConditionsChain, register_hyperparameters
@@ -40,28 +40,33 @@
     if sklearn_check_version("1.2"):
         _parameter_constraints: dict = {
             **sklearn_EmpiricalCovariance._parameter_constraints,
         }
 
     def _save_attributes(self):
         assert hasattr(self, "_onedal_estimator")
+        if not daal_check_version((2024, "P", 400)) and self.assume_centered:
+            location = self._onedal_estimator.location_[None, :]
+            self._onedal_estimator.covariance_ += np.dot(location.T, location)
+            self._onedal_estimator.location_ = np.zeros_like(np.squeeze(location))
         self._set_covariance(self._onedal_estimator.covariance_)
         self.location_ = self._onedal_estimator.location_
 
     _onedal_covariance = staticmethod(onedal_EmpiricalCovariance)
 
     def _onedal_fit(self, X, queue=None):
         if X.shape[0] == 1:
             warnings.warn(
                 "Only one sample available. You may want to reshape your data array"
             )
 
         onedal_params = {
             "method": "dense",
             "bias": True,
+            "assume_centered": self.assume_centered,
         }
 
         self._onedal_estimator = self._onedal_covariance(**onedal_params)
         self._onedal_estimator.fit(X, queue=queue)
         self._save_attributes()
 
     def _onedal_supported(self, method_name, *data):
@@ -69,18 +74,14 @@
         patching_status = PatchingConditionsChain(
             f"sklearn.covariance.{class_name}.{method_name}"
         )
         if method_name in ["fit", "mahalanobis"]:
             (X,) = data
             patching_status.and_conditions(
                 [
-                    (
-                        self.assume_centered == False,
-                        "assume_centered parameter is not supported on oneDAL side",
-                    ),
                     (not sp.issparse(X), "X is sparse. Sparse input is not supported."),
                 ]
             )
             return patching_status
         raise RuntimeError(f"Unknown method {method_name} in {self.__class__.__name__}")
 
     _onedal_cpu_supported = _onedal_supported
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/preview/covariance/tests/test_covariance.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/preview/covariance/tests/test_covariance.py`

 * *Files 20% similar despite different names*

```diff
@@ -23,31 +23,44 @@
     _convert_to_dataframe,
     get_dataframes_and_queues,
 )
 
 
 @pytest.mark.parametrize("dataframe,queue", get_dataframes_and_queues())
 @pytest.mark.parametrize("macro_block", [None, 1024])
-def test_sklearnex_import_covariance(dataframe, queue, macro_block):
+@pytest.mark.parametrize("assume_centered", [True, False])
+def test_sklearnex_import_covariance(dataframe, queue, macro_block, assume_centered):
     from sklearnex.preview.covariance import EmpiricalCovariance
 
     X = np.array([[0, 1], [0, 1]])
+
     X = _convert_to_dataframe(X, sycl_queue=queue, target_df=dataframe)
-    empcov = EmpiricalCovariance()
+    empcov = EmpiricalCovariance(assume_centered=assume_centered)
     if daal_check_version((2024, "P", 0)) and macro_block is not None:
         hparams = empcov.get_hyperparameters("fit")
         hparams.cpu_macro_block = macro_block
     result = empcov.fit(X)
+
     expected_covariance = np.array([[0, 0], [0, 0]])
-    expected_means = np.array([0, 1])
+    expected_means = np.array([0, 0])
+
+    if assume_centered:
+        expected_covariance = np.array([[0, 0], [0, 1]])
+    else:
+        expected_means = np.array([0, 1])
 
     assert_allclose(expected_covariance, result.covariance_)
     assert_allclose(expected_means, result.location_)
 
     X = np.array([[1, 2], [3, 6]])
+
     X = _convert_to_dataframe(X, sycl_queue=queue, target_df=dataframe)
     result = empcov.fit(X)
-    expected_covariance = np.array([[1, 2], [2, 4]])
-    expected_means = np.array([2, 4])
+
+    if assume_centered:
+        expected_covariance = np.array([[5, 10], [10, 20]])
+    else:
+        expected_covariance = np.array([[1, 2], [2, 4]])
+        expected_means = np.array([2, 4])
 
     assert_allclose(expected_covariance, result.covariance_)
     assert_allclose(expected_means, result.location_)
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/basic_statistics.py`

 * *Files 10% similar despite different names*

```diff
@@ -10,10 +10,12 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
-from .basic_statistics import BasicStatistics
+from onedal.spmd.basic_statistics import BasicStatistics
 
-__all__ = ["BasicStatistics"]
+# TODO:
+# Currently it uses `onedal` module interface.
+# Add sklearnex dispatching.
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/basic_statistics/basic_statistics.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/pca.py`

 * *Files 6% similar despite different names*

```diff
@@ -10,12 +10,12 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
-from onedal.spmd.basic_statistics import BasicStatistics
+from onedal.spmd.decomposition import PCA
 
 # TODO:
 # Currently it uses `onedal` module interface.
 # Add sklearnex dispatching.
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/dbscan.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/dbscan.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/kmeans.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/cluster/kmeans.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/covariance.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/covariance/covariance.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/decomposition/pca.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/logistic_regression.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,21 +1,21 @@
 # ==============================================================================
-# Copyright 2023 Intel Corporation
+# Copyright 2024 Intel Corporation
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
-from onedal.spmd.decomposition import PCA
+from onedal.spmd.linear_model import LogisticRegression
 
 # TODO:
 # Currently it uses `onedal` module interface.
 # Add sklearnex dispatching.
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/forest.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/ensemble/forest.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/linear_model.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/linear_model.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/linear_model/logistic_regression.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/neighbors.py`

 * *Files 25% similar despite different names*

```diff
@@ -1,21 +1,25 @@
 # ==============================================================================
-# Copyright 2024 Intel Corporation
+# Copyright 2023 Intel Corporation
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
-from onedal.spmd.linear_model import LogisticRegression
+from onedal.spmd.neighbors import (
+    KNeighborsClassifier,
+    KNeighborsRegressor,
+    NearestNeighbors,
+)
 
 # TODO:
 # Currently it uses `onedal` module interface.
 # Add sklearnex dispatching.
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/__init__.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/spmd/neighbors/neighbors.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/__init__.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,25 +1,29 @@
 # ==============================================================================
-# Copyright 2023 Intel Corporation
+# Copyright 2021 Intel Corporation
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
-from onedal.spmd.neighbors import (
-    KNeighborsClassifier,
-    KNeighborsRegressor,
-    NearestNeighbors,
-)
+from .._utils import get_sklearnex_version
 
-# TODO:
-# Currently it uses `onedal` module interface.
-# Add sklearnex dispatching.
+if get_sklearnex_version((2021, "P", 300)):
+    from .nusvc import NuSVC
+    from .nusvr import NuSVR
+    from .svc import SVC
+    from .svr import SVR
+
+    __all__ = ["SVR", "SVC", "NuSVC", "NuSVR"]
+else:
+    from daal4py.sklearn.svm import SVC
+
+    __all__ = ["SVC"]
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/_common.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/_common.py`

 * *Files 4% similar despite different names*

```diff
@@ -72,15 +72,15 @@
                     )
                 ]
             )
             return patching_status
         inference_methods = (
             ["predict"]
             if class_name.endswith("R")
-            else ["predict", "predict_proba", "decision_function"]
+            else ["predict", "predict_proba", "decision_function", "score"]
         )
         if method_name in inference_methods:
             patching_status.and_conditions(
                 [(hasattr(self, "_onedal_estimator"), "oneDAL model was not trained.")]
             )
             return patching_status
         raise RuntimeError(f"Unknown method {method_name} in {class_name}")
@@ -107,20 +107,17 @@
 
         try:
             n_splits = 5
             n_jobs = n_splits if queue is None or queue.sycl_device.is_cpu else 1
             cv = StratifiedKFold(
                 n_splits=n_splits, shuffle=True, random_state=self.random_state
             )
-            if sklearn_check_version("0.24"):
-                self.clf_prob = CalibratedClassifierCV(
-                    clf_base, ensemble=False, cv=cv, method="sigmoid", n_jobs=n_jobs
-                )
-            else:
-                self.clf_prob = CalibratedClassifierCV(clf_base, cv=cv, method="sigmoid")
+            self.clf_prob = CalibratedClassifierCV(
+                clf_base, ensemble=False, cv=cv, method="sigmoid", n_jobs=n_jobs
+            )
             self.clf_prob.fit(X, y, sample_weight)
         except ValueError:
             clf_base = clf_base.fit(X, y, sample_weight)
             self.clf_prob = CalibratedClassifierCV(
                 clf_base, cv="prefit", method="sigmoid"
             )
             self.clf_prob.fit(X, y, sample_weight)
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/nusvc.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/nusvc.py`

 * *Files 13% similar despite different names*

```diff
@@ -10,32 +10,35 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
+import numpy as np
 from sklearn.exceptions import NotFittedError
+from sklearn.metrics import accuracy_score
 from sklearn.svm import NuSVC as sklearn_NuSVC
 from sklearn.utils.validation import _deprecate_positional_args
 
 from daal4py.sklearn._n_jobs_support import control_n_jobs
 from daal4py.sklearn._utils import sklearn_check_version
+from sklearnex.utils import get_namespace
 
 from .._device_offload import dispatch, wrap_output_data
 from ._common import BaseSVC
 
 if sklearn_check_version("1.0"):
     from sklearn.utils.metaestimators import available_if
 
 from onedal.svm import NuSVC as onedal_NuSVC
 
 
 @control_n_jobs(
-    decorated_methods=["fit", "predict", "_predict_proba", "decision_function"]
+    decorated_methods=["fit", "predict", "_predict_proba", "decision_function", "score"]
 )
 class NuSVC(sklearn_NuSVC, BaseSVC):
     __doc__ = sklearn_NuSVC.__doc__
 
     if sklearn_check_version("1.2"):
         _parameter_constraints: dict = {**sklearn_NuSVC._parameter_constraints}
 
@@ -74,47 +77,14 @@
             max_iter=max_iter,
             decision_function_shape=decision_function_shape,
             break_ties=break_ties,
             random_state=random_state,
         )
 
     def fit(self, X, y, sample_weight=None):
-        """
-        Fit the SVM model according to the given training data.
-
-        Parameters
-        ----------
-        X : {array-like, sparse matrix} of shape (n_samples, n_features) \
-                or (n_samples, n_samples)
-            Training vectors, where `n_samples` is the number of samples
-            and `n_features` is the number of features.
-            For kernel="precomputed", the expected shape of X is
-            (n_samples, n_samples).
-
-        y : array-like of shape (n_samples,)
-            Target values (class labels in classification, real numbers in
-            regression).
-
-        sample_weight : array-like of shape (n_samples,), default=None
-            Per-sample weights. Rescale C per sample. Higher weights
-            force the classifier to put more emphasis on these points.
-
-        Returns
-        -------
-        self : object
-            Fitted estimator.
-
-        Notes
-        -----
-        If X and y are not C-ordered and contiguous arrays of np.float64 and
-        X is not a scipy.sparse.csr_matrix, X and/or y may be copied.
-
-        If X is a dense array, then the other methods will not support sparse
-        matrices as input.
-        """
         if sklearn_check_version("1.2"):
             self._validate_params()
         if sklearn_check_version("1.0"):
             self._check_feature_names(X, reset=True)
         dispatch(
             self,
             "fit",
@@ -127,42 +97,42 @@
             sample_weight,
         )
 
         return self
 
     @wrap_output_data
     def predict(self, X):
-        """
-        Perform regression on samples in X.
-
-        For an one-class model, +1 (inlier) or -1 (outlier) is returned.
-
-        Parameters
-        ----------
-        X : {array-like, sparse matrix} of shape (n_samples, n_features)
-            For kernel="precomputed", the expected shape of X is
-            (n_samples_test, n_samples_train).
-
-        Returns
-        -------
-        y_pred : ndarray of shape (n_samples,)
-            The predicted values.
-        """
         if sklearn_check_version("1.0"):
             self._check_feature_names(X, reset=False)
         return dispatch(
             self,
             "predict",
             {
                 "onedal": self.__class__._onedal_predict,
                 "sklearn": sklearn_NuSVC.predict,
             },
             X,
         )
 
+    @wrap_output_data
+    def score(self, X, y, sample_weight=None):
+        if sklearn_check_version("1.0"):
+            self._check_feature_names(X, reset=False)
+        return dispatch(
+            self,
+            "score",
+            {
+                "onedal": self.__class__._onedal_score,
+                "sklearn": sklearn_NuSVC.score,
+            },
+            X,
+            y,
+            sample_weight=sample_weight,
+        )
+
     if sklearn_check_version("1.0"):
 
         @available_if(sklearn_NuSVC._check_proba)
         def predict_proba(self, X):
             """
             Compute probabilities of possible outcomes for samples in X.
 
@@ -187,21 +157,57 @@
             The probability model is created using cross validation, so
             the results can be slightly different than those obtained by
             predict. Also, it will produce meaningless results on very small
             datasets.
             """
             return self._predict_proba(X)
 
+        @available_if(sklearn_NuSVC._check_proba)
+        def predict_log_proba(self, X):
+            """Compute log probabilities of possible outcomes for samples in X.
+
+            The model need to have probability information computed at training
+            time: fit with attribute `probability` set to True.
+
+            Parameters
+            ----------
+            X : array-like of shape (n_samples, n_features) or \
+                    (n_samples_test, n_samples_train)
+                For kernel="precomputed", the expected shape of X is
+                (n_samples_test, n_samples_train).
+
+            Returns
+            -------
+            T : ndarray of shape (n_samples, n_classes)
+                Returns the log-probabilities of the sample for each class in
+                the model. The columns correspond to the classes in sorted
+                order, as they appear in the attribute :term:`classes_`.
+
+            Notes
+            -----
+            The probability model is created using cross validation, so
+            the results can be slightly different than those obtained by
+            predict. Also, it will produce meaningless results on very small
+            datasets.
+            """
+            xp, _ = get_namespace(X)
+
+            return xp.log(self.predict_proba(X))
+
     else:
 
         @property
         def predict_proba(self):
             self._check_proba()
             return self._predict_proba
 
+        def _predict_log_proba(self, X):
+            xp, _ = get_namespace(X)
+            return xp.log(self.predict_proba(X))
+
         predict_proba.__doc__ = sklearn_NuSVC.predict_proba.__doc__
 
     @wrap_output_data
     def _predict_proba(self, X):
         if sklearn_check_version("1.0"):
             self._check_feature_names(X, reset=False)
         sklearn_pred_proba = (
@@ -274,7 +280,17 @@
         cfg = get_config()
         cfg["target_offload"] = queue
         with config_context(**cfg):
             return self.clf_prob.predict_proba(X)
 
     def _onedal_decision_function(self, X, queue=None):
         return self._onedal_estimator.decision_function(X, queue=queue)
+
+    def _onedal_score(self, X, y, sample_weight=None, queue=None):
+        return accuracy_score(
+            y, self._onedal_predict(X, queue=queue), sample_weight=sample_weight
+        )
+
+    fit.__doc__ = sklearn_NuSVC.fit.__doc__
+    predict.__doc__ = sklearn_NuSVC.predict.__doc__
+    decision_function.__doc__ = sklearn_NuSVC.decision_function.__doc__
+    score.__doc__ = sklearn_NuSVC.score.__doc__
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/svc.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/svc.py`

 * *Files 8% similar despite different names*

```diff
@@ -13,32 +13,34 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
 import numpy as np
 from scipy import sparse as sp
 from sklearn.exceptions import NotFittedError
+from sklearn.metrics import accuracy_score
 from sklearn.svm import SVC as sklearn_SVC
 from sklearn.utils.validation import _deprecate_positional_args
 
 from daal4py.sklearn._n_jobs_support import control_n_jobs
 from daal4py.sklearn._utils import sklearn_check_version
+from sklearnex.utils import get_namespace
 
 from .._device_offload import dispatch, wrap_output_data
 from .._utils import PatchingConditionsChain
 from ._common import BaseSVC
 
 if sklearn_check_version("1.0"):
     from sklearn.utils.metaestimators import available_if
 
 from onedal.svm import SVC as onedal_SVC
 
 
 @control_n_jobs(
-    decorated_methods=["fit", "predict", "_predict_proba", "decision_function"]
+    decorated_methods=["fit", "predict", "_predict_proba", "decision_function", "score"]
 )
 class SVC(sklearn_SVC, BaseSVC):
     __doc__ = sklearn_SVC.__doc__
 
     if sklearn_check_version("1.2"):
         _parameter_constraints: dict = {**sklearn_SVC._parameter_constraints}
 
@@ -77,47 +79,14 @@
             max_iter=max_iter,
             decision_function_shape=decision_function_shape,
             break_ties=break_ties,
             random_state=random_state,
         )
 
     def fit(self, X, y, sample_weight=None):
-        """
-        Fit the SVM model according to the given training data.
-
-        Parameters
-        ----------
-        X : {array-like, sparse matrix} of shape (n_samples, n_features) \
-                or (n_samples, n_samples)
-            Training vectors, where `n_samples` is the number of samples
-            and `n_features` is the number of features.
-            For kernel="precomputed", the expected shape of X is
-            (n_samples, n_samples).
-
-        y : array-like of shape (n_samples,)
-            Target values (class labels in classification, real numbers in
-            regression).
-
-        sample_weight : array-like of shape (n_samples,), default=None
-            Per-sample weights. Rescale C per sample. Higher weights
-            force the classifier to put more emphasis on these points.
-
-        Returns
-        -------
-        self : object
-            Fitted estimator.
-
-        Notes
-        -----
-        If X and y are not C-ordered and contiguous arrays of np.float64 and
-        X is not a scipy.sparse.csr_matrix, X and/or y may be copied.
-
-        If X is a dense array, then the other methods will not support sparse
-        matrices as input.
-        """
         if sklearn_check_version("1.2"):
             self._validate_params()
         if sklearn_check_version("1.0"):
             self._check_feature_names(X, reset=True)
         dispatch(
             self,
             "fit",
@@ -129,42 +98,42 @@
             y,
             sample_weight,
         )
         return self
 
     @wrap_output_data
     def predict(self, X):
-        """
-        Perform regression on samples in X.
-
-        For an one-class model, +1 (inlier) or -1 (outlier) is returned.
-
-        Parameters
-        ----------
-        X : {array-like, sparse matrix} of shape (n_samples, n_features)
-            For kernel="precomputed", the expected shape of X is
-            (n_samples_test, n_samples_train).
-
-        Returns
-        -------
-        y_pred : ndarray of shape (n_samples,)
-            The predicted values.
-        """
         if sklearn_check_version("1.0"):
             self._check_feature_names(X, reset=False)
         return dispatch(
             self,
             "predict",
             {
                 "onedal": self.__class__._onedal_predict,
                 "sklearn": sklearn_SVC.predict,
             },
             X,
         )
 
+    @wrap_output_data
+    def score(self, X, y, sample_weight=None):
+        if sklearn_check_version("1.0"):
+            self._check_feature_names(X, reset=False)
+        return dispatch(
+            self,
+            "score",
+            {
+                "onedal": self.__class__._onedal_score,
+                "sklearn": sklearn_SVC.score,
+            },
+            X,
+            y,
+            sample_weight=sample_weight,
+        )
+
     if sklearn_check_version("1.0"):
 
         @available_if(sklearn_SVC._check_proba)
         def predict_proba(self, X):
             """
             Compute probabilities of possible outcomes for samples in X.
 
@@ -189,21 +158,57 @@
             The probability model is created using cross validation, so
             the results can be slightly different than those obtained by
             predict. Also, it will produce meaningless results on very small
             datasets.
             """
             return self._predict_proba(X)
 
+        @available_if(sklearn_SVC._check_proba)
+        def predict_log_proba(self, X):
+            """Compute log probabilities of possible outcomes for samples in X.
+
+            The model need to have probability information computed at training
+            time: fit with attribute `probability` set to True.
+
+            Parameters
+            ----------
+            X : array-like of shape (n_samples, n_features) or \
+                    (n_samples_test, n_samples_train)
+                For kernel="precomputed", the expected shape of X is
+                (n_samples_test, n_samples_train).
+
+            Returns
+            -------
+            T : ndarray of shape (n_samples, n_classes)
+                Returns the log-probabilities of the sample for each class in
+                the model. The columns correspond to the classes in sorted
+                order, as they appear in the attribute :term:`classes_`.
+
+            Notes
+            -----
+            The probability model is created using cross validation, so
+            the results can be slightly different than those obtained by
+            predict. Also, it will produce meaningless results on very small
+            datasets.
+            """
+            xp, _ = get_namespace(X)
+
+            return xp.log(self.predict_proba(X))
+
     else:
 
         @property
         def predict_proba(self):
             self._check_proba()
             return self._predict_proba
 
+        def _predict_log_proba(self, X):
+            xp, _ = get_namespace(X)
+            return xp.log(self.predict_proba(X))
+
         predict_proba.__doc__ = sklearn_SVC.predict_proba.__doc__
 
     @wrap_output_data
     def _predict_proba(self, X):
         sklearn_pred_proba = (
             sklearn_SVC.predict_proba
             if sklearn_check_version("1.0")
@@ -253,15 +258,15 @@
             (self.class_weight is None, "Class weight is not supported on GPU."),
             (not self._is_sparse, "Sparse input is not supported on GPU."),
             (self._class_count == 2, "Multiclassification is not supported on GPU."),
         ]
         if method_name == "fit":
             patching_status.and_conditions(conditions)
             return patching_status
-        if method_name in ["predict", "predict_proba", "decision_function"]:
+        if method_name in ["predict", "predict_proba", "decision_function", "score"]:
             conditions.append(
                 (hasattr(self, "_onedal_estimator"), "oneDAL model was not trained")
             )
             patching_status.and_conditions(conditions)
             return patching_status
         raise RuntimeError(f"Unknown method {method_name} in {class_name}")
 
@@ -303,7 +308,17 @@
         cfg = get_config()
         cfg["target_offload"] = queue
         with config_context(**cfg):
             return self.clf_prob.predict_proba(X)
 
     def _onedal_decision_function(self, X, queue=None):
         return self._onedal_estimator.decision_function(X, queue=queue)
+
+    def _onedal_score(self, X, y, sample_weight=None, queue=None):
+        return accuracy_score(
+            y, self._onedal_predict(X, queue=queue), sample_weight=sample_weight
+        )
+
+    fit.__doc__ = sklearn_SVC.fit.__doc__
+    predict.__doc__ = sklearn_SVC.predict.__doc__
+    decision_function.__doc__ = sklearn_SVC.decision_function.__doc__
+    score.__doc__ = sklearn_SVC.score.__doc__
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/svm/tests/test_svm.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/svm/tests/test_svm.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/_utils.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/_utils.py`

 * *Files 5% similar despite different names*

```diff
@@ -26,14 +26,15 @@
     TransformerMixin,
 )
 from sklearn.datasets import load_diabetes, load_iris
 from sklearn.neighbors._base import KNeighborsMixin
 
 from onedal.tests.utils._dataframes_support import _convert_to_dataframe
 from sklearnex import get_patch_map, patch_sklearn, sklearn_is_patched, unpatch_sklearn
+from sklearnex.linear_model import LogisticRegression
 from sklearnex.neighbors import (
     KNeighborsClassifier,
     KNeighborsRegressor,
     LocalOutlierFactor,
     NearestNeighbors,
 )
 from sklearnex.svm import SVC, NuSVC
@@ -91,36 +92,44 @@
     for i in [
         LocalOutlierFactor(novelty=True),
         SVC(probability=True),
         NuSVC(probability=True),
         KNeighborsClassifier(algorithm="brute"),
         KNeighborsRegressor(algorithm="brute"),
         NearestNeighbors(algorithm="brute"),
+        LogisticRegression(solver="newton-cg"),
     ]
 }
 
 
 def gen_models_info(algorithms):
     output = []
     for i in algorithms:
-        # split handles SPECIAL_INSTANCES or custom inputs
-        # custom sklearn inputs must be a dict of estimators
-        # with keys set by the __str__ method
-        est = PATCHED_MODELS[i.split("(")[0]]
+
+        if i in PATCHED_MODELS:
+            est = PATCHED_MODELS[i]
+        elif i in SPECIAL_INSTANCES:
+            est = SPECIAL_INSTANCES[i].__class__
+        else:
+            raise KeyError(f"Unrecognized sklearnex estimator: {i}")
 
         methods = set()
         candidates = set(
             [i for i in dir(est) if not i.startswith("_") and not i.endswith("_")]
         )
 
         for mixin, method, _ in mixin_map:
             if issubclass(est, mixin):
                 methods |= candidates & set(method)
 
-        output += [[i, j] for j in methods]
+        output += [[i, j] for j in methods] if methods else [[i, None]]
+
+    # In the case that no methods are available, set method to None.
+    # This will allow estimators without mixins to still test the fit
+    # method in various tests.
     return output
 
 
 def gen_dataset(estimator, queue=None, target_df=None, dtype=np.float64):
     dataset = None
     name = estimator.__class__.__name__
     est = PATCHED_MODELS[name]
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_config.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_config.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_memory_usage.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_memory_usage.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_monkeypatch.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_monkeypatch.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_n_jobs_support.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_n_jobs_support.py`

 * *Files 15% similar despite different names*

```diff
@@ -80,14 +80,20 @@
     # check `n_jobs` log entry for supported methods
     # `fit` call is required before other methods
     check_method(X, Y, method=estimator_instance.fit, caplog=caplog)
     for method_name in estimator_instance._n_jobs_supported_onedal_methods:
         if method_name == "fit":
             continue
         method = getattr(estimator_instance, method_name)
-        if len(inspect.signature(method).parameters) == 0:
+        argdict = inspect.signature(method).parameters
+        argnum = len(
+            [i for i in argdict if argdict[i].default == inspect.Parameter.empty]
+        )
+        if argnum == 0:
             check_method(method=method, caplog=caplog)
-        else:
+        elif argnum == 1:
             check_method(X, method=method, caplog=caplog)
+        else:
+            check_method(X, Y, method=method, caplog=caplog)
     # check if correct methods were decorated
     check_methods_decoration(estimator_class)
     check_methods_decoration(estimator_instance)
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_parallel.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_parallel.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_patching.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_patching.py`

 * *Files 8% similar despite different names*

```diff
@@ -22,74 +22,76 @@
 import re
 import sys
 from inspect import signature
 
 import numpy as np
 import numpy.random as nprnd
 import pytest
-from _utils import (
-    DTYPES,
-    PATCHED_FUNCTIONS,
-    PATCHED_MODELS,
-    SPECIAL_INSTANCES,
-    UNPATCHED_FUNCTIONS,
-    UNPATCHED_MODELS,
-    gen_dataset,
-    gen_models_info,
-)
-from sklearn.base import (
-    BaseEstimator,
-    ClassifierMixin,
-    ClusterMixin,
-    OutlierMixin,
-    RegressorMixin,
-    TransformerMixin,
-)
+from sklearn.base import BaseEstimator
 
 from daal4py.sklearn._utils import sklearn_check_version
 from onedal.tests.utils._dataframes_support import (
     _convert_to_dataframe,
     get_dataframes_and_queues,
 )
 from sklearnex import is_patched_instance
 from sklearnex.dispatcher import _is_preview_enabled
 from sklearnex.metrics import pairwise_distances, roc_auc_score
+from sklearnex.tests._utils import (
+    DTYPES,
+    PATCHED_FUNCTIONS,
+    PATCHED_MODELS,
+    SPECIAL_INSTANCES,
+    UNPATCHED_FUNCTIONS,
+    UNPATCHED_MODELS,
+    gen_dataset,
+    gen_models_info,
+)
 
 
 @pytest.mark.parametrize("dtype", DTYPES)
-@pytest.mark.parametrize(
-    "dataframe, queue", get_dataframes_and_queues(dataframe_filter_="numpy")
-)
+@pytest.mark.parametrize("dataframe, queue", get_dataframes_and_queues())
 @pytest.mark.parametrize("metric", ["cosine", "correlation"])
 def test_pairwise_distances_patching(caplog, dataframe, queue, dtype, metric):
     with caplog.at_level(logging.WARNING, logger="sklearnex"):
+        if dtype == np.float16 and queue and not queue.sycl_device.has_aspect_fp16:
+            pytest.skip("Hardware does not support fp16 SYCL testing")
+        elif dtype == np.float64 and queue and not queue.sycl_device.has_aspect_fp64:
+            pytest.skip("Hardware does not support fp64 SYCL testing")
+        elif queue and queue.sycl_device.is_gpu:
+            pytest.skip("pairwise_distances does not support GPU queues")
+
         rng = nprnd.default_rng()
         X = _convert_to_dataframe(
-            rng.random(size=1000), sycl_queue=queue, target_df=dataframe, dtype=dtype
+            rng.random(size=1000).reshape(1, -1),
+            sycl_queue=queue,
+            target_df=dataframe,
+            dtype=dtype,
         )
 
-        _ = pairwise_distances(X.reshape(1, -1), metric=metric)
+        _ = pairwise_distances(X, metric=metric)
     assert all(
         [
             "running accelerated version" in i.message
             or "fallback to original Scikit-learn" in i.message
             for i in caplog.records
         ]
     ), f"sklearnex patching issue in pairwise_distances with log: \n{caplog.text}"
 
 
 @pytest.mark.parametrize(
     "dtype", [i for i in DTYPES if "32" in i.__name__ or "64" in i.__name__]
 )
-@pytest.mark.parametrize(
-    "dataframe, queue", get_dataframes_and_queues(dataframe_filter_="numpy")
-)
+@pytest.mark.parametrize("dataframe, queue", get_dataframes_and_queues())
 def test_roc_auc_score_patching(caplog, dataframe, queue, dtype):
     if dtype in [np.uint32, np.uint64] and sys.platform == "win32":
         pytest.skip("Windows issue with unsigned ints")
+    elif dtype == np.float64 and queue and not queue.sycl_device.has_aspect_fp64:
+        pytest.skip("Hardware does not support fp64 SYCL testing")
+
     with caplog.at_level(logging.WARNING, logger="sklearnex"):
         rng = nprnd.default_rng()
         X = _convert_to_dataframe(
             rng.integers(2, size=1000),
             sycl_queue=queue,
             target_df=dataframe,
             dtype=dtype,
@@ -108,69 +110,89 @@
             or "fallback to original Scikit-learn" in i.message
             for i in caplog.records
         ]
     ), f"sklearnex patching issue in roc_auc_score with log: \n{caplog.text}"
 
 
 @pytest.mark.parametrize("dtype", DTYPES)
-@pytest.mark.parametrize(
-    "dataframe, queue", get_dataframes_and_queues(dataframe_filter_="numpy")
-)
+@pytest.mark.parametrize("dataframe, queue", get_dataframes_and_queues())
 @pytest.mark.parametrize("estimator, method", gen_models_info(PATCHED_MODELS))
 def test_standard_estimator_patching(caplog, dataframe, queue, dtype, estimator, method):
     with caplog.at_level(logging.WARNING, logger="sklearnex"):
         est = PATCHED_MODELS[estimator]()
 
+        if queue:
+            if dtype == np.float16 and not queue.sycl_device.has_aspect_fp16:
+                pytest.skip("Hardware does not support fp16 SYCL testing")
+            elif dtype == np.float64 and not queue.sycl_device.has_aspect_fp64:
+                pytest.skip("Hardware does not support fp64 SYCL testing")
+            elif queue.sycl_device.is_gpu and estimator in [
+                "KMeans",
+                "ElasticNet",
+                "Lasso",
+                "Ridge",
+            ]:
+                pytest.skip(f"{estimator} does not support GPU queues")
+
         if estimator == "TSNE" and method == "fit_transform":
             pytest.skip("TSNE.fit_transform is too slow for common testing")
         elif (
             estimator == "Ridge"
             and method in ["predict", "score"]
             and sys.platform == "win32"
             and dtype in [np.uint32, np.uint64]
         ):
             pytest.skip("Windows segmentation fault for Ridge.predict for unsigned ints")
-        elif not hasattr(est, method):
+        elif method and not hasattr(est, method):
             pytest.skip(f"sklearn available_if prevents testing {estimator}.{method}")
+
         X, y = gen_dataset(est, queue=queue, target_df=dataframe, dtype=dtype)
         est.fit(X, y)
 
-        if method != "score":
-            getattr(est, method)(X)
-        else:
-            est.score(X, y)
+        if method:
+            if method != "score":
+                getattr(est, method)(X)
+            else:
+                est.score(X, y)
     assert all(
         [
             "running accelerated version" in i.message
             or "fallback to original Scikit-learn" in i.message
             for i in caplog.records
         ]
     ), f"sklearnex patching issue in {estimator}.{method} with log: \n{caplog.text}"
 
 
 @pytest.mark.parametrize("dtype", DTYPES)
-@pytest.mark.parametrize(
-    "dataframe, queue", get_dataframes_and_queues(dataframe_filter_="numpy")
-)
+@pytest.mark.parametrize("dataframe, queue", get_dataframes_and_queues())
 @pytest.mark.parametrize("estimator, method", gen_models_info(SPECIAL_INSTANCES))
 def test_special_estimator_patching(caplog, dataframe, queue, dtype, estimator, method):
     # prepare logging
 
     with caplog.at_level(logging.WARNING, logger="sklearnex"):
         est = SPECIAL_INSTANCES[estimator]
 
+        # Its not possible to get the dpnp/dpctl arrays to be in the proper dtype
+        if dtype == np.float16 and queue and not queue.sycl_device.has_aspect_fp16:
+            pytest.skip("Hardware does not support fp16 SYCL testing")
+        elif dtype == np.float64 and queue and not queue.sycl_device.has_aspect_fp64:
+            pytest.skip("Hardware does not support fp64 SYCL testing")
+
         X, y = gen_dataset(est, queue=queue, target_df=dataframe, dtype=dtype)
         est.fit(X, y)
 
-        if not hasattr(est, method):
+        if method and not hasattr(est, method):
             pytest.skip(f"sklearn available_if prevents testing {estimator}.{method}")
-        if method != "score":
-            getattr(est, method)(X)
-        else:
-            est.score(X, y)
+
+        if method:
+            if method != "score":
+                getattr(est, method)(X)
+            else:
+                est.score(X, y)
+
     assert all(
         [
             "running accelerated version" in i.message
             or "fallback to original Scikit-learn" in i.message
             for i in caplog.records
         ]
     ), f"sklearnex patching issue in {estimator}.{method} with log: \n{caplog.text}"
@@ -307,26 +329,14 @@
     est = PATCHED_MODELS[estimator]
     if estimator in UNPATCHED_MODELS:
         assert issubclass(
             est, UNPATCHED_MODELS[estimator]
         ), f"{estimator} does not inherit from the patched sklearn estimator"
     else:
         assert issubclass(est, BaseEstimator)
-        assert any(
-            [
-                issubclass(est, i)
-                for i in [
-                    ClassifierMixin,
-                    ClusterMixin,
-                    OutlierMixin,
-                    RegressorMixin,
-                    TransformerMixin,
-                ]
-            ]
-        ), f"{estimator} does not inherit a sklearn Mixin"
 
 
 @pytest.mark.parametrize("estimator", UNPATCHED_MODELS.keys())
 def test_docstring_patching_match(estimator):
     patched = PATCHED_MODELS[estimator]
     unpatched = UNPATCHED_MODELS[estimator]
     patched_docstrings = {
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/tests/test_run_to_run_stability_tests.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/tests/test_run_to_run_stability_tests.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/__init__.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/validation.py`

 * *Files 5% similar despite different names*

```diff
@@ -10,10 +10,8 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ===============================================================================
 
-from .validation import _assert_all_finite
-
-__all__ = ["_assert_all_finite"]
+from daal4py.sklearn.utils.validation import _assert_all_finite
```

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/parallel.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/parallel.py`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.data/data/Lib/site-packages/sklearnex/utils/validation.py` & `scikit_learn_intelex-2024.4.0.data/data/Lib/site-packages/sklearnex/utils/__init__.py`

 * *Files 14% similar despite different names*

```diff
@@ -10,8 +10,11 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ===============================================================================
 
-from daal4py.sklearn.utils.validation import _assert_all_finite
+from ._namespace import get_namespace
+from .validation import _assert_all_finite
+
+__all__ = ["get_namespace", "_assert_all_finite"]
```

## Comparing `scikit_learn_intelex-2024.3.0.dist-info/LICENSE.txt` & `scikit_learn_intelex-2024.4.0.dist-info/LICENSE.txt`

 * *Files identical despite different names*

## Comparing `scikit_learn_intelex-2024.3.0.dist-info/METADATA` & `scikit_learn_intelex-2024.4.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: scikit-learn-intelex
-Version: 2024.3.0
+Version: 2024.4.0
 Summary: Intel(R) Extension for Scikit-learn is a seamless way to speed up your Scikit-learn application.
 Home-page: https://github.com/intel/scikit-learn-intelex
 Author: Intel Corporation
 Author-email: onedal.maintainers@intel.com
 Maintainer-email: onedal.maintainers@intel.com
 License: Apache-2.0
 Project-URL: Bug Tracker, https://github.com/intel/scikit-learn-intelex/issues
@@ -27,15 +27,15 @@
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System
 Classifier: Topic :: Software Development
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
 License-File: LICENSE.txt
-Requires-Dist: daal4py (==2024.3.0)
+Requires-Dist: daal4py (==2024.4.0)
 Requires-Dist: scikit-learn (>=0.22)
 
 
 # Intel(R) Extension for Scikit-learn*
 
 [![Build Status](https://dev.azure.com/daal/daal4py/_apis/build/status/CI?branchName=master)](https://dev.azure.com/daal/daal4py/_build/latest?definitionId=9&branchName=master)
 [![Coverity Scan Build Status](https://scan.coverity.com/projects/21716/badge.svg)](https://scan.coverity.com/projects/daal4py)
```

