# Comparing `tmp/nwp_consumer-0.5.8-py3-none-any.whl.zip` & `tmp/nwp_consumer-0.5.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,70 +1,70 @@
-Zip file size: 94505 bytes, number of entries: 68
--rw-r--r--  2.0 unx     2398 b- defN 24-Apr-09 14:15 nwp_consumer/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 24-Apr-09 14:15 nwp_consumer/cmd/__init__.py
--rw-r--r--  2.0 unx     8717 b- defN 24-Apr-09 14:15 nwp_consumer/cmd/main.py
--rw-r--r--  2.0 unx     2235 b- defN 24-Apr-09 14:15 nwp_consumer/cmd/test_main.py
--rw-r--r--  2.0 unx      782 b- defN 24-Apr-09 14:15 nwp_consumer/internal/__init__.py
--rw-r--r--  2.0 unx     3139 b- defN 24-Apr-09 14:15 nwp_consumer/internal/cache.py
--rw-r--r--  2.0 unx     5974 b- defN 24-Apr-09 14:15 nwp_consumer/internal/models.py
--rw-r--r--  2.0 unx      430 b- defN 24-Apr-09 14:15 nwp_consumer/internal/config/__init__.py
--rw-r--r--  2.0 unx     7229 b- defN 24-Apr-09 14:15 nwp_consumer/internal/config/env.py
--rw-r--r--  2.0 unx     1682 b- defN 24-Apr-09 14:15 nwp_consumer/internal/config/test_env.py
--rw-r--r--  2.0 unx      257 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/__init__.py
--rw-r--r--  2.0 unx       49 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ceda/__init__.py
--rw-r--r--  2.0 unx     1728 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ceda/_models.py
--rw-r--r--  2.0 unx    11974 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ceda/client.py
--rw-r--r--  2.0 unx     4289 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ceda/test_client.py
--rw-r--r--  2.0 unx       50 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/cmc/__init__.py
--rw-r--r--  2.0 unx      768 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/cmc/_consts.py
--rw-r--r--  2.0 unx     1035 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/cmc/_models.py
--rw-r--r--  2.0 unx    13006 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/cmc/client.py
--rw-r--r--  2.0 unx     3033 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/cmc/test_client.py
--rw-r--r--  2.0 unx      103 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ecmwf/__init__.py
--rw-r--r--  2.0 unx     2515 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ecmwf/_models.py
--rw-r--r--  2.0 unx    13653 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ecmwf/mars.py
--rw-r--r--  2.0 unx     6907 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ecmwf/s3.py
--rw-r--r--  2.0 unx     4878 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ecmwf/test_mars.py
--rw-r--r--  2.0 unx     3970 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/ecmwf/test_s3.py
--rw-r--r--  2.0 unx       49 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/icon/__init__.py
--rw-r--r--  2.0 unx     1211 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/icon/_consts.py
--rw-r--r--  2.0 unx     1308 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/icon/_models.py
--rw-r--r--  2.0 unx    16581 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/icon/client.py
--rw-r--r--  2.0 unx     5221 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/icon/test_client.py
--rw-r--r--  2.0 unx       49 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/meteofrance/__init__.py
--rw-r--r--  2.0 unx      492 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/meteofrance/_consts.py
--rw-r--r--  2.0 unx     1037 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/meteofrance/_models.py
--rw-r--r--  2.0 unx    11999 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/meteofrance/client.py
--rw-r--r--  2.0 unx     3319 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/meteofrance/test_client.py
--rw-r--r--  2.0 unx       49 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/metoffice/__init__.py
--rw-r--r--  2.0 unx     1556 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/metoffice/_models.py
--rw-r--r--  2.0 unx    12116 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/metoffice/client.py
--rw-r--r--  2.0 unx     3670 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/metoffice/test_client.py
--rw-r--r--  2.0 unx      114 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/__init__.py
--rw-r--r--  2.0 unx     2823 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/_consts.py
--rw-r--r--  2.0 unx     1041 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/_models.py
--rw-r--r--  2.0 unx    10520 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/aws.py
--rw-r--r--  2.0 unx    10070 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/ncar.py
--rw-r--r--  2.0 unx     1757 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/test_aws.py
--rw-r--r--  2.0 unx     1759 b- defN 24-Apr-09 14:15 nwp_consumer/internal/inputs/noaa/test_ncar.py
--rw-r--r--  2.0 unx      164 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/__init__.py
--rw-r--r--  2.0 unx       50 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/huggingface/__init__.py
--rw-r--r--  2.0 unx    11240 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/huggingface/client.py
--rw-r--r--  2.0 unx     1253 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/huggingface/test_client.py
--rw-r--r--  2.0 unx       49 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/localfs/__init__.py
--rw-r--r--  2.0 unx     4350 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/localfs/client.py
--rw-r--r--  2.0 unx     6125 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/localfs/test_client.py
--rw-r--r--  2.0 unx       49 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/s3/__init__.py
--rw-r--r--  2.0 unx     6780 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/s3/client.py
--rw-r--r--  2.0 unx     7728 b- defN 24-Apr-09 14:15 nwp_consumer/internal/outputs/s3/test_client.py
--rw-r--r--  2.0 unx       75 b- defN 24-Apr-09 14:15 nwp_consumer/internal/service/__init__.py
--rw-r--r--  2.0 unx    15615 b- defN 24-Apr-09 14:15 nwp_consumer/internal/service/consumer.py
--rw-r--r--  2.0 unx     5757 b- defN 24-Apr-09 14:15 nwp_consumer/internal/service/test_consumer.py
--rw-r--r--  2.0 unx        0 b- defN 24-Apr-09 14:15 test_integration/__init__.py
--rw-r--r--  2.0 unx     4601 b- defN 24-Apr-09 14:15 test_integration/test_inputs_integration.py
--rw-r--r--  2.0 unx     6910 b- defN 24-Apr-09 14:15 test_integration/test_service_integration.py
--rw-r--r--  2.0 unx    13252 b- defN 24-Apr-09 14:15 nwp_consumer-0.5.8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-09 14:15 nwp_consumer-0.5.8.dist-info/WHEEL
--rw-r--r--  2.0 unx       60 b- defN 24-Apr-09 14:15 nwp_consumer-0.5.8.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       30 b- defN 24-Apr-09 14:15 nwp_consumer-0.5.8.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     6719 b- defN 24-Apr-09 14:15 nwp_consumer-0.5.8.dist-info/RECORD
-68 files, 278441 bytes uncompressed, 83467 bytes compressed:  70.0%
+Zip file size: 94715 bytes, number of entries: 68
+-rw-r--r--  2.0 unx     2398 b- defN 24-Apr-10 12:56 nwp_consumer/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 24-Apr-10 12:56 nwp_consumer/cmd/__init__.py
+-rw-r--r--  2.0 unx     8717 b- defN 24-Apr-10 12:56 nwp_consumer/cmd/main.py
+-rw-r--r--  2.0 unx     2235 b- defN 24-Apr-10 12:56 nwp_consumer/cmd/test_main.py
+-rw-r--r--  2.0 unx      782 b- defN 24-Apr-10 12:56 nwp_consumer/internal/__init__.py
+-rw-r--r--  2.0 unx     3139 b- defN 24-Apr-10 12:56 nwp_consumer/internal/cache.py
+-rw-r--r--  2.0 unx     5974 b- defN 24-Apr-10 12:56 nwp_consumer/internal/models.py
+-rw-r--r--  2.0 unx      430 b- defN 24-Apr-10 12:56 nwp_consumer/internal/config/__init__.py
+-rw-r--r--  2.0 unx     7229 b- defN 24-Apr-10 12:56 nwp_consumer/internal/config/env.py
+-rw-r--r--  2.0 unx     1682 b- defN 24-Apr-10 12:56 nwp_consumer/internal/config/test_env.py
+-rw-r--r--  2.0 unx      257 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/__init__.py
+-rw-r--r--  2.0 unx       49 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ceda/__init__.py
+-rw-r--r--  2.0 unx     1728 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ceda/_models.py
+-rw-r--r--  2.0 unx    11974 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ceda/client.py
+-rw-r--r--  2.0 unx     4289 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ceda/test_client.py
+-rw-r--r--  2.0 unx       50 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/cmc/__init__.py
+-rw-r--r--  2.0 unx      768 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/cmc/_consts.py
+-rw-r--r--  2.0 unx     1035 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/cmc/_models.py
+-rw-r--r--  2.0 unx    13006 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/cmc/client.py
+-rw-r--r--  2.0 unx     3033 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/cmc/test_client.py
+-rw-r--r--  2.0 unx      103 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ecmwf/__init__.py
+-rw-r--r--  2.0 unx     2525 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ecmwf/_models.py
+-rw-r--r--  2.0 unx    14148 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ecmwf/mars.py
+-rw-r--r--  2.0 unx     6907 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ecmwf/s3.py
+-rw-r--r--  2.0 unx     4776 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ecmwf/test_mars.py
+-rw-r--r--  2.0 unx     3970 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/ecmwf/test_s3.py
+-rw-r--r--  2.0 unx       49 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/icon/__init__.py
+-rw-r--r--  2.0 unx     1211 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/icon/_consts.py
+-rw-r--r--  2.0 unx     1308 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/icon/_models.py
+-rw-r--r--  2.0 unx    16581 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/icon/client.py
+-rw-r--r--  2.0 unx     5221 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/icon/test_client.py
+-rw-r--r--  2.0 unx       49 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/meteofrance/__init__.py
+-rw-r--r--  2.0 unx      492 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/meteofrance/_consts.py
+-rw-r--r--  2.0 unx     1037 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/meteofrance/_models.py
+-rw-r--r--  2.0 unx    11999 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/meteofrance/client.py
+-rw-r--r--  2.0 unx     3319 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/meteofrance/test_client.py
+-rw-r--r--  2.0 unx       49 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/metoffice/__init__.py
+-rw-r--r--  2.0 unx     1556 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/metoffice/_models.py
+-rw-r--r--  2.0 unx    12116 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/metoffice/client.py
+-rw-r--r--  2.0 unx     3670 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/metoffice/test_client.py
+-rw-r--r--  2.0 unx      114 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/__init__.py
+-rw-r--r--  2.0 unx     2823 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/_consts.py
+-rw-r--r--  2.0 unx     1041 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/_models.py
+-rw-r--r--  2.0 unx    10520 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/aws.py
+-rw-r--r--  2.0 unx    10070 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/ncar.py
+-rw-r--r--  2.0 unx     1757 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/test_aws.py
+-rw-r--r--  2.0 unx     1759 b- defN 24-Apr-10 12:56 nwp_consumer/internal/inputs/noaa/test_ncar.py
+-rw-r--r--  2.0 unx      164 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/__init__.py
+-rw-r--r--  2.0 unx       50 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/huggingface/__init__.py
+-rw-r--r--  2.0 unx    11240 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/huggingface/client.py
+-rw-r--r--  2.0 unx     1253 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/huggingface/test_client.py
+-rw-r--r--  2.0 unx       49 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/localfs/__init__.py
+-rw-r--r--  2.0 unx     4350 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/localfs/client.py
+-rw-r--r--  2.0 unx     6125 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/localfs/test_client.py
+-rw-r--r--  2.0 unx       49 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/s3/__init__.py
+-rw-r--r--  2.0 unx     6780 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/s3/client.py
+-rw-r--r--  2.0 unx     7728 b- defN 24-Apr-10 12:56 nwp_consumer/internal/outputs/s3/test_client.py
+-rw-r--r--  2.0 unx       75 b- defN 24-Apr-10 12:56 nwp_consumer/internal/service/__init__.py
+-rw-r--r--  2.0 unx    15615 b- defN 24-Apr-10 12:56 nwp_consumer/internal/service/consumer.py
+-rw-r--r--  2.0 unx     5757 b- defN 24-Apr-10 12:56 nwp_consumer/internal/service/test_consumer.py
+-rw-r--r--  2.0 unx        0 b- defN 24-Apr-10 12:56 test_integration/__init__.py
+-rw-r--r--  2.0 unx     4601 b- defN 24-Apr-10 12:56 test_integration/test_inputs_integration.py
+-rw-r--r--  2.0 unx     6910 b- defN 24-Apr-10 12:56 test_integration/test_service_integration.py
+-rw-r--r--  2.0 unx    13252 b- defN 24-Apr-10 12:56 nwp_consumer-0.5.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-10 12:56 nwp_consumer-0.5.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx       60 b- defN 24-Apr-10 12:56 nwp_consumer-0.5.9.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       30 b- defN 24-Apr-10 12:56 nwp_consumer-0.5.9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     6719 b- defN 24-Apr-10 12:56 nwp_consumer-0.5.9.dist-info/RECORD
+68 files, 278844 bytes uncompressed, 83677 bytes compressed:  70.0%
```

## zipnote {}

```diff
@@ -183,23 +183,23 @@
 
 Filename: test_integration/test_inputs_integration.py
 Comment: 
 
 Filename: test_integration/test_service_integration.py
 Comment: 
 
-Filename: nwp_consumer-0.5.8.dist-info/METADATA
+Filename: nwp_consumer-0.5.9.dist-info/METADATA
 Comment: 
 
-Filename: nwp_consumer-0.5.8.dist-info/WHEEL
+Filename: nwp_consumer-0.5.9.dist-info/WHEEL
 Comment: 
 
-Filename: nwp_consumer-0.5.8.dist-info/entry_points.txt
+Filename: nwp_consumer-0.5.9.dist-info/entry_points.txt
 Comment: 
 
-Filename: nwp_consumer-0.5.8.dist-info/top_level.txt
+Filename: nwp_consumer-0.5.9.dist-info/top_level.txt
 Comment: 
 
-Filename: nwp_consumer-0.5.8.dist-info/RECORD
+Filename: nwp_consumer-0.5.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## nwp_consumer/internal/inputs/ecmwf/_models.py

```diff
@@ -5,14 +5,15 @@
 
 
 @dataclass
 class ECMWFMarsFileInfo(internal.FileInfoModel):
     inittime: dt.datetime
     area: str
     params: list[str]
+    steps: list[int]
 
     def filename(self) -> str:
         """Overrides the corresponding method in the parent class."""
         # ECMWF does not have explicit filenames when using the MARS API
         # * As such, name manually based on their inittime and area covered
         #   e.g. `ecmwf_uk_20210101T0000.grib`
         return f"ecmwf_{self.area}_{self.inittime.strftime('%Y%m%dT%H%M')}.grib"
@@ -27,15 +28,15 @@
 
     def variables(self) -> list[str]:
         """Overrides the corresponding method in the parent class."""
         return self.params
 
     def steps(self) -> list[int]:
         """Overrides the corresponding method in the parent class."""
-        raise NotImplementedError()
+        raise self.steps
 
 
 @dataclass
 class ECMWFLiveFileInfo(internal.FileInfoModel):
     """Dataclass for ECMWF live data files.
 
     Live ECMWF files are extensionless grib files named e.g. 'A1D02200000022001001'.
```

## nwp_consumer/internal/inputs/ecmwf/mars.py

```diff
@@ -1,8 +1,9 @@
 """Implements a client to fetch data from ECMWF."""
+
 import datetime as dt
 import inspect
 import os
 import pathlib
 import re
 import tempfile
 import typing
@@ -72,18 +73,18 @@
     """Implements a client to fetch data from ECMWF's MARS API."""
 
     server: ecmwfapi.api.ECMWFService
     area: str
     desired_params: list[str]
 
     def __init__(
-            self,
-            area: str = "uk",
-            hours: int = 48,
-            param_group: str = "default",
+        self,
+        area: str = "uk",
+        hours: int = 48,
+        param_group: str = "default",
     ) -> None:
         """Create a new ECMWF Mars Client.
 
         Exposes a client for ECMWF's MARS API that conforms to the FetcherInterface.
 
         Args:
             area: The area to fetch data for. Can be one of:
@@ -132,14 +133,15 @@
 
         with open(tf.name, "w") as f:
             req: str = self._buildMarsRequest(
                 list_only=True,
                 it=it,
                 target=tf.name,
                 params=self.desired_params,
+                steps=list(range(0, self.hours)),
             )
 
             log.debug(event="listing ECMWF MARS inittime data", request=req, inittime=it)
 
             try:
                 self.server.execute(req=req, target=tf.name)
             except ecmwfapi.api.APIException as e:
@@ -154,47 +156,55 @@
             )
             return []
 
         # Ensure only available parameters are requested by populating the
         # `available_params` list according to the result of the list request
         with open(tf.name) as f:
             file_contents: str = f.read()
-            available_params: list[str] = _parseAvaliableParams(fileData=file_contents)
+            available_data = _parseListing(fileData=file_contents)
             for parameter in self.desired_params:
-                if parameter not in available_params:
+                if parameter not in available_data["params"]:
                     log.warn(
                         event=f"ECMWF MARS inittime data does not contain parameter {parameter}",
                         parameter=parameter,
                         inittime=it,
                     )
 
         log.debug(
             event="Listed raw files for ECMWF MARS inittime",
             inittime=it,
-            available_params=available_params,
+            available_params=available_data["params"],
         )
 
         # Clean up the temporary file
         tf.close()
         os.unlink(tf.name)
 
-        return [ECMWFMarsFileInfo(inittime=it, area=self.area, params=available_params)]
+        return [
+            ECMWFMarsFileInfo(
+                inittime=it,
+                area=self.area,
+                params=available_data["params"],
+                steps=available_data["steps"],
+            )
+        ]
 
     def downloadToCache(  # noqa: D102
         self,
         *,
         fi: internal.FileInfoModel,
     ) -> pathlib.Path:
         cfp: pathlib.Path = internal.rawCachePath(it=fi.it(), filename=fi.filename())
 
         req: str = self._buildMarsRequest(
             list_only=False,
             it=fi.it(),
             target=cfp.as_posix(),
             params=fi.variables(),
+            steps=fi.steps,
         )
 
         log.debug(
             event="fetching ECMWF MARS data",
             request=req,
             inittime=fi.it(),
             filename=fi.filename(),
@@ -294,54 +304,56 @@
             "v100": internal.OCFParameter.WindVComponent100m,
             "u200": internal.OCFParameter.WindUComponent200m,
             "v200": internal.OCFParameter.WindVComponent200m,
             "vis": internal.OCFParameter.VisibilityAGL,
         }
 
     def _buildMarsRequest(
-            self,
-            *,
-            list_only: bool,
-            it: dt.datetime,
-            target: str,
-            params: list[str],
+        self,
+        *,
+        list_only: bool,
+        it: dt.datetime,
+        target: str,
+        params: list[str],
+        steps: list[int],
     ) -> str:
         """Build a MARS request according to the parameters of the client.
 
         Args:
             list_only: Whether to build a request that only lists the files that match
                 the request, or whether to build a request that downloads the files
                 that match the request.
             it: The initialisation time to request data for.
             target: The path to the target file to write the data to.
             params: The parameters to request data for.
+            steps: The steps to request data for.
 
         Returns:
             The MARS request.
         """
         marsReq: str = f"""
             {"list" if list_only else "retrieve"},
                 class    = od,
                 date     = {it.strftime("%Y%m%d")},
                 expver   = 1,
                 levtype  = sfc,
                 param    = {'/'.join(params)},
-                step     = 0/to/{self.hours}/by/1,
+                step     = {'/'.join(map(str, steps))},
                 stream   = oper,
                 time     = {it.strftime("%H")},
                 type     = fc,
                 area     = {AREA_MAP[self.area]},
                 grid     = 0.1/0.1,
                 target   = "{target}"
         """
 
         return inspect.cleandoc(marsReq)
 
 
-def _parseAvaliableParams(fileData: str) -> list[str]:
+def _parseListing(fileData: str) -> dict[str, list[str] | list[int]]:
     """Parse the response from a MARS list request.
 
     When calling LIST to MARS, the response is a file containing the available
     parameters, steps, times and sizes etc. This function parses the file to
     extract the available parameters.
 
     The files contains some metadata, followed by a table as follows:
@@ -355,23 +367,28 @@
     0    13204588 .       1050353320  164.128 0
 
     Grand Total
     ```
 
     This function uses positive lookahead and lookbehind regex to extract the
     lines between the table header and the "Grand Total" line. The fourth
-    column of each line is the parameter.
+    column of each line is the parameter. The fifth is the step.
 
     Args:
         fileData: The data from the file.
 
     Returns:
-        A list of parameters specified in the fileData.
+        A dict of parameters and steps available in the remote file.
     """
     tablematch = re.search(
         pattern=r"(?<!step)[\s\.\d]*?(?=\n.*?\nGrand)",
         string=fileData,
     )
+    out = {"steps": set(), "params": set()}
     if tablematch:
         tablelines: list[str] = tablematch.group(0).split("\n")
-        return list({line.split()[4] for line in tablelines if len(line.split()) > 4})
-    return []
+        for line in tablelines:
+            if len(line.split()) > 4:
+                out["steps"].add(int(line.split()[5]))
+                out["params"].add(line.split()[4])
+    out = {k: sorted(list(v)) for k, v in out.items()}
+    return out
```

## nwp_consumer/internal/inputs/ecmwf/test_mars.py

```diff
@@ -1,14 +1,14 @@
 """Tests for the ecmwf module."""
 
 import datetime as dt
 import pathlib
 import unittest.mock
 
-from .mars import PARAMETER_ECMWFCODE_MAP, MARSClient, _parseAvaliableParams
+from .mars import PARAMETER_ECMWFCODE_MAP, MARSClient, _parseListing
 
 # --------- Test setup --------- #
 
 testMARSClient = MARSClient(
     area="uk",
     hours=48,
 )
@@ -77,14 +77,15 @@
         # Test that the request is build correctly for the default client
         testDefaultClient = MARSClient()
         out = testDefaultClient._buildMarsRequest(
             list_only=True,
             target=testFilePath.as_posix(),
             it=dt.datetime(2020, 1, 1, tzinfo=dt.UTC),
             params=testDefaultClient.desired_params,
+            steps=range(4),
         )
 
         out.replace(" ", "")
         lines = out.split("\n")
         self.assertEqual(lines[0], "list,")
 
         d: dict = {}
@@ -104,14 +105,15 @@
         )
 
         out = testBasicClient._buildMarsRequest(
             list_only=False,
             target=testFilePath.as_posix(),
             it=dt.datetime(2020, 1, 1, tzinfo=dt.UTC),
             params=testBasicClient.desired_params,
+            steps=range(4),
         )
 
         out.replace(" ", "")
         lines = out.split("\n")
         self.assertEqual(lines[0], "retrieve,")
 
         d2: dict = {}
@@ -124,44 +126,32 @@
 
 
 # --------- Static methods --------- #
 
 
 class TestParseAvailableParams(unittest.TestCase):
     def test_parsesSmallFileCorrectly(self) -> None:
+        out = _parseListing(fileData=test_list_response)
 
-        out = _parseAvaliableParams(fileData=test_list_response)
-
-        self.assertListEqual(
-            [
-                "167.128",
-                "169.128",
-            ],
-            sorted(out),
+        self.assertDictEqual(
+            {
+                "params": ["167.128", "169.128"],
+                "steps": [0, 1, 2, 3],
+            },
+            out,
         )
+
     def test_parsesParamsCorrectly(self) -> None:
         testFilePath: pathlib.Path = pathlib.Path(__file__).parent / "test_list_response.txt"
 
         filedata: str = testFilePath.read_text()
 
-        out = _parseAvaliableParams(fileData=filedata)
+        out = _parseListing(fileData=filedata)
 
-        self.assertListEqual(
-            [
-                "141.128",
-                "164.128",
-                "165.128",
-                "166.128",
-                "167.128",
-                "169.128",
-                "175.128",
-                "186.128",
-                "187.128",
-                "188.128",
-                "20.3",
-                "246.228",
-                "247.228",
-                "47.128",
-                "57.128",
-            ],
-            sorted(out),
+        self.maxDiff = None
+        self.assertDictEqual(
+            {
+                "params": ["141.128","164.128","165.128","166.128","167.128","169.128","175.128","186.128","187.128","188.128","20.3","246.228","247.228","47.128","57.128"],
+                "steps": list(range(0, 49)),
+            },
+            out,
         )
```

## test_integration/test_service_integration.py

```diff
@@ -135,15 +135,15 @@
             # Ensure the dimensions have the right sizes.
             # * Should be two variables due to the "basic" parameter group
             # * Should be 4 steps due to the "3" hours
             self.assertEqual(
                 {
                     "variable": 2,
                     "init_time": 1,
-                    "step": 4,
+                    "step": 3,
                     "latitude": 141,
                     "longitude": 151,
                 },
                 dict(ds.sizes.items()),
             )
             # Ensure the init time is correct
             self.assertEqual(
```

## Comparing `nwp_consumer-0.5.8.dist-info/METADATA` & `nwp_consumer-0.5.9.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: nwp-consumer
-Version: 0.5.8
+Version: 0.5.9
 Summary: Tool for aggregating raw NWP files into .zarr files
 Author-email: Sol Cotton <sol@openclimatefix.org>
 License: MIT License
 Project-URL: repository, https://github.com/openclimatefix/nwp-consumer
 Classifier: Programming Language :: Python :: 3
 Requires-Python: >=3.11.0
 Description-Content-Type: text/markdown
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: nwp-consumer Version: 0.5.8 Summary: Tool for
+Metadata-Version: 2.1 Name: nwp-consumer Version: 0.5.9 Summary: Tool for
 aggregating raw NWP files into .zarr files Author-email: Sol Cotton
 openclimatefix.org> License: MIT License Project-URL: repository, https://
 github.com/openclimatefix/nwp-consumer Classifier: Programming Language ::
 Python :: 3 Requires-Python: >=3.11.0 Description-Content-Type: text/markdown
 Requires-Dist: cfgrib >=0.9.10.4 Requires-Dist: dask[distributed] >=2024.1.0
 Requires-Dist: docopt >=0.6.2 Requires-Dist: ecmwf-api-client >=1.6.3 Requires-
 Dist: fsspec[s3] >=2023.12.1 Requires-Dist: huggingface-hub >=0.19.4 Requires-
```

## Comparing `nwp_consumer-0.5.8.dist-info/RECORD` & `nwp_consumer-0.5.9.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -15,18 +15,18 @@
 nwp_consumer/internal/inputs/ceda/test_client.py,sha256=S1NC7G4-foRon49BeQDwQZUtB0YlRFk5MCGjR-354BM,4289
 nwp_consumer/internal/inputs/cmc/__init__.py,sha256=3cncdkH2SyqXv1jOME2_zAbwaJSkenx0yVIc2R9xwlA,50
 nwp_consumer/internal/inputs/cmc/_consts.py,sha256=sJY8bWUANyK_SPweUTGiL9Gi55hYQhCf7hZd7iiucY0,768
 nwp_consumer/internal/inputs/cmc/_models.py,sha256=pG2mkEyR_wVbwSQOE0_a7nXXwCL1Wgwi30BZOQiI5as,1035
 nwp_consumer/internal/inputs/cmc/client.py,sha256=MwMn33-N_LlCpO28zfIPHZz9_3zVhzRf71IGqjpIdgM,13006
 nwp_consumer/internal/inputs/cmc/test_client.py,sha256=Cyz3dsx4RQyIasDmO1XbxqRDiN3xkA0isw4OqC1kDvQ,3033
 nwp_consumer/internal/inputs/ecmwf/__init__.py,sha256=6HFr7NTHtwW2UuBCyVwbPcVr_8a_RMAZb7bFxONMOa8,103
-nwp_consumer/internal/inputs/ecmwf/_models.py,sha256=z7WVStV3HF_K-fD_AFW8bfBuMCb5EtiNkuGq7JU_BHU,2515
-nwp_consumer/internal/inputs/ecmwf/mars.py,sha256=lJBKpssI2U64-381CmY7Qw_froxP88J4Z0DtUlXWqXU,13653
+nwp_consumer/internal/inputs/ecmwf/_models.py,sha256=Le6APy_E5UcZppJzgaRGcRALp1fdx6oPjv-_0K5Zv64,2525
+nwp_consumer/internal/inputs/ecmwf/mars.py,sha256=suOF7-djTu1bcOVd783SMqxpptWzmjXZe9tRXSQE3zU,14148
 nwp_consumer/internal/inputs/ecmwf/s3.py,sha256=ggekJAL_amRApgWdqPYQua2z1H9OU2bgCOYWF5coQ2k,6907
-nwp_consumer/internal/inputs/ecmwf/test_mars.py,sha256=INa0i5_3VNUbaBBzOaLjjNU8Ei8I1p1gxF-HWNzLqH0,4878
+nwp_consumer/internal/inputs/ecmwf/test_mars.py,sha256=MClK__EXodR6ISSQX973bkGwMzkAB36-GRt_pk06Uz0,4776
 nwp_consumer/internal/inputs/ecmwf/test_s3.py,sha256=mlksoYnLSVshObErG3cFXf4VHGnJEice85OECguARvY,3970
 nwp_consumer/internal/inputs/icon/__init__.py,sha256=L0OZ71t39zIIfUtmC3KzyQkYk_WMHVRXAV7ycNZA4Ns,49
 nwp_consumer/internal/inputs/icon/_consts.py,sha256=VVd3jdN04gasUBn1HZFLfRO6pWGKG-O7uudFbDy20Zw,1211
 nwp_consumer/internal/inputs/icon/_models.py,sha256=CIG5IfqNov9Eap4TRStfzFCQlPhEEvJtWWtN-7QHSEA,1308
 nwp_consumer/internal/inputs/icon/client.py,sha256=njar4d0yzmL9Eyh_ohtMXueRr1Oz8DzprHeO2cpN2V0,16581
 nwp_consumer/internal/inputs/icon/test_client.py,sha256=T6c8VEkNyyKC1SQkV_HhTPDgnH9wnt2OdsMQJaKwPx0,5221
 nwp_consumer/internal/inputs/meteofrance/__init__.py,sha256=L0OZ71t39zIIfUtmC3KzyQkYk_WMHVRXAV7ycNZA4Ns,49
@@ -56,13 +56,13 @@
 nwp_consumer/internal/outputs/s3/client.py,sha256=o_NGeUMKacbV2MZ1ef2CAauNS-SmiYbCKwtiQyvrxBY,6780
 nwp_consumer/internal/outputs/s3/test_client.py,sha256=sT04vL9X8-B2N9t3EtW6iJsIiPnl_z-ZDv0SpilzmaY,7728
 nwp_consumer/internal/service/__init__.py,sha256=gQk1k5eraQ-2USn2AgXnf5rdt6ww6FRg2oYNjvqSHTs,75
 nwp_consumer/internal/service/consumer.py,sha256=Y7P0Ll-4SrnbnWYNzLQke_qAnTnghnkSYmE0PvxpSMY,15615
 nwp_consumer/internal/service/test_consumer.py,sha256=Vs_zYBuVi3gK_YQNM2H9fYZ7v4Q7FiQoKVDdJU0IJU8,5757
 test_integration/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 test_integration/test_inputs_integration.py,sha256=YACDAFQJYEGC6Y04rYGWNb4Iv3-tvgZA3z_GN0ZZ2wE,4601
-test_integration/test_service_integration.py,sha256=rFahpfQbkhCO4p6PBGd-CYSsU2xkFFZzx3ybskQHi_g,6910
-nwp_consumer-0.5.8.dist-info/METADATA,sha256=ZfBhqfON835741m3UIfITFy-dPcdiSfhYlJWrJYibHg,13252
-nwp_consumer-0.5.8.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-nwp_consumer-0.5.8.dist-info/entry_points.txt,sha256=whkUO4iL8QgbLX9PzuxCUr0_cK2yFrkuCKWvSQIG1cY,60
-nwp_consumer-0.5.8.dist-info/top_level.txt,sha256=GLVH2eyxRM0tzrtIODBgCzvNIlJbizMhpB2EH513QIs,30
-nwp_consumer-0.5.8.dist-info/RECORD,,
+test_integration/test_service_integration.py,sha256=ATu1uP0dCgYWN3hx7V-eout_4MylSSEpFM5M-_30Ws0,6910
+nwp_consumer-0.5.9.dist-info/METADATA,sha256=F0XYRltsuvOpeoBp9iMUD8YFWJ8nbjYrafsUdltphjw,13252
+nwp_consumer-0.5.9.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+nwp_consumer-0.5.9.dist-info/entry_points.txt,sha256=whkUO4iL8QgbLX9PzuxCUr0_cK2yFrkuCKWvSQIG1cY,60
+nwp_consumer-0.5.9.dist-info/top_level.txt,sha256=GLVH2eyxRM0tzrtIODBgCzvNIlJbizMhpB2EH513QIs,30
+nwp_consumer-0.5.9.dist-info/RECORD,,
```

