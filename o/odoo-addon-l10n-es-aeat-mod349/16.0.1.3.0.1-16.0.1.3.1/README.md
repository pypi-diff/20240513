# Comparing `tmp/odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1-py3-none-any.whl.zip` & `tmp/odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,42 +1,42 @@
-Zip file size: 786240 bytes, number of entries: 40
--rw-r--r--  2.0 unx     7487 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/README.rst
--rw-r--r--  2.0 unx       87 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/__init__.py
--rw-r--r--  2.0 unx     1436 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/__manifest__.py
--rw-r--r--  2.0 unx     2283 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/data/aeat_349_map_data.xml
--rw-r--r--  2.0 unx    14209 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_data.xml
--rw-r--r--  2.0 unx     6272 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_partner_data.xml
--rw-r--r--  2.0 unx     9323 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_partner_refund_data.xml
--rw-r--r--  2.0 unx   994088 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/docs/BOE-A-2010-5098.pdf
--rw-r--r--  2.0 unx    45003 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/docs/NREG-349-2016.docx
--rw-r--r--  2.0 unx    43516 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/i18n/ca.po
--rw-r--r--  2.0 unx    43247 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/i18n/es.po
--rw-r--r--  2.0 unx    38506 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/i18n/l10n_es_aeat_mod349.pot
--rw-r--r--  2.0 unx      207 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/models/__init__.py
--rw-r--r--  2.0 unx     1858 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/models/account_move.py
--rw-r--r--  2.0 unx     1144 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/models/account_tax.py
--rw-r--r--  2.0 unx      416 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/models/account_tax_template.py
--rw-r--r--  2.0 unx     1099 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/models/aeat_349_map_line.py
--rw-r--r--  2.0 unx    27109 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/models/mod349.py
--rw-r--r--  2.0 unx      676 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx     2809 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      192 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/readme/ROADMAP.rst
--rw-r--r--  2.0 unx      774 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/readme/USAGE.rst
--rw-r--r--  2.0 unx     2179 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/report/aeat_mod349.xml
--rw-r--r--  2.0 unx     7805 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/report/common_templates.xml
--rw-r--r--  2.0 unx      526 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/report/report_views.xml
--rw-r--r--  2.0 unx     2725 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/security/ir.model.access.csv
--rw-r--r--  2.0 unx      427 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/security/mod_349_security.xml
--rw-r--r--  2.0 unx     5745 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/static/description/icon.png
--rw-r--r--  2.0 unx     3760 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/static/description/icon_source.svg
--rw-r--r--  2.0 unx    18388 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/static/description/index.html
--rw-r--r--  2.0 unx      105 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/tests/__init__.py
--rw-r--r--  2.0 unx    16302 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py
--rw-r--r--  2.0 unx     1372 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/views/account_move_view.xml
--rw-r--r--  2.0 unx      539 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/views/account_tax_view.xml
--rw-r--r--  2.0 unx      959 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/views/aeat_349_map_view.xml
--rw-r--r--  2.0 unx    12715 b- defN 24-Apr-20 05:03 odoo/addons/l10n_es_aeat_mod349/views/mod349_view.xml
--rw-r--r--  2.0 unx     8130 b- defN 24-Apr-20 05:05 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-20 05:05 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 24-Apr-20 05:05 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4479 b- defN 24-Apr-20 05:05 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/RECORD
-40 files, 1327994 bytes uncompressed, 778660 bytes compressed:  41.4%
+Zip file size: 786559 bytes, number of entries: 40
+-rw-r--r--  2.0 unx     7550 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/README.rst
+-rw-r--r--  2.0 unx       87 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/__init__.py
+-rw-r--r--  2.0 unx     1436 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/__manifest__.py
+-rw-r--r--  2.0 unx     2283 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/data/aeat_349_map_data.xml
+-rw-r--r--  2.0 unx    14209 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_data.xml
+-rw-r--r--  2.0 unx     6272 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_partner_data.xml
+-rw-r--r--  2.0 unx     9323 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_partner_refund_data.xml
+-rw-r--r--  2.0 unx   994088 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/docs/BOE-A-2010-5098.pdf
+-rw-r--r--  2.0 unx    45003 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/docs/NREG-349-2016.docx
+-rw-r--r--  2.0 unx    43516 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/i18n/ca.po
+-rw-r--r--  2.0 unx    43247 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/i18n/es.po
+-rw-r--r--  2.0 unx    38506 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/i18n/l10n_es_aeat_mod349.pot
+-rw-r--r--  2.0 unx      207 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/models/__init__.py
+-rw-r--r--  2.0 unx     1858 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/models/account_move.py
+-rw-r--r--  2.0 unx     1144 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/models/account_tax.py
+-rw-r--r--  2.0 unx      416 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/models/account_tax_template.py
+-rw-r--r--  2.0 unx     1099 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/models/aeat_349_map_line.py
+-rw-r--r--  2.0 unx    27889 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/models/mod349.py
+-rw-r--r--  2.0 unx      739 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx     2809 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      192 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx      774 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/readme/USAGE.rst
+-rw-r--r--  2.0 unx     2179 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/report/aeat_mod349.xml
+-rw-r--r--  2.0 unx     7805 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/report/common_templates.xml
+-rw-r--r--  2.0 unx      526 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/report/report_views.xml
+-rw-r--r--  2.0 unx     2725 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/security/ir.model.access.csv
+-rw-r--r--  2.0 unx      427 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/security/mod_349_security.xml
+-rw-r--r--  2.0 unx     5745 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/static/description/icon.png
+-rw-r--r--  2.0 unx     3760 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/static/description/icon_source.svg
+-rw-r--r--  2.0 unx    18551 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/static/description/index.html
+-rw-r--r--  2.0 unx      105 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/tests/__init__.py
+-rw-r--r--  2.0 unx    17100 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py
+-rw-r--r--  2.0 unx     1372 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/views/account_move_view.xml
+-rw-r--r--  2.0 unx      539 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/views/account_tax_view.xml
+-rw-r--r--  2.0 unx      959 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/views/aeat_349_map_view.xml
+-rw-r--r--  2.0 unx    12715 b- defN 24-May-13 19:08 odoo/addons/l10n_es_aeat_mod349/views/mod349_view.xml
+-rw-r--r--  2.0 unx     8191 b- defN 24-May-13 19:08 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-13 19:08 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 24-May-13 19:08 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4471 b- defN 24-May-13 19:08 odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/RECORD
+40 files, 1329914 bytes uncompressed, 778995 bytes compressed:  41.4%
```

## zipnote {}

```diff
@@ -102,20 +102,20 @@
 
 Filename: odoo/addons/l10n_es_aeat_mod349/views/aeat_349_map_view.xml
 Comment: 
 
 Filename: odoo/addons/l10n_es_aeat_mod349/views/mod349_view.xml
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/METADATA
+Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/WHEEL
+Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/top_level.txt
+Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/RECORD
+Filename: odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_es_aeat_mod349/README.rst

```diff
@@ -3,15 +3,15 @@
 ===============
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:e46cc444b5a379d32b0c91bf0863e16a802f96a879d3ceeb8c75a6497bc0bc0f
+   !! source digest: sha256:afcf0458fa11cc81bd00037f9ee9a8d9552b79f53d977a6348aadb0bd6aa6563
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Mature-brightgreen.png
     :target: https://odoo-community.org/page/development-status
     :alt: Mature
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
@@ -164,14 +164,15 @@
   * Manuel Regidor
 
 * Jairo Llopis (Moduon)
 
 * `Factor Libre <https://factorlibre.com>`_:
 
     * Luis J. Salvatierra <luis.salvatierra@factorlibre.com>
+    * Alejandro Ji Cheung <alejandro.jicheung@factorlibre.com>
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
```

## odoo/addons/l10n_es_aeat_mod349/__manifest__.py

```diff
@@ -5,15 +5,15 @@
 # Copyright 2017 ForgeFlow <contact@forgeflow.com>
 # Copyright 2018 Tecnativa - Carlos Dauden
 # Copyright 2014-2023 Tecnativa - Pedro M. Baeza
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
 {
     "name": "AEAT modelo 349",
-    "version": "16.0.1.3.0",
+    "version": "16.0.1.3.1",
     "author": "Tecnativa, ForgeFlow, Odoo Community Association (OCA)",
     "license": "AGPL-3",
     "category": "Localisation/Accounting",
     "website": "https://github.com/OCA/l10n-spain",
     "depends": ["l10n_es_aeat", "l10n_es"],
     "data": [
         "data/aeat_349_map_data.xml",
```

## odoo/addons/l10n_es_aeat_mod349/models/mod349.py

```diff
@@ -432,17 +432,32 @@
     _rec_name = "partner_vat"
 
     def _selection_operation_key(self):
         return self.env["account.move.line"].fields_get(
             allfields=["l10n_es_aeat_349_operation_key"],
         )["l10n_es_aeat_349_operation_key"]["selection"]
 
+    def _get_and_assign_country_code(self, record):
+        # Get country code from partner in a first place
+        country_code = record.partner_id._parse_aeat_vat_info()[0]
+
+        # Map country code with _map_aeat_country_code
+        # and then to ISO code with _map_aeat_country_iso_code
+        country_code = record.partner_id._map_aeat_country_code(country_code)
+        country = self.env["res.country"].search([("code", "=", country_code)])
+        country_code = record.partner_id._map_aeat_country_iso_code(country)
+
+        # If country code is found, and it's not in the VAT, assign it
+        if country_code and not record.partner_vat.startswith(country_code):
+            vat_number = record.partner_id._parse_aeat_vat_info()[-1]
+            record.partner_vat = country_code + vat_number
+        return country_code
+
     def _process_vat(self, record, errors):
-        partner_vat = record.partner_vat
-        country_code = "".join(c for c in partner_vat[0:2] if not c.isnumeric())
+        country_code = self._get_and_assign_country_code(record)
         if not country_code:
             errors.append(_("VAT without country code"))
         elif country_code not in record.partner_id._get_aeat_europe_codes():
             europe = self.env.ref("base.europe", raise_if_not_found=False)
             map_european_codes = [
                 record.partner_id._map_aeat_country_iso_code(c)
                 for c in europe.country_ids
```

## odoo/addons/l10n_es_aeat_mod349/readme/CONTRIBUTORS.rst

```diff
@@ -25,7 +25,8 @@
   * Manuel Regidor
 
 * Jairo Llopis (Moduon)
 
 * `Factor Libre <https://factorlibre.com>`_:
 
     * Luis J. Salvatierra <luis.salvatierra@factorlibre.com>
+    * Alejandro Ji Cheung <alejandro.jicheung@factorlibre.com>
```

## odoo/addons/l10n_es_aeat_mod349/static/description/index.html

```diff
@@ -362,15 +362,15 @@
 <div class="document" id="aeat-modelo-349">
 <h1 class="title">AEAT modelo 349</h1>
 
 <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 !! This file is generated by oca-gen-addon-readme !!
 !! changes will be overwritten.                   !!
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-!! source digest: sha256:e46cc444b5a379d32b0c91bf0863e16a802f96a879d3ceeb8c75a6497bc0bc0f
+!! source digest: sha256:afcf0458fa11cc81bd00037f9ee9a8d9552b79f53d977a6348aadb0bd6aa6563
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
 <p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Mature" src="https://img.shields.io/badge/maturity-Mature-brightgreen.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/l10n-spain/tree/16.0/l10n_es_aeat_mod349"><img alt="OCA/l10n-spain" src="https://img.shields.io/badge/github-OCA%2Fl10n--spain-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/l10n-spain-16-0/l10n-spain-16-0-l10n_es_aeat_mod349"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&amp;target_branch=16.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
 <p>Módulo para la presentación del Modelo AEAT 349 (Declaración Recapitulativa de
 Operaciones Intracomunitarias)</p>
 <p>Basado en la Orden EHA/769/2010 por el que se aprueban los diseños físicos y
 lógicos del 349.</p>
 <p>De acuerdo con la normativa de la Hacienda Española, están obligados a
@@ -525,14 +525,15 @@
 </li>
 <li><p class="first">Jairo Llopis (Moduon)</p>
 </li>
 <li><p class="first"><a class="reference external" href="https://factorlibre.com">Factor Libre</a>:</p>
 <blockquote>
 <ul class="simple">
 <li>Luis J. Salvatierra &lt;<a class="reference external" href="mailto:luis.salvatierra&#64;factorlibre.com">luis.salvatierra&#64;factorlibre.com</a>&gt;</li>
+<li>Alejandro Ji Cheung &lt;<a class="reference external" href="mailto:alejandro.jicheung&#64;factorlibre.com">alejandro.jicheung&#64;factorlibre.com</a>&gt;</li>
 </ul>
 </blockquote>
 </li>
 </ul>
 </div>
 <div class="section" id="maintainers">
 <h2><a class="toc-backref" href="#toc-entry-7">Maintainers</a></h2>
```

### html2text {}

```diff
@@ -106,14 +106,15 @@
           o Ignacio Ibeas
     * _S_y_g_e_l:
           o Valentin Vinagre
           o Manuel Regidor
     * Jairo Llopis (Moduon)
     * _F_a_c_t_o_r_ _L_i_b_r_e:
                o Luis J. Salvatierra <_l_u_i_s_._s_a_l_v_a_t_i_e_r_r_a_@_f_a_c_t_o_r_l_i_b_r_e_._c_o_m>
+               o Alejandro Ji Cheung <_a_l_e_j_a_n_d_r_o_._j_i_c_h_e_u_n_g_@_f_a_c_t_o_r_l_i_b_r_e_._c_o_m>
 ********** _MM_aa_ii_nn_tt_aa_ii_nn_ee_rr_ss **********
 This module is maintained by the OCA.
 _[_O_d_o_o_ _C_o_m_m_u_n_i_t_y_ _A_s_s_o_c_i_a_t_i_o_n_]
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 Current _m_a_i_n_t_a_i_n_e_r:
```

## odoo/addons/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py

```diff
@@ -384,14 +384,34 @@
         expected_notes = [
             _("Without Country"),
             _("VAT without country code"),
         ]
         for expected_note in expected_notes:
             self.assertIn(expected_note, partner_record.error_text)
 
+        # No country code in vat and BE country
+        self.customer.write(
+            {"vat": "0477472701", "country_id": self.env.ref("base.be").id}
+        )
+        model349_errors.button_recalculate()
+        partner_record = model349_errors.partner_record_ids.filtered(
+            lambda x: x.partner_vat == "BE0477472701"
+        )
+        self.assertTrue(partner_record.partner_record_ok)
+
+        # No country code in vat and GR country
+        self.customer.write(
+            {"vat": "12345670", "country_id": self.env.ref("base.gr").id}
+        )
+        model349_errors.button_recalculate()
+        partner_record = model349_errors.partner_record_ids.filtered(
+            lambda x: x.partner_vat == "EL12345670"
+        )
+        self.assertTrue(partner_record.partner_record_ok)
+
         # Reset vat and country
         self.customer.write(
             {"vat": "BE0411905847", "country_id": self.env.ref("base.be").id}
         )
         model349_errors.button_recalculate()
         partner_record = model349_errors.partner_record_ids.filtered(
             lambda x: x.partner_vat == self.customer.vat
```

## Comparing `odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/METADATA` & `odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-l10n-es-aeat-mod349
-Version: 16.0.1.3.0.1
+Version: 16.0.1.3.1
 Summary: AEAT modelo 349
 Home-page: https://github.com/OCA/l10n-spain
 Author: Tecnativa, ForgeFlow, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -21,15 +21,15 @@
 ===============
 
 .. 
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
    !! changes will be overwritten.                   !!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
-   !! source digest: sha256:e46cc444b5a379d32b0c91bf0863e16a802f96a879d3ceeb8c75a6497bc0bc0f
+   !! source digest: sha256:afcf0458fa11cc81bd00037f9ee9a8d9552b79f53d977a6348aadb0bd6aa6563
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 
 .. |badge1| image:: https://img.shields.io/badge/maturity-Mature-brightgreen.png
     :target: https://odoo-community.org/page/development-status
     :alt: Mature
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
@@ -182,14 +182,15 @@
   * Manuel Regidor
 
 * Jairo Llopis (Moduon)
 
 * `Factor Libre <https://factorlibre.com>`_:
 
     * Luis J. Salvatierra <luis.salvatierra@factorlibre.com>
+    * Alejandro Ji Cheung <alejandro.jicheung@factorlibre.com>
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
```

## Comparing `odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/RECORD` & `odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,40 +1,40 @@
-odoo/addons/l10n_es_aeat_mod349/README.rst,sha256=4wSu_o7Swuya1k_Ul_kKM_k43tVN1tsABOsDnrujjBc,7487
+odoo/addons/l10n_es_aeat_mod349/README.rst,sha256=ViEhvwBRZQEnd4hP0OPHtWP7bCzjniJWnFYuWiNlDt8,7550
 odoo/addons/l10n_es_aeat_mod349/__init__.py,sha256=eShEGRadAlxopoLqIQ4-N42FM7MWPSuBe0h_l1cXTPM,87
-odoo/addons/l10n_es_aeat_mod349/__manifest__.py,sha256=SspksFjix8KZ23HEeYTJhs4-i1fZXsuRFKb7cxWhHLg,1436
+odoo/addons/l10n_es_aeat_mod349/__manifest__.py,sha256=0P-Q5J8z0A2221ltOdCmCHvsTgLPSAobNg8Y2Hq3XvM,1436
 odoo/addons/l10n_es_aeat_mod349/data/aeat_349_map_data.xml,sha256=Vite2Tx3yi8d7TEo98YZK9jcr_kDmxujI4PqZevbd7Y,2283
 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_data.xml,sha256=4EBNi7LpufTnnjSX1PtkG7bzBu6jsMb4oFhxdbmPr7w,14209
 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_partner_data.xml,sha256=BczO0NnnY_SPwYttQOK5Z6JjzVCF3aMiXDEy43LLZq0,6272
 odoo/addons/l10n_es_aeat_mod349/data/aeat_export_mod349_partner_refund_data.xml,sha256=LoTDL1gZuAI9TtZ0f72knaPCggEgCWEFhq64sv53I1U,9323
 odoo/addons/l10n_es_aeat_mod349/docs/BOE-A-2010-5098.pdf,sha256=yLr-NRpDyQ4NBopJ7Hu9xczwD1JWSFDrNIAF6ZEs7ao,994088
 odoo/addons/l10n_es_aeat_mod349/docs/NREG-349-2016.docx,sha256=ueEaGbJDT2rKEz0lv2Oq1LqBDpqW_sx90l4zytt9Ei4,45003
 odoo/addons/l10n_es_aeat_mod349/i18n/ca.po,sha256=nzW6fI2dkKu789kJ0b1STTOx-7hd95RrXsaAGh3Z4t4,43516
 odoo/addons/l10n_es_aeat_mod349/i18n/es.po,sha256=QSaZ5Zk7bFmlqFuLdElkNU6gqDO7jOevQmuUE68Y20U,43247
 odoo/addons/l10n_es_aeat_mod349/i18n/l10n_es_aeat_mod349.pot,sha256=O4zW39hSzgGjZyZogXAJ86_S_Lu6eywpIUYoQZZdm2Y,38506
 odoo/addons/l10n_es_aeat_mod349/models/__init__.py,sha256=Wq7ilnGiFbCxNjho0Xmwa4KssrgG9WxPlTydEqK9IqY,207
 odoo/addons/l10n_es_aeat_mod349/models/account_move.py,sha256=ky7jK5x5fvasAdPJKBpMe2vhzPaiAJtdJbEfCqYT5rY,1858
 odoo/addons/l10n_es_aeat_mod349/models/account_tax.py,sha256=NcflXgDnQkv4vNsWBNiKDs1xJkQfq9OrX7VOQU22U1I,1144
 odoo/addons/l10n_es_aeat_mod349/models/account_tax_template.py,sha256=mpxP90vEv2r636CY-Ce-6AbWrjsyNn_oFyphbLv6Xc0,416
 odoo/addons/l10n_es_aeat_mod349/models/aeat_349_map_line.py,sha256=IwvrQRwezxQTOv_baGS1BK9EKsKuQiItNUht2LOlryA,1099
-odoo/addons/l10n_es_aeat_mod349/models/mod349.py,sha256=dN9Dzjzhb1z90yrlDdbAh0axb45hTuLIdtU86TPSOsE,27109
-odoo/addons/l10n_es_aeat_mod349/readme/CONTRIBUTORS.rst,sha256=_D9hpqaugzqZzdOfWADAWI0FA5dVBf8Fqoe4K8XlcdE,676
+odoo/addons/l10n_es_aeat_mod349/models/mod349.py,sha256=y8CGdf4m_LMWcmQY4fOefdPXiHLNjt8RJ8i-IfPidQ0,27889
+odoo/addons/l10n_es_aeat_mod349/readme/CONTRIBUTORS.rst,sha256=dssQFJeqSyF2PhLHHxbEHb9KYn8ZQ7jmNNOAM311AGA,739
 odoo/addons/l10n_es_aeat_mod349/readme/DESCRIPTION.rst,sha256=9lrRF5UZqDAcbvR4L3vCEMbjPQBKH8Q9gwu3f33D8LM,2809
 odoo/addons/l10n_es_aeat_mod349/readme/ROADMAP.rst,sha256=z84ACi7OKuj_t7SGFwkW4rZ6ys1FvfPMG5jip0KwNlI,192
 odoo/addons/l10n_es_aeat_mod349/readme/USAGE.rst,sha256=NJ8MJYfINC9L2wYAdtvBDXP8HgQuF660clqEpyMG5GA,774
 odoo/addons/l10n_es_aeat_mod349/report/aeat_mod349.xml,sha256=UmVzYIndtP7n8f90r69DSfD1xYvtXqQZzqv3Cwv2pUg,2179
 odoo/addons/l10n_es_aeat_mod349/report/common_templates.xml,sha256=GL40ypsQe9jsWFlNBEPgEnOxDLXp0UoN9mFmYwgSTEI,7805
 odoo/addons/l10n_es_aeat_mod349/report/report_views.xml,sha256=JaUO0--EKNWXC3DlAtHue2M89xybyz3jVNaEheVBorE,526
 odoo/addons/l10n_es_aeat_mod349/security/ir.model.access.csv,sha256=jyQ2PJFL1ju3EmPVr4Ny8EJOEybUgB1Ar3YXCzcqMdk,2725
 odoo/addons/l10n_es_aeat_mod349/security/mod_349_security.xml,sha256=8oXQBQ36aDAR5j-st-0QZ8OZfI9cBKsuuyYUrN1T-LY,427
 odoo/addons/l10n_es_aeat_mod349/static/description/icon.png,sha256=Ks4WNDdAcSU3mb1_AlLjFeYmX-N3ncAYMZH5XwqQsVg,5745
 odoo/addons/l10n_es_aeat_mod349/static/description/icon_source.svg,sha256=5fpwbG4u0XJRcl_v0OiNKL9rogCVX3ybZqswVKsKTI8,3760
-odoo/addons/l10n_es_aeat_mod349/static/description/index.html,sha256=RA81GCsveM4g0skR-Cyj6TfGeEuHUe_-A8P94UYcm_0,18388
+odoo/addons/l10n_es_aeat_mod349/static/description/index.html,sha256=pSbnVza2fzGF1E-ecVIq9nyoOajNv7ljE0m0lqKCPmM,18551
 odoo/addons/l10n_es_aeat_mod349/tests/__init__.py,sha256=ZZA6TFr2rJsko9v325v8s2g1Q-e-2vFIgBFjoBqu2q4,105
-odoo/addons/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py,sha256=OnszixajWABFkaJkMDqHGmt2ltyvFywHPRAuR6guVKc,16302
+odoo/addons/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py,sha256=uX3cdhX6W2IPWmgEVE9Zw9bxV7PdWhBQlGHMPMsgwQM,17100
 odoo/addons/l10n_es_aeat_mod349/views/account_move_view.xml,sha256=rRAZAJlyeZHMAlGvAAO8MuKY22i13jlh4WIY8acbqUU,1372
 odoo/addons/l10n_es_aeat_mod349/views/account_tax_view.xml,sha256=CQbnxiXV4g_qjq0_x_5KIu4hf43TTMF9nvD8D1KZBdc,539
 odoo/addons/l10n_es_aeat_mod349/views/aeat_349_map_view.xml,sha256=sbgg9jBlaTzZKxWhmIQ3XG0Qc8rsnX-xDIWmn8lCdgU,959
 odoo/addons/l10n_es_aeat_mod349/views/mod349_view.xml,sha256=Ig9FznhxAF2RYhAiajSqeA-FGDl2Tgv773SiLE0iYIk,12715
-odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/METADATA,sha256=wP5g5cGWrd-CgBE5LCRxOmhPha7BrQwfvACGmoanArw,8130
-odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_l10n_es_aeat_mod349-16.0.1.3.0.1.dist-info/RECORD,,
+odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/METADATA,sha256=u2R0OAqeolh9Uf4S2jrnkNMYi4qL9l_3pkj0sGk0gcA,8191
+odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_l10n_es_aeat_mod349-16.0.1.3.1.dist-info/RECORD,,
```

