# Comparing `tmp/assemblyline_client-4.9.0-py2.py3-none-any.whl.zip` & `tmp/assemblyline_client-4.9.1-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,48 +1,48 @@
-Zip file size: 64468 bytes, number of entries: 46
--rw-r--r--  2.0 unx     9142 b- defN 24-Apr-23 12:52 assemblyline_client/__init__.py
--rw-r--r--  2.0 unx    19173 b- defN 24-Apr-23 12:52 assemblyline_client/submit.py
--rw-r--r--  2.0 unx        0 b- defN 24-Apr-23 12:52 assemblyline_client/common/__init__.py
--rw-r--r--  2.0 unx    36464 b- defN 24-Apr-23 12:52 assemblyline_client/common/classification.py
--rw-r--r--  2.0 unx    37699 b- defN 24-Apr-23 12:52 assemblyline_client/v3_client/__init__.py
--rw-r--r--  2.0 unx     7565 b- defN 24-Apr-23 12:52 assemblyline_client/v3_client/utils.py
--rw-r--r--  2.0 unx        0 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/__init__.py
--rw-r--r--  2.0 unx     3635 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/client.py
--rw-r--r--  2.0 unx        0 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/common/__init__.py
--rw-r--r--  2.0 unx    12042 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/common/submit_utils.py
--rw-r--r--  2.0 unx     3658 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/common/utils.py
--rw-r--r--  2.0 unx        0 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/__init__.py
--rw-r--r--  2.0 unx    12503 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/alert.py
--rw-r--r--  2.0 unx     2791 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/badlist.py
--rw-r--r--  2.0 unx     2343 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/bundle.py
--rw-r--r--  2.0 unx     1275 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/error.py
--rw-r--r--  2.0 unx     3258 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/file.py
--rw-r--r--  2.0 unx      990 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/hash_search.py
--rw-r--r--  2.0 unx     1093 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/help.py
--rw-r--r--  2.0 unx      567 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/heuristics.py
--rw-r--r--  2.0 unx     4346 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/ingest.py
--rw-r--r--  2.0 unx     5374 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/ontology.py
--rw-r--r--  2.0 unx     3286 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/replay.py
--rw-r--r--  2.0 unx     1196 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/result.py
--rw-r--r--  2.0 unx     2271 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/safelist.py
--rw-r--r--  2.0 unx     4120 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/service.py
--rw-r--r--  2.0 unx     5390 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/signature.py
--rw-r--r--  2.0 unx    11193 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/socketio.py
--rw-r--r--  2.0 unx     5790 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/submission.py
--rw-r--r--  2.0 unx     3556 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/submit.py
--rw-r--r--  2.0 unx     1278 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/system.py
--rw-r--r--  2.0 unx     5324 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/user.py
--rw-r--r--  2.0 unx     1810 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/workflow.py
--rw-r--r--  2.0 unx    10420 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/__init__.py
--rw-r--r--  2.0 unx     5172 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/facet.py
--rw-r--r--  2.0 unx     1513 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/fields.py
--rw-r--r--  2.0 unx     9670 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/grouped.py
--rw-r--r--  2.0 unx     7535 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/histogram.py
--rw-r--r--  2.0 unx     4415 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/stats.py
--rw-r--r--  2.0 unx     5778 b- defN 24-Apr-23 12:52 assemblyline_client/v4_client/module/search/stream.py
--rw-r--r--  2.0 unx     1396 b- defN 24-Apr-23 12:52 assemblyline_client-4.9.0.dist-info/LICENCE.md
--rw-r--r--  2.0 unx     1726 b- defN 24-Apr-23 12:52 assemblyline_client-4.9.0.dist-info/METADATA
--rw-r--r--  2.0 unx      110 b- defN 24-Apr-23 12:52 assemblyline_client-4.9.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       62 b- defN 24-Apr-23 12:52 assemblyline_client-4.9.0.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       20 b- defN 24-Apr-23 12:52 assemblyline_client-4.9.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4683 b- defN 24-Apr-23 12:52 assemblyline_client-4.9.0.dist-info/RECORD
-46 files, 261632 bytes uncompressed, 56696 bytes compressed:  78.3%
+Zip file size: 65156 bytes, number of entries: 46
+-rw-r--r--  2.0 unx    10752 b- defN 24-May-13 19:57 assemblyline_client/__init__.py
+-rw-r--r--  2.0 unx    19173 b- defN 24-May-13 19:57 assemblyline_client/submit.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-13 19:57 assemblyline_client/common/__init__.py
+-rw-r--r--  2.0 unx    36464 b- defN 24-May-13 19:57 assemblyline_client/common/classification.py
+-rw-r--r--  2.0 unx    37699 b- defN 24-May-13 19:57 assemblyline_client/v3_client/__init__.py
+-rw-r--r--  2.0 unx     7565 b- defN 24-May-13 19:57 assemblyline_client/v3_client/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-13 19:57 assemblyline_client/v4_client/__init__.py
+-rw-r--r--  2.0 unx     4546 b- defN 24-May-13 19:57 assemblyline_client/v4_client/client.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-13 19:57 assemblyline_client/v4_client/common/__init__.py
+-rw-r--r--  2.0 unx    12042 b- defN 24-May-13 19:57 assemblyline_client/v4_client/common/submit_utils.py
+-rw-r--r--  2.0 unx     3669 b- defN 24-May-13 19:57 assemblyline_client/v4_client/common/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/__init__.py
+-rw-r--r--  2.0 unx    12503 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/alert.py
+-rw-r--r--  2.0 unx     2791 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/badlist.py
+-rw-r--r--  2.0 unx     2343 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/bundle.py
+-rw-r--r--  2.0 unx     1275 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/error.py
+-rw-r--r--  2.0 unx     3258 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/file.py
+-rw-r--r--  2.0 unx      990 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/hash_search.py
+-rw-r--r--  2.0 unx     1093 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/help.py
+-rw-r--r--  2.0 unx      567 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/heuristics.py
+-rw-r--r--  2.0 unx     4346 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/ingest.py
+-rw-r--r--  2.0 unx     5374 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/ontology.py
+-rw-r--r--  2.0 unx     3286 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/replay.py
+-rw-r--r--  2.0 unx     1196 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/result.py
+-rw-r--r--  2.0 unx     2271 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/safelist.py
+-rw-r--r--  2.0 unx     4120 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/service.py
+-rw-r--r--  2.0 unx     5390 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/signature.py
+-rw-r--r--  2.0 unx    11193 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/socketio.py
+-rw-r--r--  2.0 unx     5790 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/submission.py
+-rw-r--r--  2.0 unx     3556 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/submit.py
+-rw-r--r--  2.0 unx     1278 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/system.py
+-rw-r--r--  2.0 unx     5665 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/user.py
+-rw-r--r--  2.0 unx     1810 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/workflow.py
+-rw-r--r--  2.0 unx    11461 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/__init__.py
+-rw-r--r--  2.0 unx     6532 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/facet.py
+-rw-r--r--  2.0 unx     1648 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/fields.py
+-rw-r--r--  2.0 unx    11609 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/grouped.py
+-rw-r--r--  2.0 unx     9218 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/histogram.py
+-rw-r--r--  2.0 unx     5654 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/stats.py
+-rw-r--r--  2.0 unx     6241 b- defN 24-May-13 19:57 assemblyline_client/v4_client/module/search/stream.py
+-rw-r--r--  2.0 unx     1396 b- defN 24-May-13 19:57 assemblyline_client-4.9.1.dist-info/LICENCE.md
+-rw-r--r--  2.0 unx     1726 b- defN 24-May-13 19:57 assemblyline_client-4.9.1.dist-info/METADATA
+-rw-r--r--  2.0 unx      110 b- defN 24-May-13 19:57 assemblyline_client-4.9.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       62 b- defN 24-May-13 19:57 assemblyline_client-4.9.1.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       20 b- defN 24-May-13 19:57 assemblyline_client-4.9.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4685 b- defN 24-May-13 19:57 assemblyline_client-4.9.1.dist-info/RECORD
+46 files, 272367 bytes uncompressed, 57384 bytes compressed:  78.9%
```

## zipnote {}

```diff
@@ -114,26 +114,26 @@
 
 Filename: assemblyline_client/v4_client/module/search/stats.py
 Comment: 
 
 Filename: assemblyline_client/v4_client/module/search/stream.py
 Comment: 
 
-Filename: assemblyline_client-4.9.0.dist-info/LICENCE.md
+Filename: assemblyline_client-4.9.1.dist-info/LICENCE.md
 Comment: 
 
-Filename: assemblyline_client-4.9.0.dist-info/METADATA
+Filename: assemblyline_client-4.9.1.dist-info/METADATA
 Comment: 
 
-Filename: assemblyline_client-4.9.0.dist-info/WHEEL
+Filename: assemblyline_client-4.9.1.dist-info/WHEEL
 Comment: 
 
-Filename: assemblyline_client-4.9.0.dist-info/entry_points.txt
+Filename: assemblyline_client-4.9.1.dist-info/entry_points.txt
 Comment: 
 
-Filename: assemblyline_client-4.9.0.dist-info/top_level.txt
+Filename: assemblyline_client-4.9.1.dist-info/top_level.txt
 Comment: 
 
-Filename: assemblyline_client-4.9.0.dist-info/RECORD
+Filename: assemblyline_client-4.9.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## assemblyline_client/__init__.py

```diff
@@ -1,18 +1,17 @@
 import json
-from base64 import b64encode
-
 import requests
 import time
 import warnings
 
-from assemblyline_client.v4_client.common.utils import ClientError
+from base64 import b64encode
 
 from assemblyline_client.v3_client import Client as Client3
 from assemblyline_client.v4_client.client import Client as Client4
+from assemblyline_client.v4_client.common.utils import ClientError
 
 try:
     from importlib import metadata
     __version__ = metadata.distribution('assemblyline_client').version
 except metadata.PackageNotFoundError:
     __version__ = "4.0.0.dev0"
 
@@ -51,14 +50,17 @@
         self.debug = debug
         self.is_v4 = False
         self.max_retries = retries
         self.server = server
         self.silence_warnings = silence_warnings
         self.verify = verify
         self.default_timeout = timeout
+        self.remaining_api_quota = None
+        self.remaining_submission_quota = None
+        self.current_user = None
 
         session = requests.Session()
 
         session.headers.update({'content-type': 'application/json'})
         session.verify = verify
 
         if cert:
@@ -101,24 +103,27 @@
             if ce.status_code == 404:
                 self.is_v4 = True
             else:
                 raise
 
         if self.is_v4:
             if self.apikey and len(self.apikey) == 2:
+                self.current_user = self.apikey[0]
                 auth = {
                     'user': self.apikey[0],
                     'apikey': self.apikey[1]
                 }
             elif self.auth and len(self.auth) == 2:
+                self.current_user = self.auth[0]
                 auth = {
                     'user': self.auth[0],
                     'password': self.auth[1]
                 }
             elif self.oauth and len(self.oauth) == 2:
+                self.current_user = self.oauth[0]
                 auth = {
                     "oauth_provider": self.oauth[0],
                     "oauth_token": self.oauth[1]
                 }
             else:
                 auth = {}
             return self.request(self.session.post, "api/v4/auth/login/", convert_api_output, data=json.dumps(auth))
@@ -126,25 +131,27 @@
             if self.apikey and len(self.apikey) == 2:
                 if public_key:
                     key = b64encode(public_key.encrypt(self.apikey[1].encode("UTF-8")))
                     if isinstance(key, bytes) and not isinstance(key, str):
                         key = key.decode("UTF-8")
                 else:
                     key = self.apikey[1]
+                self.current_user = self.apikey[0]
                 auth = {
                     'user': self.apikey[0],
                     'apikey': key
                 }
             elif self.auth and len(self.auth) == 2:
                 if public_key:
                     pw = b64encode(public_key.encrypt(self.auth[1].encode("UTF-8")))
                     if isinstance(pw, bytes) and not isinstance(pw, str):
                         pw = pw.decode("UTF-8")
                 else:
                     pw = self.auth[1]
+                self.current_user = self.auth[0]
                 auth = {
                     'user': self.auth[0],
                     'password': pw
                 }
             else:
                 auth = {}
             return self.request(self.session.get, "api/v3/auth/login/", convert_api_output, data=json.dumps(auth))
@@ -181,14 +188,23 @@
                     if stream and 'seek' in dir(stream):
                         stream.seek(0)
 
                 try:
                     response = func('/'.join((self.server, path)), **kw)
                     if 'XSRF-TOKEN' in response.cookies:
                         self.session.headers.update({'X-XSRF-TOKEN': response.cookies['XSRF-TOKEN']})
+
+                    # Load remaining quotas if present
+                    apiQuota = response.headers.get('X-Remaining-Quota-Api')
+                    if apiQuota is not None:
+                        self.remaining_api_quota = int(apiQuota)
+                    submissionQuota = response.headers.get('X-Remaining-Quota-Submission')
+                    if submissionQuota is not None:
+                        self.remaining_submission_quota = int(submissionQuota)
+
                     if response.ok:
                         return process(response)
                     elif response.status_code == 401:
                         try:
                             resp_data = response.json()
                             if resp_data["api_error_message"] in ["Session rejected",
                                                                   "Session not found",
@@ -202,15 +218,28 @@
                                                   api_response=resp_data["api_response"])
                         except Exception as e:
                             if isinstance(e, ClientError):
                                 raise
 
                             raise ClientError(response.content, response.status_code)
 
-                    elif response.status_code not in (502, 503, 504):
+                    elif response.status_code == 503:
+                        try:
+                            resp_data = response.json()
+                            if 'quota' in resp_data["api_error_message"] and 'daily' in resp_data["api_error_message"]:
+                                raise ClientError(resp_data["api_error_message"], response.status_code,
+                                                  api_version=resp_data["api_server_version"],
+                                                  api_response=resp_data["api_response"])
+                        except Exception as e:
+                            if isinstance(e, ClientError):
+                                raise
+
+                            raise ClientError(response.content, response.status_code)
+
+                    elif response.status_code not in (502, 504):
                         try:
                             resp_data = response.json()
                             raise ClientError(resp_data["api_error_message"], response.status_code,
                                               api_version=resp_data["api_server_version"],
                                               api_response=resp_data["api_response"])
                         except Exception as e:
                             if isinstance(e, ClientError):
```

## assemblyline_client/v4_client/client.py

```diff
@@ -1,10 +1,10 @@
 
 from assemblyline_client.common.classification import Classification
-from assemblyline_client.v4_client.common.utils import walk_api_path
+from assemblyline_client.v4_client.common.utils import ClientError, walk_api_path
 from assemblyline_client.v4_client.module.alert import Alert
 from assemblyline_client.v4_client.module.badlist import Badlist
 from assemblyline_client.v4_client.module.bundle import Bundle
 from assemblyline_client.v4_client.module.error import Error
 from assemblyline_client.v4_client.module.file import File
 from assemblyline_client.v4_client.module.hash_search import HashSearch
 from assemblyline_client.v4_client.module.help import Help
@@ -55,14 +55,40 @@
 
         paths = []
         walk_api_path(self, [''], paths)
 
         self.__doc__ = 'Client provides the following methods:\n\n' + \
             '\n'.join(['\n'.join(p + ['']) for p in paths])
 
+    def _load_quotas(self):
+        try:
+            resp = self.user.quotas(self._connection.current_user)
+            self._connection.remaining_api_quota = resp['daily_api']
+            self._connection.remaining_submission_quota = resp['daily_submission']
+        except ClientError:
+            pass
+
+    @property
+    def current_user(self):
+        return self._connection.current_user
+
+    def get_remaining_api_quota(self):
+        if self._connection.remaining_api_quota is not None:
+            return self._connection.remaining_api_quota
+
+        self._load_quotas()
+        return self._connection.remaining_api_quota
+
+    def get_remaining_submission_quota(self):
+        if self._connection.remaining_submission_quota is not None:
+            return self._connection.remaining_submission_quota
+
+        self._load_quotas()
+        return self._connection.remaining_submission_quota
+
     def get_classification_engine(self):
         definition = self.help.classification_definition(original=True)
         return Classification(definition)
 
     def set_obo_token(self, token, provider=None):
         new_headers = {'authorization': f"Bearer {token}"}
         if provider:
```

## assemblyline_client/v4_client/common/utils.py

```diff
@@ -8,15 +8,15 @@
 try:
     from urllib.parse import quote
 except ImportError:
     from urllib import quote
 
 
 INVALID_STREAM_SEARCH_PARAMS = ('deep_paging_id', 'rows', 'sort')
-SEARCHABLE = ('alert', 'file', 'heuristic', 'result', 'safelist', 'signature', 'submission', 'workflow')
+SEARCHABLE = ('alert', 'badlist', 'file', 'heuristic', 'result', 'safelist', 'signature', 'submission', 'workflow')
 API = 'v4'
 
 
 class ClientError(Exception):
     def __init__(self, message, status_code, api_response=None, api_version=None):
         super(ClientError, self).__init__(message)
         self.api_response = api_response
```

## assemblyline_client/v4_client/module/user.py

```diff
@@ -79,14 +79,28 @@
 favorites   : New favorites for the user
 
 Throws a Client exception if the user does not exist.
 """
         return self._connection.post(api_path('user', 'favorites', username), json=favorites)
 
 
+class Quotas(object):
+    def __init__(self, connection):
+        self._connection = connection
+
+    def __call__(self, username):
+        """\
+Get the current user's settings.
+
+Required:
+username    : User key (string)
+"""
+        return self._connection.get(api_path('user', 'quotas', username))
+
+
 class Settings(object):
     def __init__(self, connection):
         self._connection = connection
 
     def __call__(self, username):
         """\
 Get the current user's settings.
@@ -110,14 +124,15 @@
 
 
 class User(object):
     def __init__(self, connection):
         self._connection = connection
         self.avatar = Avatar(connection)
         self.favorites = Favorites(connection)
+        self.quotas = Quotas(connection)
         self.settings = Settings(connection)
 
     def __call__(self, username):
         """\
 Return the profile for the given username.
 
 Required:
```

## assemblyline_client/v4_client/module/search/__init__.py

```diff
@@ -49,39 +49,63 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('alert', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
                                use_archive=use_archive, track_total_hits=track_total_hits)
 
+    def badlist(self, query, filters=None, fl=None, offset=0, rows=25, sort=None, timeout=None,
+                use_archive=False, track_total_hits=None):
+        """\
+Search badlists with a lucene query.
+
+Required:
+query   : lucene query (string)
+
+Optional:
+filters           : Additional lucene queries used to filter the data (list of strings)
+fl                : List of fields to return (comma separated string of fields)
+offset            : Offset at which the query items should start (integer)
+rows              : Number of records to return (integer)
+sort              : Field used for sorting with direction (string: ex. 'id desc')
+timeout           : Maximum execution time in milliseconds (integer)
+use_archive       : Also query the archive
+track_total_hits  : Number of hits to track (default: 10k)
+
+Returns all results.
+"""
+        return self._do_search('badlist', query, filters=filters, fl=fl, offset=offset,
+                               rows=rows, sort=sort, timeout=timeout,
+                               use_archive=use_archive, track_total_hits=track_total_hits)
+
     def file(self, query, filters=None, fl=None, offset=0, rows=25, sort=None, timeout=None,
              use_archive=False, track_total_hits=None):
         """\
 Search files with a lucene query.
 
 Required:
 query   : lucene query (string)
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('file', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
@@ -97,15 +121,15 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('heuristic', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
@@ -121,15 +145,15 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('result', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
@@ -145,15 +169,15 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('safelist', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
@@ -169,15 +193,15 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('signature', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
@@ -193,15 +217,15 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('submission', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
@@ -217,15 +241,15 @@
 
 Optional:
 filters           : Additional lucene queries used to filter the data (list of strings)
 fl                : List of fields to return (comma separated string of fields)
 offset            : Offset at which the query items should start (integer)
 rows              : Number of records to return (integer)
 sort              : Field used for sorting with direction (string: ex. 'id desc')
-timeout           : Max amount of miliseconds the query will run (integer)
+timeout           : Maximum execution time in milliseconds (integer)
 use_archive       : Also query the archive
 track_total_hits  : Number of hits to track (default: 10k)
 
 Returns all results.
 """
         return self._do_search('workflow', query, filters=filters, fl=fl, offset=offset,
                                rows=rows, sort=sort, timeout=timeout,
```

## assemblyline_client/v4_client/module/search/facet.py

```diff
@@ -18,134 +18,159 @@
 
         kwargs = {k: v for k, v in kwargs.items() if v is not None and k != 'filters'}
         if filters is not None:
             kwargs['params_tuples'] = filters
         path = api_path('search', 'facet', index, field, **kwargs)
         return self._connection.get(path)
 
-    def alert(self, field, query=None, mincount=None, filters=None):
+    def alert(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the alert collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('alert', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('alert', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def file(self, field, query=None, mincount=None, filters=None):
+    def badlist(self, field, query=None, mincount=None, filters=None, timeout=None):
+        """\
+List most frequent value for a field in the badlist collection.
+
+Required:
+field   : field to extract the facets from
+
+Optional:
+query    : Initial query to filter the data (default: 'id:*')
+filters  : Additional lucene queries used to filter the data (list of strings)
+mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
+
+Returns all results.
+"""
+        return self._do_facet('badlist', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
+
+    def file(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the file collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('file', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('file', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def heuristic(self, field, query=None, mincount=None, filters=None):
+    def heuristic(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the heuristic collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('heuristic', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('heuristic', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def result(self, field, query=None, mincount=None, filters=None):
+    def result(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the result collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('result', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('result', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def safelist(self, field, query=None, mincount=None, filters=None):
+    def safelist(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the safelist collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('safelist', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('safelist', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def signature(self, field, query=None, mincount=None, filters=None):
+    def signature(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the signature collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('signature', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('signature', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def submission(self, field, query=None, mincount=None, filters=None):
+    def submission(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the submission collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('submission', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('submission', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
 
-    def workflow(self, field, query=None, mincount=None, filters=None):
+    def workflow(self, field, query=None, mincount=None, filters=None, timeout=None):
         """\
 List most frequent value for a field in the workflow collection.
 
 Required:
 field   : field to extract the facets from
 
 Optional:
-qeury    : Initial query to filter the data (default: 'id:*')
+query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
-        return self._do_facet('workflow', field, query=query, mincount=mincount, filters=filters)
+        return self._do_facet('workflow', field, query=query, mincount=mincount, filters=filters, timeout=timeout)
```

## assemblyline_client/v4_client/module/search/fields.py

```diff
@@ -14,14 +14,20 @@
 
     def alert(self):
         """\
 List all fields details for the alert collection.
 """
         return self._do_fields('alert')
 
+    def badlist(self):
+        """\
+List all fields details for the badlist collection.
+"""
+        return self._do_fields('badlist')
+
     def file(self):
         """\
 List all fields details for the file collection.
 """
         return self._do_fields('file')
 
     def heuristic(self):
```

## assemblyline_client/v4_client/module/search/grouped.py

```diff
@@ -20,15 +20,15 @@
         kwargs = {k: v for k, v in kwargs.items() if v is not None and k != 'filters'}
         if filters is not None:
             kwargs['params_tuples'] = filters
         path = api_path('search', 'grouped', index, field, **kwargs)
         return self._connection.get(path)
 
     def alert(self, field, group_sort=None, limit=None, query=None, filters=None,
-              offset=None, rows=None, sort=None, fl=None):
+              offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search alert collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -36,22 +36,47 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('alert', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
+
+    def badlist(self, field, group_sort=None, limit=None, query=None, filters=None,
+                offset=None, rows=None, sort=None, fl=None, timeout=None):
+        """\
+Search badlist collection and group result to a given field
+
+Required:
+field   : Field used to group the results
+
+Optional:
+group_sort : Field used for sorting items in the groups with direction (string: ex. 'id desc')
+limit      : Maximum number of items returned per group (integer)
+query      : lucene query (string)
+filters    : Additional lucene queries used to filter the data (list of strings)
+offset     : Offset at which the query items should start (integer)
+rows       : Number of records to return (integer)
+sort       : Field used for sorting with direction (string: ex. 'id desc')
+fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
+
+Returns a generator that transparently and efficiently pages through results.
+"""
+        return self._do_grouped('badlist', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def file(self, field, group_sort=None, limit=None, query=None, filters=None,
-             offset=None, rows=None, sort=None, fl=None):
+             offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search file collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -59,22 +84,23 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('file', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def heuristic(self, field, group_sort=None, limit=None, query=None, filters=None,
-                  offset=None, rows=None, sort=None, fl=None):
+                  offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search heuristic collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -82,22 +108,23 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('heuristic', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def result(self, field, group_sort=None, limit=None, query=None, filters=None,
-               offset=None, rows=None, sort=None, fl=None):
+               offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search result collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -105,22 +132,23 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('result', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def safelist(self, field, group_sort=None, limit=None, query=None, filters=None,
-                 offset=None, rows=None, sort=None, fl=None):
+                 offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search safelist collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -128,22 +156,23 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('safelist', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def signature(self, field, group_sort=None, limit=None, query=None, filters=None,
-                  offset=None, rows=None, sort=None, fl=None):
+                  offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search signature collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -151,22 +180,23 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('signature', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def submission(self, field, group_sort=None, limit=None, query=None, filters=None,
-                   offset=None, rows=None, sort=None, fl=None):
+                   offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search submission collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -174,22 +204,23 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('submission', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
 
     def workflow(self, field, group_sort=None, limit=None, query=None, filters=None,
-                 offset=None, rows=None, sort=None, fl=None):
+                 offset=None, rows=None, sort=None, fl=None, timeout=None):
         """\
 Search workflow collection and group result to a given field
 
 Required:
 field   : Field used to group the results
 
 Optional:
@@ -197,12 +228,13 @@
 limit      : Maximum number of items returned per group (integer)
 query      : lucene query (string)
 filters    : Additional lucene queries used to filter the data (list of strings)
 offset     : Offset at which the query items should start (integer)
 rows       : Number of records to return (integer)
 sort       : Field used for sorting with direction (string: ex. 'id desc')
 fl         : List of fields to return (comma separated string of fields)
+timeout    : Maximum execution time in milliseconds (integer)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_grouped('workflow', field, group_sort=group_sort, limit=limit, query=query, filters=filters,
-                                offset=offset, rows=rows, sort=sort, fl=fl)
+                                offset=offset, rows=rows, sort=sort, fl=fl, timeout=timeout)
```

## assemblyline_client/v4_client/module/search/histogram.py

```diff
@@ -18,153 +18,182 @@
 
         kwargs = {k: v for k, v in kwargs.items() if v is not None and k != 'filters'}
         if filters is not None:
             kwargs['params_tuples'] = filters
         path = api_path('search', 'histogram', index, field, **kwargs)
         return self._connection.get(path)
 
-    def alert(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def alert(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the alert index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('alert', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
 
-    def file(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def badlist(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
+        """\
+Create an histogram of data from a given field in the badlist index where the frequency
+of the data is split between a given gap size.
+
+Required:
+field   : field to create the histograms with (only work on date or number fields)
+
+Optional:
+query    : Initial query to filter the data (default: 'id:*')
+filters  : Additional lucene queries used to filter the data (list of strings)
+mincount : Minimum amount of hits for the value to be returned
+start    : Beginning of the histogram range (Default: now-1d or 0)
+end      : End of the histogram range (Default: now or 1000)
+gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
+
+Returns all results.
+"""
+        return self._do_histogram('badlist', field, query=query, mincount=mincount, filters=filters,
+                                  start=start, end=end, gap=gap, timeout=timeout)
+
+    def file(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the file index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('file', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
 
-    def result(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def result(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the result index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('result', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
 
-    def safelist(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def safelist(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the safelist index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('safelist', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
 
-    def signature(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def signature(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the signature index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('signature', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
 
-    def submission(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def submission(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the submission index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('submission', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
 
-    def workflow(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None):
+    def workflow(self, field, query=None, mincount=None, filters=None, start=None, end=None, gap=None, timeout=None):
         """\
 Create an histogram of data from a given field in the workflow index where the frequency
 of the data is split between a given gap size.
 
 Required:
 field   : field to create the histograms with (only work on date or number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
 mincount : Minimum amount of hits for the value to be returned
 start    : Beginning of the histogram range (Default: now-1d or 0)
 end      : End of the histogram range (Default: now or 1000)
 gap      : Interval in between each histogram points (Default: 1h or 100)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns all results.
 """
         return self._do_histogram('workflow', field, query=query, mincount=mincount, filters=filters,
-                                  start=start, end=end, gap=gap)
+                                  start=start, end=end, gap=gap, timeout=timeout)
```

## assemblyline_client/v4_client/module/search/stats.py

```diff
@@ -18,111 +18,134 @@
 
         kwargs = {k: v for k, v in kwargs.items() if v is not None and k != 'filters'}
         if filters is not None:
             kwargs['params_tuples'] = filters
         path = api_path('search', 'stats', index, field, **kwargs)
         return self._connection.get(path)
 
-    def alert(self, field, query=None, filters=None):
+    def alert(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the alert collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('alert', field, query=query, filters=filters)
+        return self._do_stats('alert', field, query=query, filters=filters, timeout=timeout)
 
-    def file(self, field, query=None, filters=None):
+    def badlist(self, field, query=None, filters=None, timeout=None):
+        """\
+Generates statistics about the distribution of an integer field of the badlist collection.
+
+Required:
+field   : field to create the stats on (only work on number fields)
+
+Optional:
+query    : Initial query to filter the data (default: 'id:*')
+filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
+
+Returns statistics about the field.
+"""
+        return self._do_stats('badlist', field, query=query, filters=filters, timeout=timeout)
+
+    def file(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the file collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('file', field, query=query, filters=filters)
+        return self._do_stats('file', field, query=query, filters=filters, timeout=timeout)
 
-    def result(self, field, query=None, filters=None):
+    def result(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the result collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('result', field, query=query, filters=filters)
+        return self._do_stats('result', field, query=query, filters=filters, timeout=timeout)
 
-    def safelist(self, field, query=None, filters=None):
+    def safelist(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the safelist collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('safelist', field, query=query, filters=filters)
+        return self._do_stats('safelist', field, query=query, filters=filters, timeout=timeout)
 
-    def signature(self, field, query=None, filters=None):
+    def signature(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the signature collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('signature', field, query=query, filters=filters)
+        return self._do_stats('signature', field, query=query, filters=filters, timeout=timeout)
 
-    def submission(self, field, query=None, filters=None):
+    def submission(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the submission collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('submission', field, query=query, filters=filters)
+        return self._do_stats('submission', field, query=query, filters=filters, timeout=timeout)
 
-    def workflow(self, field, query=None, filters=None):
+    def workflow(self, field, query=None, filters=None, timeout=None):
         """\
 Generates statistics about the distribution of an integer field of the workflow collection.
 
 Required:
 field   : field to create the stats on (only work on number fields)
 
 Optional:
 query    : Initial query to filter the data (default: 'id:*')
 filters  : Additional lucene queries used to filter the data (list of strings)
+timeout  : Maximum execution time in milliseconds (integer)
 
 Returns statistics about the field.
 """
-        return self._do_stats('workflow', field, query=query, filters=filters)
+        return self._do_stats('workflow', field, query=query, filters=filters, timeout=timeout)
```

## assemblyline_client/v4_client/module/search/stream.py

```diff
@@ -77,14 +77,29 @@
 filters : Additional lucene queries used to filter the data (list of strings)
 fl      : List of fields to return (comma separated string of fields)
 
 Returns a generator that transparently and efficiently pages through results.
 """
         return self._do_stream('alert', query, filters=filters, fl=fl)
 
+    def badlist(self, query, filters=None, fl=None):
+        """\
+Get all badlists from a lucene query.
+
+Required:
+query   : lucene query (string)
+
+Optional:
+filters : Additional lucene queries used to filter the data (list of strings)
+fl      : List of fields to return (comma separated string of fields)
+
+Returns a generator that transparently and efficiently pages through results.
+"""
+        return self._do_stream('badlist', query, filters=filters, fl=fl)
+
     def file(self, query, filters=None, fl=None):
         """\
 Get all files from a lucene query.
 
 Required:
 query   : lucene query (string)
```

## Comparing `assemblyline_client-4.9.0.dist-info/LICENCE.md` & `assemblyline_client-4.9.1.dist-info/LICENCE.md`

 * *Files identical despite different names*

## Comparing `assemblyline_client-4.9.0.dist-info/METADATA` & `assemblyline_client-4.9.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: assemblyline-client
-Version: 4.9.0
+Version: 4.9.1
 Summary: Assemblyline v4 client library
 Home-page: https://github.com/CybercentreCanada/assemblyline_client
 Author: CSE-CST Assemblyline development team
 Author-email: assemblyline@cyber.gc.ca
 License: MIT
 Keywords: development assemblyline client gc canada cse-cst cse cst
 Classifier: Development Status :: 5 - Production/Stable
```

## Comparing `assemblyline_client-4.9.0.dist-info/RECORD` & `assemblyline_client-4.9.1.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,18 +1,18 @@
-assemblyline_client/__init__.py,sha256=PRVIjeIdE_CNUEE95EikH2tBJRdogh2P-40d4qLlo58,9142
+assemblyline_client/__init__.py,sha256=qGcHNj0mLFFqRZF64AZO4mhf8JH-xicm2l38WNlkecg,10752
 assemblyline_client/submit.py,sha256=ckfKQ6zT_fowBmBfLvnwjDVEQZhT4-AmOBiDSdLL3j4,19173
 assemblyline_client/common/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_client/common/classification.py,sha256=ESiQWaw6wp0GWq23t7-famp_gTcGdq4R-Zjh1K1a-PM,36464
 assemblyline_client/v3_client/__init__.py,sha256=1ehuoLIuNjkbL8zF_dKP9-q4zTicO359l11efUkWcMc,37699
 assemblyline_client/v3_client/utils.py,sha256=CrTWZwDuGZqX72NwEdoYKZqVx0gaQba7OSjb3P3i2EE,7565
 assemblyline_client/v4_client/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-assemblyline_client/v4_client/client.py,sha256=nFpjDTCBAyajoDAriOISQy4FfiqFMv0JEmMhpRCORiw,3635
+assemblyline_client/v4_client/client.py,sha256=tXXlViJpKnUOwc8vbYNr0FSZAEjSiFUj6xpyujrYoR0,4546
 assemblyline_client/v4_client/common/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_client/v4_client/common/submit_utils.py,sha256=WC8-_KJX1fVpM-OXmq8OBoaAwEdDHaiM89P107HMayo,12042
-assemblyline_client/v4_client/common/utils.py,sha256=NLrfxge5afTdCNvJHiFDT9RHUzykGl_DiQ2qS0GWZD0,3658
+assemblyline_client/v4_client/common/utils.py,sha256=N2puHBxfkufyPfuINEpETXTTCGJBLNeC-h2_OUAhsQ4,3669
 assemblyline_client/v4_client/module/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_client/v4_client/module/alert.py,sha256=DM-OsY_4a0jFIrJPAtMyeBORjFQHcEXnjKgbBEAYueE,12503
 assemblyline_client/v4_client/module/badlist.py,sha256=4pjJt3QjyHFnWqUelRoN_RDEFizY2GG2hUwvwjQ7AYI,2791
 assemblyline_client/v4_client/module/bundle.py,sha256=-BOhbadtcitNh2psCbXgMFTLtOFXkkW1zXzomkqv8jc,2343
 assemblyline_client/v4_client/module/error.py,sha256=pvTUNkg1C2EnyzyfuZrkPmRXBKRuhzZq5d4YxLWn-EU,1275
 assemblyline_client/v4_client/module/file.py,sha256=khMktb0PuxwkhVS_6dE-XyLfbNhlBOX-zvNLBiw2KEg,3258
 assemblyline_client/v4_client/module/hash_search.py,sha256=g0XGw1v9khjtbauY_cYvyqO-OmTKR9sVtzEHRW3_2Qs,990
@@ -25,22 +25,22 @@
 assemblyline_client/v4_client/module/safelist.py,sha256=LUaUevDbOfmjNCeP-VLMpsIvJ4Kit9u562WtngHZl6g,2271
 assemblyline_client/v4_client/module/service.py,sha256=m5OUzasHvsVzhg0Ob2RtOwLoZcCvap3_d8U0FbiFbvI,4120
 assemblyline_client/v4_client/module/signature.py,sha256=2fg2RSKz5aS2cHMi4hF73ADT44JkFcMVh5S3bnCowGA,5390
 assemblyline_client/v4_client/module/socketio.py,sha256=Y3VqIye7G7NDeE0yWf98wN5ZCKsQ2ARUlIFrIbtJZJI,11193
 assemblyline_client/v4_client/module/submission.py,sha256=tepShqCCUlWUuRWLyGno4zm4JTc8wH-Co04IZoyceVI,5790
 assemblyline_client/v4_client/module/submit.py,sha256=6h0Wy_qOM68r2vQ2lv7KYHcaA0uj99zlqFJDMo3IyOc,3556
 assemblyline_client/v4_client/module/system.py,sha256=hqQsJh7Vu7rBb3c7PaqW7gPrOtXYJUjXfFh7yKiNzxg,1278
-assemblyline_client/v4_client/module/user.py,sha256=yD7pt-ckeVuzQ7bTDuL1oEtI6XTmtb2CPL01Xwr_7IE,5324
+assemblyline_client/v4_client/module/user.py,sha256=b8j-2zzV9zGb5_I4aLBooSV8-PbZYrBQ5Fe1e7QoFtQ,5665
 assemblyline_client/v4_client/module/workflow.py,sha256=iAaWfSgouNb9fZqKLAeU-iz-DbIiBCeFOky1DeGqJWY,1810
-assemblyline_client/v4_client/module/search/__init__.py,sha256=NopgBUdwHcekzhTppqM6FNvCx8ueyiNdrIoh16z-9_c,10420
-assemblyline_client/v4_client/module/search/facet.py,sha256=iB0vrfLKkaL4z6WBfiO0rmX2P1BYjVTVtczxYXA9i9U,5172
-assemblyline_client/v4_client/module/search/fields.py,sha256=kKylOJRMJVempCirlBj24C5EioLJGk56WpklAeigkA0,1513
-assemblyline_client/v4_client/module/search/grouped.py,sha256=i2J4hmFqTT2k3lBBtvPo7qQFQptijUT3YcOEDmv2ORo,9670
-assemblyline_client/v4_client/module/search/histogram.py,sha256=qoYYT9O1FRM0AJWO3ukEruFLFF5q5bBPJnMwvpLoDVk,7535
-assemblyline_client/v4_client/module/search/stats.py,sha256=2i1yVc2sx42i-_MwXqfu81kwr-55d6JFqXijZ-XByeY,4415
-assemblyline_client/v4_client/module/search/stream.py,sha256=jNHdJZVNlY9reXoYC6JasWsU3ZmrMq7tXokIzst5IN4,5778
-assemblyline_client-4.9.0.dist-info/LICENCE.md,sha256=NSkYo9EH8h5oOkzg4VhjAHF4339MqPP2cQ8msTPgl-c,1396
-assemblyline_client-4.9.0.dist-info/METADATA,sha256=V_ySreqHVGm__oQ_lpOS2djZIJchnEPAQw5qf_3J4gE,1726
-assemblyline_client-4.9.0.dist-info/WHEEL,sha256=DZajD4pwLWue70CAfc7YaxT1wLUciNBvN_TTcvXpltE,110
-assemblyline_client-4.9.0.dist-info/entry_points.txt,sha256=hSDOMGBG65jJoU-H0TuvqjSq0_ULbxidEJG_M14hnh0,62
-assemblyline_client-4.9.0.dist-info/top_level.txt,sha256=QDknpMQoJDxweZKGkbMfYRyAoj9lQ9PfnSMD91Z9DlI,20
-assemblyline_client-4.9.0.dist-info/RECORD,,
+assemblyline_client/v4_client/module/search/__init__.py,sha256=8V4AEmyGQJ-b_QXHf8p5Vdb4o9-GByStMUCXnDD1_Xk,11461
+assemblyline_client/v4_client/module/search/facet.py,sha256=_2KWT66cv3Aj4V7SlJ9POTinotj1BTHMl2GX2CfgL9o,6532
+assemblyline_client/v4_client/module/search/fields.py,sha256=B7j-LKqNJRP_mTl06RH3swEp3Tht5OLzsLXGEaGYAyw,1648
+assemblyline_client/v4_client/module/search/grouped.py,sha256=DYUBFOK58X1R3mq5MXD6ztvp--Pl4j0oepxGRC7rgKY,11609
+assemblyline_client/v4_client/module/search/histogram.py,sha256=8d3-r8LIxwZEnocUFfZeStF6USKQKa2_7nDAr69s_cE,9218
+assemblyline_client/v4_client/module/search/stats.py,sha256=FExR1Dn-igGybzqWsmsvSTR4k3RqxO0DFsR2B4RJ6WM,5654
+assemblyline_client/v4_client/module/search/stream.py,sha256=n8j6L1kG2r5py6IZIY--X64w20uKR9s6BN6_tuXRwD0,6241
+assemblyline_client-4.9.1.dist-info/LICENCE.md,sha256=NSkYo9EH8h5oOkzg4VhjAHF4339MqPP2cQ8msTPgl-c,1396
+assemblyline_client-4.9.1.dist-info/METADATA,sha256=pEy5hSnw1sgfSb-yx3qC1OFyqXgTv_WhMVQ4hAqjCSo,1726
+assemblyline_client-4.9.1.dist-info/WHEEL,sha256=DZajD4pwLWue70CAfc7YaxT1wLUciNBvN_TTcvXpltE,110
+assemblyline_client-4.9.1.dist-info/entry_points.txt,sha256=hSDOMGBG65jJoU-H0TuvqjSq0_ULbxidEJG_M14hnh0,62
+assemblyline_client-4.9.1.dist-info/top_level.txt,sha256=QDknpMQoJDxweZKGkbMfYRyAoj9lQ9PfnSMD91Z9DlI,20
+assemblyline_client-4.9.1.dist-info/RECORD,,
```

